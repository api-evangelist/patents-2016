---

title: System and method of detecting delivery of malware based on indicators of compromise from different sources
abstract: According to one embodiment, a computerized method comprises receiving a set of indicators of compromise (IOCs) associated with a known malware of a first message type from a first source and receiving one or more IOCs (IOC(s)) from a second source that is different from the first source. Thereafter, a determination is made as to whether the received IOC(s) from the second source correspond to the set of IOCs received from the first source. If so, information associated with at least the set of IOCs is used to locate a malware of the first message type that is undetected at the second source.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09609007&OS=09609007&RS=09609007
owner: FireEye, Inc.
number: 09609007
owner_city: Milpitas
owner_country: US
publication_date: 20160606
---
This application claims the benefit of priority on U.S. application Ser. No. 14 466 898 filed Aug. 22 2014 now U.S. Pat. No. 9 363 280 issued Jun. 7 2016 the entire contents of which are incorporated by reference.

Embodiments of the disclosure relate to the field of cybersecurity. More specifically embodiments of the disclosure relate to a system and method for conducting a predictive analysis based on information from a first customer as to when indicators of compromise IOCs experienced by a second customer are caused by receipt of an undetected malicious electronic message.

Currently there exist a number of malware delivery techniques. A commonly used malware delivery technique involves the transmission of a malicious electronic mail email message to a computer or device controlled by a targeted user. Based on user activity the malicious email message causes the computer to become infected. More specifically the malicious email message may be structured to lure the targeted user to select a Uniform Resource Locator URL within the malicious email message which upon selection establishes communications with a web server that unbeknownst to the user is malicious. Thereafter malware is uploaded and sensitive information may be subsequently downloaded from the infected computer.

For the last few years anti virus and email filtering industries have developed tools and techniques to identify and isolate potentially infected email messages. However these traditional tools and techniques are not effective in detecting certain types of advanced malicious email messages. To address this detection gap one type of security appliance has been solely developed and is currently available to analyze an email message and determine whether the email message is likely infected with malware. In particular this email analytic appliance analyzes incoming email messages namely its header content links and attachments in order to identify the presence of malware. Upon discovery of a malicious email message the email analytic appliance alerts security personnel to quarantine the malicious email message and cleanse the infected computer.

Many customers deploy dedicated email analysis appliances as well as network monitoring appliances. However some customers do not operate dedicated email analytic appliances. Instead most of these customers simply deploy one or more security appliances that are configured to monitor network communications with one or more network devices to identify indicators of compromise IOCs namely malicious behaviors that suggest the presence of malware on a particular network device or particular network devices. While these types of security appliances are able to identify the presence of malware on a particular computer they are not configured to analyze email messages for the presence of malware within these messages. As a result without an email analytic appliance a customer has no ability to reliably prevent delivery of malicious to targeted victim of attack. Protection against malicious email messages becomes more complex as the messages may lay dormant in the user s inbox for days or even weeks. This lack of detection has prolonged adverse effects on network security as subsequent malicious attacks may persist months later as long as the malicious email message is stored at an email server of the enterprise network and or stored locally at a computer having access to the network.

Various embodiments of the disclosure relate to a platform and method for determining whether one or more indicators of compromise IOCs detected by a second customer e.g. second source have been caused by receipt of a malicious electronic message even when no malicious electronic message has been directly observed by the second customer. More specifically the platform is configured to conduct a predictive analysis that determines based on a sufficient correspondence between IOCs detected by the second customer and IOCs associated with a particular malicious electronic message as detected and or observed by one or more customers different than the second customer e.g. a first source whether the detected IOCs received from the second customer are caused by receipt of a malicious electronic message that is proximate in time and or similar in content to the particular malicious electronic message.

According to one embodiment of the disclosure a management platform receives anomalous behaviors namely IOCs from multiple customers having different security deployments. Herein a first customer deploys at least a message analytic appliance that is specifically designed to protect against attacks delivered via malicious electronic messages such as email messages that includes a malicious attachment a malicious text message or the like. One example of a message analytic appliance is an email analytic appliance is a FireEye EX security platform manufactured by FireEye Inc. of Milpitas Calif. The email analytic appliance performs an analysis on email messages directed to the first customer in efforts to determine whether there is a high probability of the email messages being part of a malicious attack.

Thereafter the management platform qualifies heuristics associated with the IOCs from the second customer. In qualifying these heuristics the management platform determines whether or not a triggering event has occurred which causes a predictive analysis to be conducted on the detected IOCs from the second customer. According to one embodiment of the disclosure the triggering event may include a significant increase or shift in volume of a given type of IOC by a particular second customer where the increase or shift exceeds a prescribed threshold e.g. a prescribed total number a selected increase or decrease in number or percentage etc. . The triggering event signifies to the management platform that the particular customer has a prescribed likelihood e.g. greater than 50 greater than 70 or greater than 90 that it is experiencing a malicious attack.

After qualifying heuristics associated with the detected IOCs from the second customer the management platform conducts a predictive analysis that evaluates whether these detected IOCs correspond to a set e.g. a sequence a particular group etc. of IOCs associated with known malware of a first message type that has been detected by another first customer. This first message type may include electronic mail email messaging having a format in accordance with RFC 5322 or another email format text messaging having a format in accordance with Short Message Service SMS or any other recognized or proprietary communication format. For instance the IOCs associated with known malware of a first electronic message type may include 1 a set of IOCs associated with an email message that has been previously detected at the first customer as being malicious 2 a set of IOCs associated with a text message that has been previously detected at the first customer as being malicious or another type of transmission. Whether the detected IOCs correspond to the set of IOCs is based on a selected degree of correlation needed between the detected IOCs and the set of IOCs associated with known malware of the first message type where the level of correlation may be static in nature or may vary dynamically based on desired warning trigger levels current work load of the management platform or the like. This degree of correlation may also be referred to as degree of correspondence .

Thereafter once the detected IOCs are initially determined to be associated with malware of the first message type e.g. a non detected malicious electronic message such as a malicious email message a malicious text message a malicious global satellite positioning GPS message website post message etc. the predictive analysis conducted by the management platform further determines a threat level which signifies a level of confidence that the detected IOCs are caused by a malicious electronic message. The threat level may be based at least in part on the degree of correspondence determined by the management platform between the detected IOCs from the second customer and the set of IOCs associated with known malicious messages. Also the threat level may be based on the manner in which the IOCs associated with the malicious electronic message s have been uncovered. As an example the threat level may be based at least in part on the following 1 similarity in type or order of the detected IOCs to the set of IOCs associated with the malicious electronic message 2 whether the set IOCs associated with the malicious electronic message were detected or observed 3 timing of the detected IOCs compared to the IOCs associated with the malicious electronic message and or 4 a sudden change in magnitude e.g. number of one or more of the detected IOCs compared to the level before the IOC s were detected in malicious electronic message at first customer.

For instance as an illustrative embodiment the predictive analysis is conducted to determine a threat level based on i a qualification of heuristics at the second customer ii a determination of correspondence between detected IOCs from the second customer and IOCs associated with one or more known malicious electronic messages from the first customer and or iii a determination as to the manner in which the IOCs from the first customer and perhaps other customers were uncovered e.g. detected and or observed IOCs . Where the management platform determines that the IOC s provided by the second customer correspond to one or more IOCs detected by the first customer a first threat level is assigned.

Similarly upon determining that the IOC s provided by the second customer correspond to one or more IOCs observed by the first customer the management platform assigns a second threat level. Given that the first customer is actually observing IOCs rather than detecting IOCs through virtual processing operations observed in a run time environment such as may be established in a virtual machine running in a threat detection platform and implemented in a host endpoint server dedicated appliance or other electronic device a greater threat level may be assigned.

Lastly where the management platform determines that the IOC s provided by the second customer correspond to one or more IOCs observed by multiple customers including the first customer a third threat level is assigned. The third threat level may signify a malware campaign is being conducted.

In summary an embodiment of the invention is directed to utilizing IOCs that are correlated with malware that has infected a first customer e.g. first source in efforts to determine based on analysis of IOCs detected at second customer e.g. a different source than the first source a likelihood that identical malware or similar malware e.g. of the same malware family or polymorphic malware has also infected one or more network devices at the second customer. This likelihood may be classified according to a plurality of threat levels that may be the same as or differ from the measured likelihood by the first customer of the IOCs being associated with malware. These threat levels may be based on whether the IOCs were detected e.g. through static analysis of an object under analysis or dynamic processing of the object in a run time environment or observed in network traffic in flight or content e.g. files at rest as monitored by the first customer. However it is contemplated that the threat levels may be associated with any threshold of associated maliciousness risk or probability which may be static fixed or dynamic variable e.g. based on prevailing conditions and or user threat tolerance and user preference at a particular time in order to provide the second customer with information as to the likelihood of one of more network devices being infected with a certain type of known malware.

In the following description certain terminology is used to describe aspects of the invention. For example in certain situations both terms logic and engine are representative of hardware firmware and or software that is configured to perform one or more functions. As hardware logic or engine may include circuitry having data processing or storage functionality. Examples of such processing circuitry may include but is not limited or restricted to one or more processors or processor cores a programmable gate array a microcontroller an application specific integrated circuit receiver transmitter and or transceiver circuitry semiconductor memory or combinatorial logic.

Logic or engine may be in the form of one or more software modules such as executable code in the form of an executable application an application programming interface API a subroutine a function a procedure an applet a servlet a routine source code object code a shared library dynamic load library or one or more instructions. These software modules may be stored in any type of a suitable non transitory storage medium or transitory storage medium e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals or digital signals . Examples of a non transitory storage medium may include but are not limited or restricted to a programmable circuit non persistent storage such as volatile memory e.g. any type of random access memory RAM persistent storage such as non volatile memory e.g. read only memory ROM power backed RAM flash memory phase change memory etc. a solid state drive hard disk drive an optical disc drive or a portable memory device and or a semiconductor memory. As firmware the executable code is stored in persistent storage.

The term message generally refers to information transmitted in a prescribed format where each message may be in the form of one or more packets or frames a Hypertext Transfer Protocol HTTP based transmission or any other series of bits having the prescribed format. For instance a message may include an electronic message such as an electronic mail email message a text message in accordance with a SMS based or non SMS based format an instant message in accordance with Session Initiation Protocol SIP or a series of bits in accordance with another messaging protocol. The message may be part of a flow namely a series of related packets that are communicated during a single communication session e.g. Transport Control Protocol TCP session between a source network device and a destination network device.

The term malware may be broadly construed as any information or action that is directed to adversely affect or disrupt operability of an electronic device surreptitiously gather stored information and or gain access to systems or cause human interaction that results in unintended or unexpected outcomes. The malware may include an exploit that takes advantage of a software vulnerability an advanced persistent threat APT or the like.

The term transmission medium is a physical or logical communication path within a network device such as an endpoint device which is an electronic device with data processing and or network connectivity such as for example a server a stationary or portable computer including a desktop computer laptop electronic reader netbook or tablet a smart phone a video game console wearable technology e.g. watch phone etc. . For instance the communication path may include wired and or wireless segments. Examples of wired and or wireless segments include electrical wiring optical fiber cable bus trace or a wireless channel using infrared radio frequency RF or any other wired wireless signaling mechanism.

The term computerized generally represents that any corresponding operations are conducted by hardware in combination with software and or firmware. Also a set of items generally relates a plurality of items although in some case a set may be broadly defined as including a single item. One type of set is a sequence of items that feature a particular order of occurrence.

Lastly the terms or and and or as used herein are to be interpreted as inclusive or meaning any one or any combination. Therefore A B or C or A B and or C mean any of the following A B C A and B A and C B and C A B and C. An exception to this definition will occur only when a combination of elements functions steps or acts are in some way inherently mutually exclusive.

As this invention is susceptible to embodiments of many different forms it is intended that the present disclosure is to be considered as an example of the principles of the invention and not intended to limit the invention to the specific embodiments shown and described.

Referring to an exemplary block diagram of a communication network deploying an embodiment of the invention is shown. Herein the communication network comprises a management platform communicatively coupled to a plurality of customers M 2 M 2 for this embodiment via a network . The network may include a public network such as the Internet a private network e.g. a local area network LAN wireless LAN etc. or a combination thereof. It is contemplated that the number and type of customers which are communicatively coupled to the same management platform may be selected based on a variety of parameters including industry or agency type e.g. technology manufacturing energy health care entertainment financial services banking governmental etc. field type e.g. electronic component manufacturing Internet services etc. geographical location of the customer and or requested level of service. It is contemplated that the grouping of customers based on certain parameters may improve detection as some malicious attacks may be industry field and or geographic specific.

Herein each customer . . . or may be broadly construed as a network based entity which includes one or more threat detection platforms TDPs where each TDP is configured to analyze information propagating into and or from the network based entity and upload one or more detected indicators of compromise IOCs destined for the management platform . The network based entity may represent an organization a subset of the organization e.g. a subsidiary where different customers may be different subsidiaries that are part of the same parent organization a division group etc. a particular enterprise network or the like.

According to one embodiment of the disclosure as shown in the first customer may include at least in part one or more threat detection platforms TDPs such as a first TDP and a second TDP for this embodiment. As shown the first TDP is a network device that includes message analysis logic and a second TDP is a network device operating as a web based security appliance that includes network traffic analysis logic . Similarly a second customer may include at least in part one or more threat detection platforms TDPs such as a third TDP in this embodiment.

As described below in detail the message analysis logic of the first TDP is configured to conduct a specific analysis of the content of a message of a first format type e.g. email messages text messages etc. transmitted and or received over the network . Based on this analysis the first TDP is capable of determining whether a malicious attack originated from a malicious electronic message and the particular malicious electronic message. The second network traffic analysis logic of the second TDP is configured to conduct an analysis of information associated with network traffic over the network in efforts to determine if this information suggests the presence of a malicious attack. But without the first TDP the second TDP is unable to determine whether the origin of the malicious attack is from a malicious electronic message.

More specifically according to one embodiment of the disclosure the first TDP is deployed in a customer s public network sometimes referred to as the Demilitarized Zone or DMZ where email servers most often reside. Of course the location of the TDP may vary provided that the TDP has access to the communication path of the transmitted messages and is communicatively coupled to the management platform . For instance the TDP could be deployed outside of customer s premises. For instance where the message is a SMS message the TDP could be deployed in a cell carrier network. Furthermore the TDP may be part of cloud services or even deployed within an endpoint device e.g. smartphone computer etc. .

Herein the message analysis logic enables the first TDP to operate at least in part as an email analytic appliance by performing an analysis of one or more portions of an incoming email message namely its header content links and or attachments. This analysis may be performed by one or more virtual machines hereinafter virtual machine s or VM s deployed within the first TDP . Each of the virtual machine s may be configured with a software profile which corresponds to a particular message management application e.g. Microsoft Outlook iPad native email application native email application on Windows Phone 8 etc. that is being used by a network device deployed within the same enterprise network as the first TDP . The virtual machine s may be configured to support concurrent virtual execution of a variety of different software configurations in efforts to verify that a malicious email message is part of a malicious attack.

The virtual machine s in combination with other logic e.g. processing logic within the first TDP are adapted to simulate the receipt and execution of content associated with the malicious email message within a run time environment as expected by the email message. For instance the processing logic is configured to emulate and provide anticipated signaling to the virtual machine s during virtual processing.

As an example the processing logic may be adapted to provide and sometimes modify information e.g. an Internet Protocol IP address etc. associated with an email message under analysis in order to control return signaling back to a virtual execution environment that includes the virtual machines. Hence the processing logic may suppress e.g. discard the return network traffic so that the return network traffic is not transmitted to the network .

Unlike the first TDP both the second TDP and the third TDP include network traffic analysis logic which operates as a web based security appliance by analyzing information associated with network traffic over the network to determine if the information suggests the occurrence of a malicious attack. By itself without operability of the first TDP neither the second TDP nor the third TDP is able to determine the origin of the malicious attack. An illustrative example of the network traffic analysis logic is illustrated as the MCD System in a prior U.S. patent application entitled Dynamically Remote Tuning of Malware Content Detection System U.S. patent application Ser. No. 14 231 216 filed Mar. 31 2014 the contents of which are incorporated by reference.

Referring still to the management platform is adapted to receive information from the plurality of customers notably TDPs . As shown the first TDP and the second TDP are associated with the first customer and the third TDP is associated with a second customer . Upon receipt of information from the TDPs the management platform qualifies heuristics associated with the received information in order to determine if the received information indicates that a malicious attack is occurring. Of course certain heuristics may be specifically selected for analysis during the qualification operations as these specific heuristics may be directed to functionality normally targeted by a malware attack via a malicious email message. The heuristics may encompass rules policies statistics signatures hash values or other determinative attributes or characteristics of received information under analysis and thus qualification of the heuristics involves analysis of the received information based on the heuristics.

As an illustrative example after receipt of received information including indicators of compromise IOCs namely information associated with anomalous behaviors detected by network traffic analysis logic within the TDP the management platform qualifies the heuristics associated with the IOCs in order to determine whether a triggering event has occurred which identifies that a malicious email based attack may be occurring at the second customer . For instance the management platform may determine whether a particular IOC based threshold has been met e.g. exceeds or falls below the threshold . As an example the particular IOC based threshold may be associated with an average number of a certain type of IOC detected by multiple TDPs with network traffic analysis logic or perhaps TDP by itself over a prescribed amount of time. This threshold is met if the detected IOCs are equal to or greater in number that the IOC average. Of course other types of thresholds may be used including a preselected number of total IOCs that may be dependent or independent of type mere presence of a particular type of IOC or the like.

If the IOC heuristics have been qualified the management platform conducts a predictive analysis associated with the detected IOCs received from the TDP to determine if these IOCs correspond to a set of IOCs associated with known malware of a first message type that are provided from the TDP . For instance the amount of similarity between the detected IOCs and the set of IOCs associated with the known malware of the first message type in order to determine whether the detected IOCs correspond to the set of IOCs may be static or dynamic in nature e.g. the degree of correspondence between detected IOCs and the IOCs associated with the known malware may vary based on the operating state of the management platform . For instance when the management platform is operating in a first operating state the degree of correspondence may be set at a high level where the detected IOCs need to be present and in the same chronological order as the set of IOCs associated with the known malware. Alternatively when the management platform is operating in a second operating state the degree of correspondence may be set at a lower level where the detected IOCs correspond to the known malware IOCs if multiple but not all IOCs of the detected IOCs are present in the set of IOCs.

When the IOC heuristics have been qualified and the predictive analysis concludes with a certain degree of confidence that the detected IOCs are associated with a malicious attack originating from a malicious email message the management platform determines a type of response. As an illustrative example the management platform may adjust the threat level which is associated with the degree of confidence that the detected IOCs are caused by a malicious electronic message based on whether the set of IOCs associated with the known malware of the first message type are detected by the TDP during static and or virtual processing of the malicious electronic message or are actual observed behavior s by a network device communicatively coupled to the TDP . Herein actual observed behavior s are assigned a higher threat level than detected behavior s . More details of the assignment of threat level are described in .

Referring now to a block diagram of an exemplary embodiment of the management platform is shown. Herein the management platform includes processing circuitry that are coupled to communication interface logic via a first transmission medium . Communication interface logic enables communications with customers notably one or more TDP deployed by the customers as shown in . According to one embodiment of the disclosure communication interface logic may be implemented as a physical interface including one or more ports for wired connectors. Additionally or in the alternative communication interface logic may be implemented with one or more radio units for supporting wireless communications with other electronic devices.

As shown processing circuitry is further coupled to a data storage IOC management logic predictive analysis logic alert generation logic and remediation logic . According to one embodiment of the disclosure the IOC management logic is configured to acquire information associated with detected and or observed anomalous behaviors IOCs from the customers where the IOCs may be acquired based upon actions by security personnel manually controlling the maintenance platform to obtain the IOCs in response to an event or an elapsed period of time. Alternatively the IOCs from the customers may be received automatically in accordance with a periodic or aperiodic uploading of the IOCs. The uploading may be accomplished by a push pull or polling technique in which the TDPs are configured to automatically transmit the IOCs in response to an activity e.g. detection of the triggering event that identifies that a malicious email based attack may be occurring and or expiration of an elapsed period of time.

Upon receiving IOCs from TDPs shown in the IOC management logic stores the received IOCs within the data store which may be organized to identify which IOCs are received from which customers and which IOCs are associated with known malware associated with a particular message type. For instance the IOCs may be organized to identify which IOCs are associated with known malicious electronic messages where these IOCs include the anomalous behaviors and or metadata associated with the malicious electronic messages. Examples of the metadata may include the arrival time of the message and or profile information associated with the recipient which may include one or more of the following geographical origin of the recipient group membership company type industry type or the like.

Thereafter the IOC management logic qualifies heuristics associated with the detected IOCs from the third TDP of by determining whether a triggering event has occurred to denote that a malicious attack due to a non detected malicious electronic message may be occurring at the second customer . The triggering event activates predictive analysis logic which causes a predictive analysis to be conducted on the detected IOCs from the second customer of . As described above the triggering event may include an increase or shift in volume of a given type of IOC by a particular second customer that exceeds a prescribed threshold.

More specifically the predictive analysis logic conducts a predictive analysis that evaluates whether the detected IOCs from the second customer of correspond to a set of IOCs associated with known malware of a first message type that has been detected by another customer e.g. first customer . For instance the set of IOCs may be associated with a known type of malicious email message or a known type of malicious text message.

Thereafter once the detected IOCs are initially determined to be associated with a non detected malicious email or text message the predictive analysis logic further determines a threat level which signifies a degree of confidence that the detected IOCs are caused by a malicious email message or a malicious text message. The threat level may be based at least in part on the degree of correspondence determined by the predictive analysis logic between the detected IOCs from the second customer of and the set of IOCs associated with known malicious electronic messages. Additionally the threat level may be based on the manner in which the set of IOCs associated with the malicious electronic message s was uncovered where observed IOCs provide a greater weighting and a higher threat level than detected IOCs and observations by multiple customers increase the threat level.

The alert generation logic and the remediation logic perform operations based at least in part on the determined threat level. For instance in response to computation of a first threat level the alert generation logic may merely issue an alert to security personnel of the second customer. However in response to computation of a first threat level the alert generation logic may generate multiple alerts in which the alerts may be sent through different mediums e.g. network email text message automated cellular telephone call etc. . Also the remediation logic may operate to provide suggested actions to remediate the potential malicious email message e.g. search email servers for email messages associated with a particular phrase in the subject line or originating from a particular domain specific attachment specific size originated from a specific source IP or MAC address arrival time within a particular time period e.g. range in minutes hours or days block the potential malicious email message from being opened or processed and or automatically delete the potential malicious email message with or without user notification .

Referring now to a block diagram of an exemplary embodiment of a logical representation of the management platform is shown. Herein the management platform includes processing circuitry that are coupled to the communication interface logic via the first transmission medium as well as the data store and persistent storage via a second transmission medium .

According to one embodiment of the disclosure persistent storage may include a the IOC management logic b the predictive analysis logic c the alert generation logic and d the remediation logic . Of course when implemented partially or fully in hardware one or more of these logic units could be implemented separately from each other.

Referring now to an illustrative embodiment of the operations conducted by the management platform of for conducting a predictive analysis based on IOCs provided from a first customer to determine that a malicious attack is being conducted by a malicious electronic message on a second customer is shown. The management platform receives and stores IOC information from a plurality of customers including at least one set of IOCs associated with known malicious electronic message from the first customer and detected IOCs from the second customer blocks and .

Thereafter the management platform qualifies heuristics associated with the detected IOCs from the second customer in order to establish evidence of a potential presence of a malicious electronic message of a first message type at the second customer block . Thereafter the management platform evaluates heuristics associated with selected IOCs which may be part or all of the detected IOCs and determines if the evaluated heuristics qualify for issuance of an alert message and or remediation blocks and .

Referring to a detailed embodiment of the operations conducted by the management platform as set forth in for conducting predictive analysis is shown. The management platform receives and stores IOC information from a plurality of customers including at least one set of IOCs associated with known malicious electronic message from the first customer and detected IOCs from the second customer blocks and .

Thereafter the management platform qualifies heuristics associated with the IOCs from the second customer by determining whether a triggering event has occurred that causes a predictive analysis to be conducted on the detected IOCs from the second customer block . For instance as an illustrative example the triggering event may include a condition where the detected IOCs from the second customer indicate that a selected threshold has been met e.g. a particular increase or decrease in volume of a given type or types of IOCs has occurred etc. .

After determining that a triggering event has occurred the management platform conducts a predictive analysis that evaluates whether these detected IOCs correspond to a set of IOCs associated with known malware of a first message type that has been detected by first customer blocks and . For instance as an illustrative example the ordering and content of the IOCs are compared with the set of IOCs.

Thereafter once the detected IOCs are determined to correspond to the set of IOCs a predictive analysis is conducted by the management platform to determine a threat level that signifies a degree of confidence that the detected IOCs are caused by a malicious electronic message block . The threat level may be based at least in part on a qualification of heuristics at the second customer such as the degree of correspondence determined by the management platform between the detected IOCs from the second customer and the set of IOCs associated with known malicious electronic messages. Also the threat level may be based on the manner in which the IOCs associated with the malicious electronic message s were uncovered. As an example the threat level may be based at least in part on the following 1 similarity of the detected IOCs to the set of IOCs associated with the malicious electronic message 2 whether the set IOCs associated with the malicious electronic message were detected or observed and or 3 timing of the detected IOCs compared to the IOCs associated with the malicious electronic message.

As an illustrative embodiment as shown in a first determination is made as to whether there is sufficient qualification of IOC heuristics at the second customer compared to IOCs detected at the first customer and associated with a malicious electronic message block . If there are sufficient qualifications in that the detected IOCs of the second customer correspond to IOCs detected by the first customer a first threat level is assigned block . Otherwise no threat level is assigned to signify that there is no apparent correspondence between the detected IOCs at the second customer and IOCs associated with a malicious electronic message.

Thereafter a second determination is made as to whether there is sufficient qualification of IOC heuristics at the second customer compared to IOCs observed at the first customer and associated with a malicious electronic message block . If there are sufficient qualifications in that the detected IOCs of the second customer correspond to IOCs observed by the first customer a second threat level is assigned block . Otherwise the predictive analysis maintains that the detected IOCs from the second customer to the assigned first threat level.

Lastly a third determination is made as to whether there is sufficient qualification of IOC heuristics at the second customer compared to IOCs observed at multiple customers inclusive of the first customer block . If there are sufficient qualifications in that the detected IOCs of the second customer correspond to IOCs observed by multiple customers including the first customer a third threat level is assigned block . Otherwise the predictive analysis maintains that the detected IOCs from the second customer to the assigned second threat level.

Referring back to a particular type of response is selected based on the determined threat level block . For instance in accordance with an illustrative embodiment shown in after the management platform has determined the threat level associated with detected IOCs under analysis from the second customer block the threat level is used to determine the response type blocks . More specifically if the qualification results in a first threat level a first level response is conducted blocks and . As an illustrative example an alert message may be sent to security personnel associated with the second customer with information pertaining to a potential malicious email message that may be stored within one of its email servers.

Similarly if the qualification results in a second threat level a second level response is conducted blocks and . The second level response may be assigned higher urgency than the first level response. For example an alert message may be sent to security personnel associated with the second customer with information pertaining to a potential malicious email message that may be stored within one of its email servers along with additional information including contact information for security personnel and or marketing representatives associated with the management platform.

Otherwise the qualification resulted in a third threat level and thus warrants that a third level response is conducted block . The third level response may be assigned the highest urgency. For example multiple alert messages may be sent to security personnel associated with the second customer with information pertaining to a potential malicious email message that may be stored within one of its email servers. These alert messages may be successive or through different mediums e.g. email message text message over a cellular network etc. . Additionally additional information including contact information for security personnel and or marketing representatives associated with the management platform may be provided.

In lieu of transmitting messages to the customers as shown in as an alternative embodiment the particular type of response selected may be directed as to whether a report should be generated that provides aggregated data of potential malicious electronic messages that have not been detected by customers without an email analytic appliance. Herein as shown in the management platform determines threat levels for the detected IOCs associated with a plurality of customers without message analytic appliances block . The data associated with the detected IOCs and corresponding threat levels are aggregated based on selected aggregation groups block . These aggregation groups may be subsets or supersets of the grouping supported by the management platform. After aggregating the data associated with the detected IOC s and the corresponding threat level information the management platform generates reports that provide such information according to the selected aggregation groups block .

In the foregoing description the invention is described with reference to specific exemplary embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. For instance the above described analysis is applicable to electronic messages as well as other types of objects under analysis e.g. Portable Document Format PDF documents executables web downloads etc. .

