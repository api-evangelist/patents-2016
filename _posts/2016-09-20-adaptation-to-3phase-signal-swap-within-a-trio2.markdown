---

title: Adaptation to 3-phase signal swap within a trio
abstract: Systems, methods and apparatus are described that facilitate transmission of data, particularly between two devices within an electronic apparatus. Two Integrated Circuit (IC) devices may be collocated in an electronic apparatus and communicatively coupled through a 3-wire, 3-phase interface. A data transfer method operational on a first of the two or more devices includes determining presence of a misalignment of the 3-wire communication link involving two or more wires, and inverting a first bit of a 3-bit symbol encoded in a transition of signaling state of the 3-wire communication link when the misalignment of the 3-wire communication link is determined to affect phase relationships between two or more signals carried on the three wires, such that inverting the first bit corrects the phase relationships between the two or more signals. A version of the 3-phase signal may be communicated in a different phase state through each of three wires.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09621333&OS=09621333&RS=09621333
owner: QUALCOMM Incorporated
number: 09621333
owner_city: San Diego
owner_country: US
publication_date: 20160920
---
This application is a continuation of U.S. patent application Ser. No. 14 817 934 filed on Aug. 4 2015 the entire content of this application being incorporated herein by reference.

At least one aspect generally relates to high speed data communications interfaces and more particularly configuring the input and output pins of an application processor.

Manufacturers of mobile devices such as cellular phones may obtain components of the mobile devices from various sources including different manufacturers. For example the application processor in a cellular phone may be obtained from a first manufacturer while the display for the cellular phone may be obtained from a second manufacturer. Moreover multiple standards are defined for interconnecting certain components of the mobile devices. For example there are multiple types of interface defined for communications between an application processor and a display or camera within mobile device including the Display System Interface DSI standard specified by the Mobile Industry Processor Interface MIPI Alliance.

The MIPI Alliance specifies the C PHY standard which provides high speed data communication over a trio of wires. In some instances it may be desirable to reconfigure the wiring between devices for ease of routing for example. The additional hardware required to facilitate flexible routing can increase device complexity and cost.

Embodiments disclosed herein provide systems methods and apparatus that enable devices to accommodate wiring misalignments without the use of complex multiplexing and or switching circuits. According to certain aspects described herein two Integrated Circuit IC devices may be collocated in an electronic apparatus and communicatively coupled through one or more data links.

In an aspect of the disclosure a data transfer method is operational on a first the two or more devices where the two devices are configured for communicating using a 3 phase signal transmitted over a 3 wire communication link. The method may include determining presence of a misalignment of the 3 wire communication link involving two or more wires and inverting a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire communication link when the misalignment of the 3 wire communication link is determined to affect phase relationships between two or more signals carried on the 3 wire communication link. The 3 phase signal must be transmitted on all wires of the 3 wire communication link in different phases. Inverting the first bit may reverse an effect of the misalignment of the 3 wire communication link.

In an aspect of the disclosure an apparatus includes means for transmitting a 3 phase signal on each of the three wires of a 3 wire communication link in different phases including an encoder that encodes data in transitions of signaling state of the three wires means for determining presence of a misalignment of the 3 wire interface involving two or more wires and means for correcting phase relationships between two or more signals carried on the three wires including logic configured to invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire communication link when the misalignment of the 3 wire interface is determined to affect the phase relationships between the two or more signals.

In an aspect of the disclosure an apparatus includes a communications interface configured to communicate data using a 3 phase signal transmitted in different phases on all three wires of a 3 wire communication link correction logic configured to correct phase relationships between two or more signals carried on the 3 wire communication link and a processing circuit. The processing circuit may be configured to determine presence of a misalignment of the 3 wire communication link and cause the correction logic to invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire interface when a misalignment of the 3 wire communication link involving two or more wires is determined to affect the phase relationships between two or more signals carried on the 3 wire interface.

In an aspect of the disclosure a processor readable storage medium has one or more instructions stored thereon. The instructions may be executed by at least one processor of a processing circuit. The instructions may cause the processing circuit to determine presence of a misalignment of the 3 wire communication link involving two or more wires invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire communication link when the misalignment of the 3 wire communication link is determined to affect phase relationships between two or more signals carried on the 3 wire communication link. The 3 phase signal must be transmitted on all wires of the 3 wire communication link in different phases. Inverting the first bit reverses an effect of the misalignment of the 3 wire communication link.

The detailed description set forth below in connection with the appended drawings is intended as a description of various configurations and is not intended to represent the only configurations in which the concepts described herein may be practiced. The detailed description includes specific details for the purpose of providing a thorough understanding of various concepts. However it will be apparent to those skilled in the art that these concepts may be practiced without these specific details. In some instances well known structures and components are shown in block diagram form in order to avoid obscuring such concepts.

Several aspects of data communication systems will now be presented with reference to various apparatus and methods. These apparatus and methods will be described in the following detailed description and illustrated in the accompanying drawings by various blocks modules components circuits steps processes algorithms etc. collectively referred to as elements . These elements may be implemented using electronic hardware computer software or any combination thereof. Whether such elements are implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system.

By way of example an element or any portion of an element or any combination of elements may be implemented with a processing system that includes one or more processors. Examples of processors include microprocessors microcontrollers digital signal processors DSPs field programmable gate arrays FPGAs programmable logic devices PLDs state machines gated logic discrete hardware circuits and other suitable hardware configured to perform the various functionality described throughout this disclosure. One or more processors in the processing system may execute software. Software shall be construed broadly to mean instructions instruction sets code code segments program code programs subprograms software modules applications software applications software packages routines subroutines objects executables threads of execution procedures functions etc. whether referred to as software firmware middleware microcode hardware description language or otherwise.

Accordingly in one or more exemplary embodiments the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or encoded as one or more instructions or code on a computer readable medium. Computer readable media includes computer storage media. Storage media may be any available media that can be accessed by a computer. By way of example and not limitation such computer readable media can include read only memory ROM or random access memory RAM electrically erasable programmable ROM EEPROM including ROM implemented using a compact disc CD or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a computer. Disk and disc as used herein includes CD laser disc optical disc digital versatile disc DVD Blu Ray and floppy disk where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

The communication link may provide multiple channels and . One or more channels may be bidirectional and may operate in half duplex and or full duplex modes. One or more channels and may be unidirectional. The communication link may be asymmetrical providing higher bandwidth in one direction. In one example described herein a first communication channel may be referred to as a forward channel while a second communication channel may be referred to as a reverse channel . The first IC device may be designated as a host system or transmitter while the second IC device may be designated as a client system or receiver even if both IC devices and are configured to transmit and receive on the communication link . In one example the forward channel may operate at a higher data rate when communicating data from a first IC device to a second IC device while the reverse channel may operate at a lower data rate when communicating data from the second IC device to the first IC device .

The IC devices and may each have a processor or other processing and or computing circuit or device . In one example the first IC device may perform core functions of the apparatus including maintaining wireless communications through a wireless transceiver and an antenna while the second IC device may support a user interface that manages or operates a display controller . In the example the second IC device may be adapted to control operations of a camera or video input device using a camera controller . Other features supported by one or more of the IC devices and may include a keyboard a voice recognition component and other input or output devices. The display controller may include circuits and software drivers that support displays such as a liquid crystal display LCD panel touch screen display indicators and so on. The storage media and may include transitory and or non transitory storage devices adapted to maintain instructions and data used by respective processors and and or other components of the IC devices and . Communication between each processor and its corresponding storage media and and other modules and circuits may be facilitated by one or more bus and respectively.

The reverse channel may be operated in the same manner as the forward channel and the forward channel and reverse channel may be capable of transmitting at comparable speeds or at different speeds where speed may be expressed as data transfer rate and or clocking rates. The forward and reverse data transfer rates may be substantially the same or differ by orders of magnitude depending on the application. In some applications a single bidirectional channel may support communications between the first IC device and the second IC device . The forward channel and or the reverse channel may be configurable to operate in a bidirectional mode when for example the forward and reverse channels and share the same physical connections and operate in a half duplex manner. In one example the communication link may be operated to communicate control command and other information between the first IC device and the second IC device in accordance with an industry or other standard.

In some instances the forward and reverse channels and may be configured or adapted to support a wide video graphics array WVGA 80 frames per second LCD driver IC without a frame buffer delivering pixel data at 810 Mbps for display refresh. In another example the forward and reverse channels and may be configured or adapted to enable communications between with dynamic random access memory DRAM such as double data rate DDR synchronous DRAM SDRAM . Encoding devices and or may be configured to encode multiple bits per clock transition and multiple sets of wires can be used to transmit and receive data from the SDRAM control signals address signals and other signals.

The forward and reverse channels and may comply with or be compatible with application specific industry standards. In one example the MIPI Alliance standard defines physical layer interfaces between an application processor IC device and an IC device that supports the camera or display in a mobile device. The MIPI Alliance standard includes specifications that govern the operational characteristics of products that comply with MIPI Alliance specifications for mobile devices. In some instances the MIPI Alliance standard may define interfaces that employ complimentary metal oxide semiconductor CMOS parallel busses.

The MIPI Alliance defines standards and specifications that may address communications affecting all aspects of operations in a mobile device including the antenna peripherals the modem and application processors. For example the MIPI Alliance defines protocols for a camera serial interface CSI and a display serial interface DSI . The MIPI Alliance CSI 2 specification defines a wired interface between a camera and Application Processor and the MIPI Alliance DSI or DSI 2 specification defines a wired interface between an Application Processor and a display. The low level physical layer PHY interface in each of these applications can be the MIPI Alliance C PHY or the MIPI Alliance D PHY.

According to certain aspects disclosed herein certain systems and apparatus may employ multi phase data encoding and decoding interface methods for communicating between IC devices and . A multi phase encoder may drive a plurality of conductors i.e. M conductors . The M conductors typically include three or more conductors and each conductor may be referred to as a wire although the M conductors may include conductive traces on a circuit board or within a conductive layer of a semiconductor IC device. In one example the C PHY physical layer interface technology defined by the MIPI Alliance may be used to connect camera and display devices to an application processor device . The C PHY interface employs 3 phase symbol encoding to transmit data symbols on 3 wire lanes or trios where each trio includes an embedded clock.

The M conductors may be divided into a plurality of transmission groups each group encoding a portion of a block of data to be transmitted. An N phase encoding scheme is defined in which bits of data are encoded in phase transitions and polarity changes on the M conductors. Decoding does not rely on independent conductors or pairs of conductors and timing information can be derived directly from phase and or polarity transitions in the M conductors. N Phase polarity data transfer can be applied to any physical signaling interface including electrical optical and radio frequency RF interfaces.

In the C PHY example a 3 phase encoding scheme for a 3 wire system may define three phase states and two polarities providing 6 states and 5 possible transitions from each state. Deterministic voltage and or current changes may be detected and decoded to extract data from the three wires.

In the depicted C PHY example an M wire N phase polarity encoding transmitter is configured for M 3 and N 3. The example of 3 wire 3 phase encoding is selected solely for the purpose of simplifying descriptions of certain aspects of this disclosure. The principles and techniques disclosed for 3 wire 3 phase encoders can be applied in other configurations of M wire N phase polarity encoders and may comply or be compatible with other interface standards.

When 3 phase polarity encoding is used connectors such as signal wires and on a 3 wire bus may be undriven driven positive or driven negative. An undriven signal wire or may be in a high impedance state. An undriven signal wire or may be driven or pulled to a voltage level that lies substantially halfway between the positive and negative voltage levels provided on driven signal wires. An undriven signal wire or may have no current flowing through it. In the example each signal wire and may be in one of three states denoted as 1 1 or 0 using drivers . In one example drivers may include unit level current mode drivers. In another example drivers may drive opposite polarity voltages on two wires and while the third wire is at high impedance and or pulled to ground. For each transmitted symbol interval at least one signal is in the undriven 0 state while the number of signals driven positive 1 state is equal to the number of signals driven negative 1 state such that the sum of current flowing to the receiver is always zero. For each symbol the state of at least one signal wire or is changed from the symbol transmitted in the preceding transmission interval.

In the example a mapper may receive 16 bit data and the mapper may map the input data to 7 symbols for transmitting sequentially over the signal wires and . An M wire N phase encoder configured for 3 wire 3 phase encoding receives the 7 symbols produced by the mapper one symbol at a time and computes the state of each signal wire and for each symbol interval based on the immediately preceding state of the signal wires and . The 7 symbols may be serialized using parallel to serial converters for example. The encoder selects the states of the signal wires and based on the input symbol and the previous states of signal wires and

The use of M wire N phase encoding permits a number of bits to be encoded in a plurality of symbols where the bits per symbol is not an integer. In the simple example of a 3 wire 3 phase system there are 3 available combinations of 2 wires which may be driven simultaneously and 2 possible combinations of polarity on any pair of wires that is driven simultaneously yielding 6 possible states. Since each transition occurs from a current state 5 of the 6 states are available at every transition. The state of at least one wire is typically required to change at each transition. With 5 states log 5 2.32 bits may be encoded per symbol. Accordingly a mapper may accept a 16 bit word and convert it to 7 symbols because 7 symbols carrying 2.32 bits per symbol can encode 16.24 bits. In other words a combination of seven symbols that encodes five states has 5 78 125 permutations. Accordingly the 7 symbols may be used to encode the 2 65 536 permutations of 16 bits.

At any phase state in the illustrated 3 wire example exactly two of the wires carry a signal which is effectively a differential signal for that phase state while the third wire or is undriven. The phase state for each wire may be determined by voltage difference between the wire or and at least one other wire and or or by the direction of current flow or lack of current flow in the wire or . As shown in the state transition diagram three phase states S Sand S are defined. A signal may flow clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state Sand the signal may flow counter clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state S. For other values of N transitions between the N states may optionally be defined according to a corresponding state diagram to obtain circular rotation between state transitions.

In the example of a 3 wire 3 phase communication link clockwise rotations Sto S Sto S and or Sto S at a phase transition between states may be used to encode a logic 1 while counter clockwise rotations Sto S Sto S and or Sto S at the phase transition may be used to encode a logic 0. Accordingly a bit may be encoded at each transition by controlling whether the signal is rotating clockwise or counter clockwise. For example a logic 1 may be encoded when the three wires transition from phase state Sto phase state Sand a logic 0 may be encoded when the three wires transition from phase state Sto phase state S. In the simple 3 wire example depicted direction of rotation may be easily determined based on which of the three wires is undriven before and after the transition.

Information may also be encoded in the polarity and or changes of polarity of state of the driven wires or in the direction of current flow or changes in the direction of current flow between two wires . Signals and illustrate voltage levels applied to wires respectively at each phase state in a 3 wire 3 phase link. At any time a first wire is coupled to a more positive voltage V for example a second wire is coupled to a more negative voltage V for example while the third wire may be open circuited. As such one polarity encoding state may be determined by the current flow between the first and second wires or the voltage polarities of the first and second wires . In some embodiments two bits of data may be encoded in each phase transition . A decoder may determine the direction of signal phase rotation to obtain the first bit. The second bit may be determined based on the polarity difference between two of the signals and . In some instances the second bit may be determined based on a change or lack of change in polarity of the differential signal transmitted on a pair of the wires . The decoder having determined direction of rotation can determine the phase state and the polarity of the voltage applied between the two active wires and or or the direction of current flow through the two active wires and or

In the example of the 3 wire 3 phase link described herein one bit of data may be encoded in the rotation or phase change in the 3 wire 3 phase link and an additional bit may be encoded in the polarity or changes in polarity of two driven wires. Certain embodiments encode more than two bits in each transition of a 3 wire 3 phase encoding system by allowing transition to any of the possible states from a current state. Given three rotational phases and two polarities for each phase 6 states are defined such that 5 states are available from any current state. Accordingly there may be log 5 2.32 bits per symbol transition and the mapper may accept a 16 bit word and convert it to 7 symbols.

In one example an encoder may transmit symbols using 6 wires with two pairs of wires driven for each state. The 6 wires may be labeled A through F such that in one state wires A and F are driven positive wires B and E negative and C and D are undriven or carry no current . For six wires there may be 

Of the 4 wires driven the possible combinations of two wires driven positive and the other two must be negative . The combinations of polarity may include 

Accordingly the total number of different states may be calculated as 15 6 90. To guarantee a transition between symbols 89 states are available from any current state and the number of bits that may be encoded in each symbol may be calculated as log 89 6.47 bits per symbol. In this example a 32 bit word can be encoded by the mapper into 5 symbols given that 5 6.47 32.35 bits.

The general equation for the number of combinations of wires that can be driven for a bus of any size as a function of the number of wires in the bus and number of wires simultaneously driven 

Also shown in are the possible transition paths see for example the model transition path between the states and . As noted herein clock information may be embedded in 3 phase signals by ensuring that a transition in signaling state of the communication link occurs at the boundary between each pair consecutively transmitted symbols. Five possible transitions are available from any current state or .

MIPI Alliance C PHY interfaces may be used to interconnect various IC devices within a device on a chip carrier circuit board or the like. In some instances there may be limited options for positioning and or routing of wires traces or other connectors. In such instances it may be preferable or necessary to connect inputs of a first device to the outputs of a second device coupled to the multi wire interface without regard to functional alignment of the inputs and outputs. illustrates an example of a receiver that supports communication over misaligned wires A B and C in a 3 wire interface and illustrates an example of a transmitter that supports communication over misaligned wires A B and C in a 3 wire interface.

In the example illustrated in the receiver may be coupled to a transmitter such that the A input of the receiver is connected to the C output of the transmitter the B input of the receiver is connected to the B output of the transmitter and the C input of the receiver is connected to the A output of the transmitter in a configuration that may be referred to as an CBA configuration. When the 3 wire interface is configured for single ended operation in a low power mode of the C PHY interface for example multiplexers may be employed to realign the three wires . In the CBA example the multiplexers may be controlled to produce an ABC alignment of inputs to the symbol decoding logic. The multiplexers may be provided between line receivers and a symbol decoding logic and circuits.

In the example illustrated in the transmitter may be coupled to a receiver such that the A output of the transmitter is connected to the B input of the receiver the B output of the transmitter is connected to the C input of the receiver and the C output of the transmitter is connected to the A input of the receiver in a configuration that may be referred to as an BCA configuration. When the 3 wire interface is configured for single ended operation in a low power mode of the C PHY interface for example multiplexers may be employed to realign the three wires . In the BCA example the multiplexers may be controlled to produce an ABC configuration for transmission on the 3 wires. The multiplexers may be provided between line receivers and a symbol decoding logic and circuits.

Misalignments may be corrected by controlling the multiplexers of the receiver and or the multiplexers of the transmitter . For example a misalignment may be corrected if only one device is equipped with a receiver and or a transmitter with corresponding multiplexers and . When both devices are equipped with a receiver and or a transmitter capable of correcting misalignments one device may be assigned responsibility for correcting misalignment e.g. the receiving device or transmitting device may be responsible . In some instances both devices may operate their respective receivers and or transmitters to match a wiring configuration of the 3 wire interface. That is both devices may control their respective multiplexers and or to align internal connectors with a predefined wiring configuration of the 3 wire link.

According to certain aspects disclosed herein wiring misalignments in a 3 phase 3 wire interface may be corrected without the use of multiplexers a switch matrix or the like. is a diagram that illustrates certain aspects of 3 Phase coding that may be leveraged to correct misaligned signals. In the diagram the A B and C wires of a 3 phase trio are represented as points on circles that collectively represent all six possible permutations of the three wires. The circles include a numerical identification corresponding to the permutation numbers identified in . On each circle an aligned configuration of wires i.e. the aligned wires A B C in a properly aligned interface is provided alongside the configuration of wires represented by the circle .

With continued reference to polarity changes at symbol transitions result in the same change in polarity state regardless of the permutation of wires. That is a change from a positive polarity state or i.e. the inner circle to a negative polarity state or i.e. the outer circle generates the same property that defines the Polarity and Flip bits of the FRP symbol .

The Rotation bit of the FRP symbol is not affected by misalignments that result in the clockwise or counter clockwise order of states being preserved as a result of wire permutation. For example the clockwise order of the wires remains constant for the ABC BCA and CAB configurations which are represented as the permutation circle the permutation circle and the permutation circle . The Rotation bit of the FRP symbol is inverted by misalignments that result in the clockwise and counter clockwise order of states being altered as a result of wire permutation. For example the clockwise order of the wires is reversed for the ACB BAC and CBA configurations which are represented as permutation circle the permutation circle and the permutation circle . The table in maps wire states of an un permutated trio of wires to states occurring for different permutations of wire configuration. A simple swap of any pair of signals for example configurations BAC ACB CBA will change the direction of rotation but the Polarity bit and the Flip bit are unaffected.

Certain transmitters and receivers constructed according to certain aspects disclosed herein may invert the Rotation bit of an FRP symbol in order to correct wire misalignments in a 3 wire 3 phase interface including in a MIPI Alliance C PHY high speed mode interface for example. In one example the Rotation bit of an FRP symbol may be inverted at an encoder of a transmitter adapted according to certain aspects disclosed herein. In another example the Rotation bit of an FRP symbol may be inverted at a decoder of a receiver adapted according to certain aspects disclosed herein. In another example the Rotation bit of an FRP symbol may be inverted at a demapper of a receiver adapted according to certain aspects disclosed herein. In another example the Rotation bit of an FRP symbol may be inverted at a mapper of a transmitter adapted according to certain aspects disclosed herein.

At the receiver a Receiver Symbol Decoder decodes a sequence of FRP symbols received from the data link . In wire aligned or alignment corrected operation the Receiver Symbol Decoder produces a sequence of FRP symbols that is provided to a Serial to Parallel Converter which in turn provides a 21 bit word to a Demapper . The 16 bit output of the Demapper corresponds to the input of the transmitter .

As noted herein the sequence of FRP symbols received at the receiver may appear to be different from the sequence of 3 bit symbols transmitted by the transmitter due to wire misalignment.

In some instances the inversion of Rotation bits is performed on the 21 bit bus deployed between the Mapper and Parallel to Serial Converter of the transmitter side and or on the 21 bit bus between the Serial to Parallel Converter and the Demapper of the receiver . In these examples an inverting exclusive OR gate may be provided for each of the seven rotation bits in the 21 bit bus.

With reference now to wiring misalignments may be corrected in a Mapper or Demapper adapted in accordance with certain aspects disclosed herein. In a transmitter the Mapper may be adapted to modify mapping criteria and or one or more tables used in mapping data to a sequence of FRP symbols. Accordingly the Mapper may respond to a TRUE logic level on the Tx InvR signal by producing altered FRP symbols that are inconsistent with coding for an aligned 3 wire interface. The encoding of the altered FRP symbols may be affected by the misalignment of the 3 wire interface in a manner that produces proper decoding at the receiver . In the receiver the Demapper may be adapted to modify mapping criteria and or one or more tables used in demapping data from a sequence of FRP symbols. Accordingly the Demapper may respond to a TRUE logic level on the Rx InvR signal by producing an output that corresponds to the input when FRP symbols have been altered in transmission over a misaligned 3 wire interface.

In some instances a transmitter and or receiver constructed according to certain aspects disclosed herein may be provided on a semiconductor IC device. In one example an IC device may be mounted on a circuit board in the anticipation that the configuration of interconnects will remain fixed. In this example the decision on whether to invert the Rotation bit will remain constant for that particular device. That is the Rx InvR signal and Tx InvR signal settings remain constant. The Rx InvR signal and Tx InvR signal or internal flags and or switches in the Mapper Symbol Encoder Driver Demapper and or Receiver Symbol Decoder may indicate a wiring configuration or permutation may be a configuration parameter that is sent to the PHY. In one example the configuration parameter may range between 0 and 5 indicating the exact permutation and the PHY may determine whether to invert the Rotation bit of the FRP symbol in a manner consistent with the logic shown in the tables of respectively.

According to certain aspects the configuration of the wires in the 3 wire link may be determined during startup or training of a 3 wire 3 phase link. In some instances symbols are transmitted over the 3 wire link to enable clock acquisition at the receiver and for other purposes. In some instances a fixed sequence of symbols is transmitted that may be recognizable when the wiring is aligned and unrecognizable when wiring is unaligned. A receiver may alternate inversion status of the Rotation bit during synchronization until the synchronization sequence is recognized and may thereby determine whether inversion is required during normal operation.

In the illustrated example the processing circuit may be implemented with a bus architecture represented generally by the bus . The bus may include any number of interconnecting buses and bridges depending on the specific application of the processing circuit and the overall design constraints. The bus links together various circuits including the one or more processors and storage . Storage may include memory devices and mass storage devices and may be referred to herein as computer readable media and or processor readable media. The bus may also link various other circuits such as timing sources timers peripherals voltage regulators and power management circuits. A bus interface may provide an interface between the bus and one or more line interface circuits . A line interface circuit may be provided for each networking technology supported by the processing circuit. In some instances multiple networking technologies may share some or all of the circuitry or processing modules found in a line interface circuit . Each line interface circuit provides a means for communicating with various other apparatus over a transmission medium. Depending upon the nature of the apparatus a user interface e.g. keypad display speaker microphone joystick may also be provided and may be communicatively coupled to the bus directly or through the bus interface .

A processor may be responsible for managing the bus and for general processing that may include the execution of software stored in a computer readable medium that may include the storage . In this respect the processing circuit including the processor may be used to implement any of the methods functions and techniques disclosed herein. The storage may be used for storing data that is manipulated by the processor when executing software and the software may be configured to implement any one of the methods disclosed herein.

One or more processors in the processing circuit may execute software. Software shall be construed broadly to mean instructions instruction sets code code segments program code programs subprograms software modules applications software applications software packages routines subroutines objects executables threads of execution procedures functions algorithms etc. whether referred to as software firmware middleware microcode hardware description language or otherwise. The software may reside in computer readable form in the storage or in an external computer readable medium. The external computer readable medium and or storage may include a non transitory computer readable medium. A non transitory computer readable medium includes by way of example a magnetic storage device e.g. hard disk floppy disk magnetic strip an optical disk e.g. a CD or a DVD a smart card a flash memory device e.g. a flash drive a card a stick or a key drive a RAM a ROM a programmable ROM PROM an erasable PROM EPROM an EEPROM a register a removable disk and any other suitable medium for storing software and or instructions that may be accessed and read by a computer. The computer readable medium and or storage may also include by way of example a carrier wave a transmission line and any other suitable medium for transmitting software and or instructions that may be accessed and read by a computer. Computer readable medium and or the storage may reside in the processing circuit in the processor external to the processing circuit or be distributed across multiple entities including the processing circuit . The computer readable medium and or storage may be embodied in a computer program product. By way of example a computer program product may include a computer readable medium in packaging materials. Those skilled in the art will recognize how best to implement the described functionality presented throughout this disclosure depending on the particular application and the overall design constraints imposed on the overall system.

The storage may maintain software maintained and or organized in loadable code segments modules applications programs etc. which may be referred to herein as software modules . Each of the software modules may include instructions and data that when installed or loaded on the processing circuit and executed by the one or more processors contribute to a run time image that controls the operation of the one or more processors . When executed certain instructions may cause the processing circuit to perform functions in accordance with certain methods algorithms and processes described herein.

Some of the software modules may be loaded during initialization of the processing circuit and these software modules may configure the processing circuit to enable performance of the various functions disclosed herein. For example some software modules may configure internal devices and or logic circuits of the processor and may manage access to external devices such as the line interface circuits the bus interface the user interface timers mathematical coprocessors and so on. The software modules may include a control program and or an operating system that interacts with interrupt handlers and device drivers and that controls access to various resources provided by the processing circuit . The resources may include memory processing time access to the line interface circuits the user interface and so on.

One or more processors of the processing circuit may be multifunctional whereby some of the software modules are loaded and configured to perform different functions or different instances of the same function. The one or more processors may additionally be adapted to manage background tasks initiated in response to inputs from the user interface the line interface circuits and device drivers for example. To support the performance of multiple functions the one or more processors may be configured to provide a multitasking environment whereby each of a plurality of functions is implemented as a set of tasks serviced by the one or more processors as needed or desired. In one example the multitasking environment may be implemented using a timesharing program that passes control of a processor between different tasks whereby each task returns control of the one or more processors to the timesharing program upon completion of any outstanding operations and or in response to an input such as an interrupt. When a task has control of the one or more processors the processing circuit is effectively specialized for the purposes addressed by the function associated with the controlling task. The timesharing program may include an operating system a main loop that transfers control on a round robin basis a function that allocates control of the one or more processors in accordance with a prioritization of the functions and or an interrupt driven main loop that responds to external events by providing control of the one or more processors to a handling function.

In one example the processing circuit may be provided in an apparatus that includes a communications interface coupled to the line interface circuits and configured to communicate data using a 3 phase signal transmitted in different phases on all three wires of a 3 wire communication link and correction logic configured to correct phase relationships between two or more signals carried on the 3 wire communication link. The processing circuit may be configured to determine presence of a misalignment of the 3 wire communication link and cause the correction logic to invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire interface when a misalignment of the 3 wire communication link involving two or more wires is determined to affect the phase relationships between two or more signals carried on the 3 wire interface.

The processing circuit may be configured to select a table used to map data values to sequences of symbols based on whether a misalignment of the 3 wire communication link is determined to be present. Each symbol may be a 3 bit symbol in which the first bit is inverted in a first table that is selected when the misalignment of the 3 wire communication link is determined to affect phase relationships between the two or more signals. The first bit in each symbol of the sequence of symbols is not inverted in a second table that is selected when the misalignment of the 3 wire communication link is determined not to affect phase relationships between the two or more signals.

The processing circuit may be configured to determine the presence of the misalignment of the 3 wire communication link by toggling the first bit in each symbol of a sequence of symbols transmitted on the 3 wire communication link during synchronization of the 3 wire communication link until synchronization information is decoded from sequence of symbols. The storage may maintain configuration information that indicates whether of the misalignment of the 3 wire communication link is present.

At block the device may determine presence of a misalignment of the 3 wire communication link involving two or more wires. The 3 phase signal must be transmitted on all wires of the 3 wire communication link in different phases.

At block the device may invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire communication link when the misalignment of the 3 wire communication link is determined to affect phase relationships between two or more signals carried on the 3 wire communication link. Inverting the first bit may reverse an effect of the misalignment of the 3 wire communication link.

According to certain aspects the device may determine presence of the misalignment of the 3 wire communication link by determining that a receiver coupled to the 3 wire communication link has detected an incorrect direction of phase rotation between states of the 3 phase signal at the transition of signaling state of the 3 wire communication link. In one example misalignments may be accurately determined when the direction of phase rotation is known or expected. For example one or more preambles defined by C PHY standards for transmission at the beginning of a high speed burst may be used to determine presence or absence of misalignments.

As illustrated the Start Preamble includes 7 symbols that have an FRP value of 3. The number of symbols provided in the Start Preamble may be based on specifications governing operation of the 3 phase interface and or may be selected according to application needs. In one example the Start Preamble which may also be referred to as the PreBegin may have a number of symbols that can range between 7 symbols and 448 symbols. The User Preamble when transmitted includes 14 user defined symbols and the End Preamble includes 7 symbols that have an FRP value of 3. A SYNC sequence having a unique combination of 7 symbols which for example may begin and end with symbols that have an FRP value of 3 with the remaining 5 symbols having an FRP value of 4.

In some instances the device may be adapted or configured to determine presence or absence of a misalignment of the 3 wire communication link using the Start preamble where each of the at least 7 symbols in the Start preamble has an FRP value of 3 no flip positive clockwise rotation and invert polarity . When a wire misalignment occurs such that the wires are permuted in a sequence that inverted the rotation then the preamble would be received as a sequence of symbols that each have an FRP value of 1. An auto detection circuit provided in the receiver may then monitor the Start Preamble at the beginning of each high speed burst. In some instances the configuration of wires in the 3 wire communication link may be assessed during the first high speed burst and or during the next high speed burst occurring after an error has been detected in a high speed transmission. In some instances other fields of the Startup Sequence may be used to determine or confirm the configuration of wires in the 3 wire communication link. The configuration of wires in the 3 wire communication link once determined may be used to configure low power mode drivers and receivers.

Referring again to in some examples the device may receive the 3 phase signal from the 3 wire communication link. The first bit of the 3 bit symbol may indicate direction of phase rotation between states of the 3 phase signal at the transition of signaling state of the 3 wire communication link.

In some examples the device may transmit the 3 phase signal over the 3 wire communication link. The first bit of the 3 bit symbol may control direction of phase rotation between states of the 3 phase signal at the transition of signaling state of the 3 wire communication link.

In some examples the device may select a table used by a mapper based on whether a misalignment of the 3 wire communication link is determined to be present. The 3 bit symbol may be one of a sequence of symbols generated by the mapper. The sequence of symbols may encode data to be transmitted over the 3 wire communication link. The first bit in each symbol of the sequence of symbols may be inverted in a first table that is selected when the misalignment of the 3 wire communication link is determined to affect phase relationships between the two or more signals. The first bit in each symbol of the sequence of symbols may not be inverted in a second table that is selected when the misalignment of the 3 wire communication link is determined not to affect phase relationships between the two or more signals.

In some examples the device may select a table used by a demapper to decode data from a sequence of symbols received from the 3 wire communication link. The table is selected from a plurality of tables based on whether a misalignment of the 3 wire communication link is determined to be present.

In some examples the device may determine the presence of the misalignment of the 3 wire communication link by receiving one or more sequences of symbols from the 3 wire communication link during a synchronization period and determining that the 3 wire communication link is properly aligned when one or more synchronization words are successfully decoded without inverting a rotation bit output by a demapper circuit.

In some examples the device may determine the presence of the misalignment of the 3 wire communication link by inverting the first bit in each symbol of a sequence of symbols received from the 3 wire communication link during synchronization of the 3 wire communication link determining that the 3 wire communication link is misaligned when synchronization information is decoded from sequence of symbols while the first bit in the each symbol is inverted.

In some examples the presence of the misalignment of the 3 wire communication link is determined from configuration information maintained by the device.

In some examples the 3 wire communication link may be operated according to MIPI Alliance C PHY 3 phase signaling standards.

The processor is responsible for general processing including the execution of software stored on the computer readable storage medium . The software when executed by the processor causes the processing circuit to perform the various functions described supra for any particular apparatus. The computer readable storage medium may also be used for storing data that is manipulated by the processor when executing software. The processing circuit further includes at least one of the modules and . The modules may be software modules running in the processor resident stored in the computer readable storage medium one or more hardware modules coupled to the processor or some combination thereof.

In one configuration the apparatus for wireless communication includes circuits or modules for determining presence of a misalignment of the 3 wire interface involving two or more wires and circuits or modules for inverting a first bit of a 3 bit symbol encoded in a transition of signaling state of the 3 wire bus when the misalignment of the 3 wire interface is determined to affect phase relationships between two or more signals carried on the three wires.

In one example the apparatus may include means for transmitting a 3 phase signal on each of the three wires of the 3 wire communication link in different phases including an encoder that encodes data in transitions of signaling state of the three wires of the communication link . The apparatus may include means for determining presence of a misalignment of the 3 wire interface involving two or more wires of the communication link . The apparatus may include means for correcting phase relationships between two or more signals carried on the three wires including logic configured to invert a first bit of a 3 bit symbol corresponding to a transition of signaling state of the 3 wire communication link when the misalignment of the 3 wire communication link is determined to affect the phase relationships between the two or more signals.

In some examples the 3 phase signal is received from the 3 wire communication link by a bus interface circuit . The first bit of the 3 bit symbol may indicate a direction of phase rotation between states of the 3 phase signal at the transition of signaling state of the 3 wire communication link .

In some examples the apparatus transmits the 3 phase signal over the 3 wire communication link . The first bit of the 3 bit symbol may control a direction of phase rotation between states of the 3 phase signal at the transition of signaling state of the 3 wire communication link .

In some examples data may be mapped to a sequence of symbols including a first table used by a mapper when a misalignment of the 3 wire communication link is determined to be present and a second table used by the mapper when no misalignment of the 3 wire communication link is determined to be present. The 3 bit symbol may be one of a sequence of symbols generated by the mapper the sequence of symbols encoding the data for transmission over the 3 wire communication link.

In some examples data may be decoded from a sequence of symbols received from the 3 wire communication link including a first table used by a demapper when a misalignment of the 3 wire communication link is determined to be present and a second table used by the demapper when no misalignment of the 3 wire communication link is determined to be present.

In some examples the apparatus may detect synchronization words received from the 3 wire communication link . A first circuit may be configured or adapted to detect the synchronization words decoded from a sequence of symbols received from the 3 wire communication link during a synchronization period. A second circuit may operate in a first mode to invert a first bit of each symbol in the sequence of symbols. The first bit is not inverted in a second mode. Control logic may cause the second circuit to toggle between the first mode and a second mode until the first circuit detects the synchronization words.

It is understood that the specific order or hierarchy of steps in the processes disclosed is an illustration of exemplary approaches. Based upon design preferences it is understood that the specific order or hierarchy of steps in the processes may be rearranged. The accompanying method claims present elements of the various steps in a sample order and are not meant to be limited to the specific order or hierarchy presented.

The previous description is provided to enable any person skilled in the art to practice the various aspects described herein. Various modifications to these aspects will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other aspects. Thus the claims are not intended to be limited to the aspects shown herein but is to be accorded the full scope consistent with the language claims wherein reference to an element in the singular is not intended to mean one and only one unless specifically so stated but rather one or more. Unless specifically stated otherwise the term some refers to one or more. All structural and functional equivalents to the elements of the various aspects described throughout this disclosure that are known or later come to be known to those of ordinary skill in the art are expressly incorporated herein by reference and are intended to be encompassed by the claims. Moreover nothing disclosed herein is intended to be dedicated to the public regardless of whether such disclosure is explicitly recited in the claims. No claim element is to be construed as a means plus function unless the element is expressly recited using the phrase means for. 

