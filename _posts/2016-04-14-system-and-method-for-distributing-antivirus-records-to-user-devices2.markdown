---

title: System and method for distributing antivirus records to user devices
abstract: Disclosed are system and method for distributing antivirus records to user devices. An exemplary method includes collecting, by a server, statistics on the use of antivirus records; calculating a coefficient of effectiveness of each antivirus record based on the statistics; identifying one or more most effective antivirus records whose coefficients of effectiveness exceed a predetermined effectiveness threshold; identifying one or more less effective antivirus records whose coefficients of effectiveness do not exceed the predetermined effectiveness threshold; transmitting identified most effective antivirus records to a plurality of user devices for storage in antivirus databases of the user devices; receiving, from the user devices, one or more less effective antivirus records removed from the antivirus databases of the user devices; and storing the received less effective antivirus records in an antivirus database of the server if said antivirus records were not in the antivirus database of the server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09578065&OS=09578065&RS=09578065
owner: AO Kaspersky Lab
number: 09578065
owner_city: Moscow
owner_country: RU
publication_date: 20160414
---
The present disclosure claims benefit of priority under 35 U.S.C. 119 a d to a Russian Application No. 2015141539 filed Sep. 30 2015 which is incorporated by reference herein.

The present invention relates generally to the field of computer security and more specifically to systems and methods for distributing antivirus records to user devices.

Among the multitude of applications there is a group of malicious programs which are able to cause harm to the user device or the data of the user such as Internet worms key loggers and computer viruses. There have been developed many different technologies for providing computer security such as antivirus software which is designed to detect malicious programs on the user device and to block their operating ability e.g. placing them in quarantine or removing them from the user device .

The antivirus software may use a number of different methods of detecting malicious software malicious processes other malicious objects of the operating system OS and links to them such as the URI Universal Resource Identifier such as file .exe . The most popular malware detection methods are signature analysis a technology for finding correspondences between a particular segment of code of the program being analyzed and a known code or signature in a database of signatures of malicious programs heuristic analysis a technology involving emulating the working of a program being analyzed creating an API Application Programming Interface function call log and finding correspondences between the data of the created API function call log and the data in a database of emulations of malicious programs and proactive analysis a technology involving intercepting API function calls launched in the system of the program being analyzed creating an API function call log and finding correspondences between the data of the created log and the data in a database of calls for API functions of malicious programs .

In operation each of the aforementioned methods requires data to be used for the detection of malicious objects for example in the case of signature analysis such data might be signatures for heuristic analysis such the data might be heuristic rules. Despite the fact that for example when a single signature is used the antivirus software may detect a whole array of malicious objects similar in their structure or in the harm caused. Therefore the ever increasing number of malicious objects which can cause harm to the user s data or to his computer requires a corresponding increase in the volume of data used for detecting malicious objects. In the majority of cases said data is stored on the user s computer as part of antivirus libraries a component of the antivirus software. Thus increasing the volume of data used for the detection may result in the decrease of available space on the hard drive of the user device.

Although there are known approaches aimed at optimizing reducing the space on a hard drive occupied by data used for the detection of malicious objects they are not able to solve the problem of distributing the data used for detecting malicious objects between a remote server and a local hard drive or they do not solve it effectively enough. Therefore there is a need for a more effective solution of the problem of distributing to user devices the data used for detecting malicious objects.

Disclosed are system and method for distributing antivirus records to user devices. An exemplary method includes collecting by a server statistics on the use of a plurality of antivirus records calculating a coefficient of effectiveness of each antivirus record based on the collected statistics on the use of a plurality of antivirus records identifying by the server one or more most effective antivirus records whose coefficients of effectiveness exceed a predetermined effectiveness threshold identifying by the server one or more less effective antivirus records whose coefficients of effectiveness do not exceed the predetermined effectiveness threshold transmitting by the server the one or more identified most effective antivirus records to a plurality of user devices for storage in antivirus databases of the user devices receiving from the user devices one or more less effective antivirus records removed from the antivirus databases of the user devices and storing the one or more received less effective antivirus records in an antivirus database of the server if said antivirus records were not in the antivirus database of the server.

In one exemplary aspect the antivirus record includes one or more of a signature of a malicious file a heuristic rule used for detection of a malicious file during emulation of the malicious file a heuristic rule used for detection of a malicious file during proactive detection and a locality sensitive hash of a malicious file.

In one exemplary aspect collecting statistics on the use of a plurality of antivirus records includes collecting information on a detection of a malicious file by an antivirus record.

In one exemplary aspect collecting statistics on the use of a plurality antivirus records includes collecting statistics from antivirus applications deployed on a plurality of user devices.

In one exemplary aspect calculating a coefficient of effectiveness of an antivirus record as a function of a number of unique user devices on which malicious files were detected using said antivirus record and a time between a moment of creation of said antivirus record and a moment of calculation of the coefficient of effectiveness of said antivirus record.

In one exemplary aspect calculating a coefficient of effectiveness of an antivirus record further as a function of a number of different malicious files detected using said antivirus record and an average time between detections of malicious files using said antivirus record.

In one exemplary aspect transmitting the most effective antivirus records to a plurality of user devices includes transmitting the most effective antivirus record to a user devices when the effectiveness coefficient of one of the most effective antivirus record exceeds the effectiveness coefficient of at least one less effective antivirus record on the user device.

An exemplary system for distributing antivirus records to user devices includes a server having a hardware processor configured to collect statistics on the use of a plurality of antivirus records calculate a coefficient of effectiveness of each antivirus record based on the collected statistics on the use of a plurality of antivirus records identify one or more most effective antivirus records whose coefficients of effectiveness exceed a predetermined effectiveness threshold identify one or more less effective antivirus records whose coefficients of effectiveness do not exceed the predetermined effectiveness threshold transmit the one or more identified most effective antivirus records to a plurality of user devices for storage in antivirus databases of the user devices receive from the user devices one or more less effective antivirus records removed from the antivirus databases of the user devices and store the one or more received less effective antivirus records in an antivirus database of the server if said antivirus records were not in the antivirus database of the server.

An exemplary non transitory computer readable medium storing computer executable instructions for distributing antivirus records to user devices includes instructions for collecting by a server statistics on the use of a plurality of antivirus records calculating by the server a coefficient of effectiveness of each antivirus record based on the collected statistics on the use of a plurality of antivirus records identifying by the server one or more most effective antivirus records whose coefficients of effectiveness exceed a predetermined effectiveness threshold identifying one or more less effective antivirus records whose coefficients of effectiveness do not exceed the predetermined effectiveness threshold transmitting the one or more identified most effective antivirus records to a plurality of user devices for storage in antivirus databases of the user devices receiving from the user devices one or more less effective antivirus records removed from the antivirus databases of the user devices and storing the one or more received less effective antivirus records in an antivirus database of the server if said antivirus records were not in the antivirus database of the server.

The above simplified summary of example aspects of the invention serves to provide a basic understanding of the invention. This summary is not an extensive overview of all contemplated aspects and is intended to neither identify key or critical elements of all aspects nor delineate the scope of any or all aspects of the invention. Its sole purpose is to present one or more aspects in a simplified form as a prelude to the more detailed description of the invention that follows. To the accomplishment of the foregoing the one or more aspects of the present invention include the features described and particularly pointed out in the claims.

Example aspects of the present invention are described herein in the context of a system method and computer program product for distribution of antivirus records to user devices. Those of ordinary skill in the art will realize that the following description is illustrative only and is not intended to be in any way limiting. Other aspects will readily suggest themselves to those skilled in the art having the benefit of this disclosure. Reference will now be made in detail to implementations of the example aspects as illustrated in the accompanying drawings. The same reference indicators will be used to the extent possible throughout the drawings and the following description to refer to the same or like items.

Initially a number of definitions of terms which will be used in describing various exemplary aspects of the invention will be provided herein below.

The statistics of use of an antivirus record may include information about the number of malicious files detected by an antivirus application using antivirus record the number of users on whose computers said malicious files were detected the location of each detected malicious file for example location on the drive and also the IP address of the computer on which the file resides the time of each detection and also the time of creation of the antivirus record used for the detection of malicious files.

The coefficient of effectiveness of an antivirus record is a numerical value the larger it is the more malicious files have been detected by the antivirus application using a particular antivirus record. It is presumed that the larger the coefficient of effectiveness of an antivirus record the more important it is for this antivirus record to be used by the antivirus application and to be present on the user s computer and not on a remote server since antivirus records on a remote server might not be accessible to the antivirus application for example due to connection problems between the computer and the remote server.

The antivirus application is also configured to collect statistics on the use of antivirus records which are used for the detection of malicious files. In one exemplary aspect these statistics may be collected upon detection of a malicious file with the use of the antivirus record on the user s computer . In yet another exemplary aspect another antivirus application not shown in may also reside on the remote server . This application also collects statistics on the use of antivirus records using a files database specifically upon detection of malicious files with the use of the antivirus records among the files of the files database . In one exemplary aspect the statistics collected by the antivirus application are sent to the remote server for storage in a database of statistics on the use of antivirus records .

It should be noted that the statistics on use of an antivirus record may be collected by a plurality of antivirus applications installed on a plurality of computers including the antivirus application running on the remote server . In such a case each antivirus application sends statistics on the use of the antivirus record to the remote server specifically to the database of statistics on the use of antivirus records which stores the totality of information on the use of the antivirus record by each of the antivirus applications.

In one exemplary aspect new antivirus records which are created for example by a computer security expert or by any of the known automated methods of creation of antivirus records are transferred by a distribution module to a database of antivirus records for use by the antivirus application . In yet another exemplary aspect new antivirus records which are created for example by a computer security expert or by any of the known automated methods of creation of antivirus records are transferred by the distribution module to the database of antivirus records for use by the antivirus application .

A module for evaluating effectiveness of antivirus records residing on the remote server is configured to calculate the coefficient of effectiveness of an antivirus record using the statistics on the use of the antivirus record that are stored in the database of statistics on the use of antivirus records . In one exemplary aspect the coefficient of effectiveness of each antivirus record can be calculated using of the following formula 

In another one exemplary aspect the coefficient of effectiveness of an antivirus record may be calculated using another formula 

The calculated coefficients of effectiveness are transferred by the module for evaluating effectiveness to the antivirus application on the computer and also to the distribution module . In one exemplary aspect the distribution module can be a component of the aforementioned antivirus application residing on the remote server . The distribution module is able to transfer the antivirus records stored in the database of antivirus records residing on the remote server to the antivirus application to the database of antivirus records residing on the computer . The antivirus application is also able to transfer the antivirus records stored in the database of antivirus records residing on the computer to the database of antivirus records residing on the remote server . In one exemplary aspect the antivirus application and the distribution module are able to modify the databases of antivirus records and by adding removing or replacing the antivirus records from these databases.

The task of distribution of the antivirus records changing their location between the remote server and the computer consists in assuring a reliable and rapid access of the antivirus application to the effective antivirus records wherein in the given context effective antivirus records means antivirus records with the largest values of the coefficients of effectiveness. Therefore the most effective antivirus records should preferably reside on the computer specifically in the database of antivirus records . At the same time less effective records should be also accessible to the antivirus application but they may be stored on the remote server in the database .

The distribution module by using the obtained coefficients of effectiveness of the antivirus records checks whether the antivirus records which are stored on the remote server specifically in the database of antivirus records contain antivirus records whose coefficients of effectiveness are among the largest coefficients of effectiveness computed by the module for evaluating effectiveness . The largest coefficients of effectiveness are the group of coefficients of effectiveness with the largest values. This group is limited in size by a threshold value the number of elements in the group cannot exceed the threshold value. In one exemplary aspect the threshold value can take on the value . In one exemplary aspect if the coefficient of effectiveness of an antivirus record being stored on the remote server in the database of antivirus records is among the number of the largest coefficients of effectiveness of the antivirus records where this number does not exceed the threshold value as indicated above the distribution module transfers this antivirus record to the computer specifically to the database of antivirus records so that the antivirus application makes use of that antivirus record. In one exemplary aspect the antivirus record transferred to the computer may be removed from the database of antivirus records residing on the remote server . In yet another exemplary aspect the antivirus record transferred to the computer is not removed from the database of antivirus records residing on the remote server .

In one exemplary aspect if the coefficient of effectiveness of an antivirus record which is being stored on the remote server in the database of antivirus records is not among the number of the largest coefficients of effectiveness of the antivirus records where this number does not exceed the threshold value as indicated above the distribution module does not transfer this antivirus record to the computer specifically to the database of antivirus records for the antivirus application to use that antivirus record.

The antivirus application uses the received coefficients of effectiveness of the antivirus records to check whether the antivirus records being stored on the computer specifically in the database of antivirus records contain antivirus records whose coefficients of effectiveness are among the largest coefficients of effectiveness computed by the module for evaluating effectiveness . The largest coefficients of effectiveness are the group of coefficients of effectiveness with the largest values. This group is limited in size by a threshold value the number of elements in the group cannot exceed the threshold value. In one exemplary aspect the threshold value can take on the value . In one exemplary aspect if the coefficient of effectiveness of an antivirus record being stored on the computer in the database of antivirus records is not among the number of the largest coefficients of effectiveness of the antivirus records where this number does not exceed the threshold value as indicated above the antivirus application transfers this antivirus record to the remote server specifically to the database of antivirus records so that the antivirus application makes use of that antivirus record. In one exemplary aspect the antivirus record transferred to the remote server is removed from the database of antivirus records residing on the computer . In yet another exemplary aspect the antivirus record transferred to the remote server is not removed from the database of antivirus records residing on the computer .

In one exemplary aspect if the coefficient of effectiveness of an antivirus record which is being stored on the computer in the database of antivirus records is among the number of the largest coefficients of effectiveness of the antivirus records where this number does not exceed the threshold value as indicated above the antivirus application does not transfer this antivirus record to the remote server specifically to the database of antivirus records for the antivirus application to make use of that antivirus record.

It should be noted that both the antivirus application and the distribution means can transfer more than one antivirus record in the aforementioned manner. In one exemplary aspect the aforementioned threshold values limiting the size of the group of coefficients of effectiveness with the largest values take on the same value.

In one exemplary aspect the distribution module transfers the antivirus record being stored in the database of antivirus records to the user s computer specifically to the database of antivirus records only when the coefficient of effectiveness of this antivirus record exceeds the coefficient of effectiveness of another antivirus record being stored on the computer specifically in the database of antivirus records by more than an established percentage such as 10 as determined by a computer security expert for example the coefficient of effectiveness of said antivirus record being stored on the computer not being among the largest coefficients of effectiveness of the antivirus records. For example if the database of antivirus records has an antivirus record whose coefficient of effectiveness is 551 while the database of antivirus records has an antivirus record whose coefficient of effectiveness is 500 the distribution module will transfer to the database of antivirus records the antivirus record being stored in the database of antivirus records whose coefficient of effectiveness is 551 10 of the number is 50 and 551 is larger than 500 by more than 10 . In one exemplary aspect when comparing two coefficients of effectiveness the established percentage which must be exceeded by the coefficient of effectiveness of the antivirus record from the database of antivirus records in order for this antivirus record to be transferred to the database of antivirus records is calculated on the basis of the lesser of the two coefficients of effectiveness being compared.

In one exemplary aspect the antivirus application transfers the antivirus record being stored in the database of antivirus records to the remote server specifically to the database of antivirus records only when the coefficient of effectiveness of another antivirus record being stored on the remote server specifically in the database of antivirus records exceeds the coefficient of effectiveness of this antivirus record being stored on the computer by more than an established percentage such as 10 as determined by a computer security expert for example the coefficient of effectiveness of said antivirus record being stored on the remote server being among the largest coefficients of effectiveness of the antivirus records. For example if the database of antivirus records has an antivirus record whose coefficient of effectiveness is 500 while the database of antivirus records has an antivirus record whose coefficient of effectiveness is 551 the antivirus application will transfer to the database of antivirus records the antivirus record being stored in the database of antivirus records whose coefficient of effectiveness is 500 10 of the number is 50 and 551 is larger than 500 by more than 10 . In one exemplary aspect when comparing two coefficients of effectiveness the established percentage which must be exceeded by the coefficient of effectiveness of the antivirus record from the database of antivirus records in order for the antivirus record from the database of antivirus records to be transferred to the database of antivirus records is calculated on the basis of the lesser of the two coefficients of effectiveness being compared.

The information on the locations of the antivirus records which is used by the antivirus application and the distribution module for making a decision on the transfer of the antivirus records is obtained by the antivirus application and the distribution module from the database of statistics on the use of antivirus records .

In one exemplary aspect the antivirus records which the antivirus application should transfer according to the above described logic from the database of antivirus records to the database of antivirus records are removed from the database of antivirus records . The database of antivirus records residing on the remote server may contain the full set of antivirus records which are being used by the antivirus application the database of antivirus records may additionally contain copies of the antivirus records being stored in the database indicating that these antivirus records are copies. Thus the transfer of the antivirus records from the database of antivirus records to the database of antivirus records may involve the removal of corresponding antivirus records from the database of antivirus records and also the removal of the indication for the copies of the removed antivirus records that said antivirus records are copies where the copies reside in the database of antivirus records . Consequently when an antivirus record is moved by the distribution module from the database of antivirus records to the database of antivirus records the distribution module may create a copy of the antivirus record being moved in the database of antivirus records indicating that the created antivirus record is a copy.

The personal computer in turn includes a hard disk for reading and writing of data a magnetic disk drive for reading and writing on removable magnetic disks and an optical drive for reading and writing on removable optical disks such as CD ROM DVD ROM and other optical information media. The hard disk the magnetic disk drive and the optical drive are connected to the system bus across the hard disk interface the magnetic disk interface and the optical drive interface respectively. The drives and the corresponding computer information media are effectiveness independent modules for storage of computer instructions data structures program modules and other data of the personal computer .

The present disclosure provides the implementation of a system that uses a hard disk a removable magnetic disk and a removable optical disk but it should be understood that it is possible to employ other types of computer information media which are able to store data in a form readable by a computer solid state drives flash memory cards digital disks random access memory RAM and so on which are connected to the system bus via the controller .

The computer has a file system where the recorded operating system is stored and also additional program applications other program modules and program data . The user is able to enter commands and information into the personal computer by using input devices keyboard mouse . Other input devices not shown can be used microphone joystick game controller scanner and so on. Such input devices usually plug into the computer system through a serial port which in turn is connected to the system bus but they can be connected in other ways for example with the aid of a parallel port a game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus across an interface such as a video adapter . In addition to the monitor the personal computer can be equipped with other peripheral output devices not shown such as loudspeakers a printer and so on.

The personal computer is able to operate in a network environment using a network connection to one or more remote computers . The remote computer or computers are also personal computers or servers having the majority or all of the aforementioned elements in describing the nature of a personal computer . Other devices can also be present in the computer network such as routers network stations peer devices or other network nodes.

Network connections can form a local area computer network LAN and a wide area computer network WAN . Such networks are used in corporate computer networks and internal company networks and they generally have access to the Internet. In LAN or WAN networks the personal computer is connected to the local area network across a network adapter or network interface . When networks are used the personal computer can employ a modem or other modules for providing communications with a wide area computer network such as the Internet. The modem which is an internal or external device is connected to the system bus by a serial port . It should be noted that the network connections are only examples and need not depict the exact configuration of the network i.e. in reality there are other ways of establishing a connection of one computer to another by technical communication modules.

In various aspects the systems and methods described herein may be implemented in hardware software firmware or any combination thereof. If implemented in software the methods may be stored as one or more instructions or code on a non transitory computer readable medium. Computer readable medium includes data storage. By way of example and not limitation such computer readable medium can comprise RAM ROM EEPROM CD ROM Flash memory or other types of electric magnetic or optical storage medium or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a processor of a general purpose computer.

In various aspects the systems and methods described in the present disclosure can be addressed in terms of modules. The term module as used herein refers to a real world device component or arrangement of components implemented using hardware such as by an application specific integrated circuit ASIC or field programmable gate array FPGA for example or as a combination of hardware and software such as by a microprocessor system and a set of instructions to implement the module s functionality which while being executed transform the microprocessor system into a special purpose device. A module can also be implemented as a combination of the two with certain functions facilitated by hardware alone and other functions facilitated by a combination of hardware and software. In certain implementations at least a portion and in some cases all of a module can be executed on the processor of a general purpose computer such as the one described in greater detail in above . Accordingly each module can be realized in a variety of suitable configurations and should not be limited to any particular implementation exemplified herein.

In the interest of clarity not all of the routine features of the aspects are disclosed herein. It would be appreciated that in the development of any actual implementation of the present disclosure numerous implementation specific decisions must be made in order to achieve the developer s specific goals and these specific goals will vary for different implementations and different developers. It is understood that such a development effort might be complex and time consuming but would nevertheless be a routine undertaking of engineering for those of ordinary skill in the art having the benefit of this disclosure.

Furthermore it is to be understood that the phraseology or terminology used herein is for the purpose of description and not of restriction such that the terminology or phraseology of the present specification is to be interpreted by the skilled in the art in light of the teachings and guidance presented herein in combination with the knowledge of the skilled in the relevant art s . Moreover it is not intended for any term in the specification or claims to be ascribed an uncommon or special meaning unless explicitly set forth as such.

The various aspects disclosed herein encompass present and future known equivalents to the known modules referred to herein by way of illustration. Moreover while aspects and applications have been shown and described it would be apparent to those skilled in the art having the benefit of this disclosure that many more modifications than mentioned above are possible without departing from the inventive concepts disclosed herein.

