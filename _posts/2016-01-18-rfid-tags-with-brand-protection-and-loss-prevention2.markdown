---

title: RFID tags with brand protection and loss prevention
abstract: Brand-protection codes may be used to maintain authenticity chains for items or tags across a number of different entities. A first entity, such as a tag or item manufacturer, may generate a first brand-protection code (BPC) based on a first key and a tag or item identifier and store the first BPC on a tag associated with an item. A second entity that receives the tag and/or item may attempt to authenticate the first BPC. If the second entity authenticates the first BPC, the second entity may generate an authentication code based on a second key and the first BPC and/or the tag/item identifier, and may write the authentication code to the tag. In some embodiments, the authentication code may be a second brand-protection code, or an exit code that allows the item to exit a facility such as a retail store.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09607286&OS=09607286&RS=09607286
owner: Impinj, Inc.
number: 09607286
owner_city: Seattle
owner_country: US
publication_date: 20160118
---
This application claims the benefit of U.S. Provisional Patent Application Ser. No. 62 105 564 filed on Jan. 20 2015. The disclosures of the above application are hereby incorporated by reference for all purposes.

Radio Frequency Identification RFID systems typically include RFID readers also known as RFID reader writers or RFID interrogators and RFID tags. RFID systems can be used in many ways for locating and identifying objects to which the tags are attached. RFID systems are useful in product related and service related industries for tracking objects being processed inventoried or handled. In such cases an RFID tag is usually attached to an individual item or to its package.

In principle RFID techniques entail using an RFID reader to inventory one or more RFID tags where inventorying involves at least singulating a tag and receiving an identifier from the singulated tag. Singulated is defined as a reader singling out one tag potentially from among multiple tags for a reader tag dialog. Identifier is defined as a number identifying the tag or the item to which the tag is attached such as a tag identifier TID electronic product code EPC etc. The reader transmitting a Radio Frequency RF wave performs the interrogation. The RF wave is typically electromagnetic at least in the far field. The RF wave can also be predominantly electric or magnetic in the near or transitional near field. The RF wave may encode one or more commands that instruct the tags to perform one or more actions.

In typical RFID systems an RFID reader transmits a modulated RF inventory signal a command receives a tag reply and transmits an RF acknowledgement signal responsive to the tag reply. A tag that senses the interrogating RF wave may respond by transmitting back another RF wave. The tag either generates the transmitted back RF wave originally or by reflecting back a portion of the interrogating RF wave in a process known as backscatter. Backscatter may take place in a number of ways.

The reflected back RF wave may encode data stored in the tag such as a number. The response is demodulated and decoded by the reader which thereby identifies counts or otherwise interacts with the associated item. The decoded data can denote a serial number a price a date a time a destination an encrypted message an electronic signature other attribute s any combination of attributes and so on. Accordingly when a reader receives tag data it can learn about the item that hosts the tag and or about the tag itself.

An RFID tag typically includes an antenna section a radio section a power management section and frequently a logical section a memory or both. In some RFID tags the power management section included an energy storage device such as a battery. RFID tags with an energy storage device are known as battery assisted semi active or active tags. Other RFID tags can be powered solely by the RF signal they receive. Such RFID tags do not include an energy storage device and are called passive tags. Of course even passive tags typically include temporary energy and data flag storage elements such as capacitors or inductors.

Counterfeiting is a problem in many areas of global commerce. For example retail goods manufacturers such as manufacturers of luxury clothing or purses often find counterfeit items in the marketplace. Many commercial enterprises envision using cryptographically secure RFID systems to ascertain whether a tagged item or more particularly the tag attached to an item is genuine and not counterfeit.

This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended as an aid in determining the scope of the claimed subject matter.

Embodiments are directed to maintaining authenticity chains for items or tags across different entities. A first entity such as a tag or item manufacturer may generate a first brand protection code BPC based on a first key and a tag or item identifier and store the first BPC on a tag associated with an item. A second entity that receives the tag and or item may attempt to authenticate the first BPC. If the second entity authenticates the first BPC the second entity may generate an authentication code based on a second key and the first BPC and or the tag item identifier and may write the authentication code to the tag. In some embodiments the authentication code may be a second brand protection code or an exit code that allows the item to exit a facility such as a retail store.

These and other features and advantages will be apparent from a reading of the following detailed description and a review of the associated drawings. It is to be understood that both the foregoing general description and the following detailed description are explanatory only and are not restrictive of aspects as claimed.

In the following detailed description references are made to the accompanying drawings that form a part hereof and in which are shown by way of illustration specific embodiments or examples. These embodiments or examples may be combined other aspects may be utilized and structural changes may be made without departing from the spirit or scope of the present disclosure. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined by the appended claims and their equivalents.

As used herein memory is one of ROM RAM SRAM DRAM NVM EEPROM FLASH Fuse MRAM FRAM and other similar information storage technologies as will be known to those skilled in the art. Some portions of memory may be writeable and some not. Command refers to a reader request for one or more tags to perform one or more actions and includes one or more tag instructions preceded by a command identifier or command code that identifies the command and or the tag instructions. Instruction refers to a request to a tag to perform a single explicit action e.g. write data into memory . Program refers to a request to a tag to perform a set or sequence of instructions e.g. read a value from memory and if the read value is less than a threshold then lock a memory word . Protocol refers to an industry standard for communications between a reader and a tag and vice versa such as the Class 1 Generation 2 UHF RFID Protocol for Communications at 860 MHz 960 MHz by GSI EPCglobal Inc. Gen2 Specification versions 1.2.0 and 2.0 of which are hereby incorporated by reference.

In some applications RFID solutions may use RFID tags attached to items for brand protection and electronic article surveillance also known as loss prevention . Such solutions should solve a number of challenges. First a solution should be able to authenticate items at any point in an item s supply chain by using tags that are difficult to counterfeit yet at the same time be easily authenticated. Second a solution should be able to quickly discriminate authorized items e.g. those properly sold from unauthorized items preferably within milliseconds. Third a solution should allow theft prevention without per tag passwords which would require an entity such as a retailer to manage multiple tag passwords or keys. Fourth a solution should allow seamless product returns where a consumer can seamlessly return an item and a retailer can quickly authenticate the authenticity i.e. authenticate and authorization status of the item. Fifth a solution should allow discrimination between tags associated with different entities e.g. retailers ignoring tags from other entities while reliably detecting relevant tags and providing alarms and notifications if necessary. Sixth a solution should minimize false alarms while allowing seamless product returns without storing consumer information on a tag. Seventh a solution should not interfere with other uses of a tag.

In some embodiments brand protection and loss prevention applications may rely on a tag or item authenticity chain based on a number of identification or authentication codes stored on an RFID tag associated with an item. Initial tag or item authentication may involve a first brand protection code BPC stored on a tag by a tag or item manufacturer. The tag or item manufacturer having itself manufactured the tag or item knows that the tag or item is authentic and generates and stores the first BPC on the tag. The first BPC may be generated to allow other entities to authenticate i.e. verify the integrity and authenticity of the first BPC for example based on cryptographic techniques as described below and may serve as a first link in the authenticity chain of the tag or item.

A retailer or facility owner upon receiving the tagged item may authenticate the first BPC for example by using a manufacturer secret or public key. Upon authentication of the first BPC the retailer or facility owner may subsequently generate and store an authentication code on the tag optionally overwriting the first BPC e.g. to reduce memory usage . For example the authentication code may be a second BPC or may be an exit code e.g. a sold code that authorizes the tag to exit a store or facility. The authentication code similar to the first BPC may be generated to allow other entities to authenticate it and may be based on a tag or item identifier and or the first BPC. The authentication code serves as a second link in the authenticity chain of the tag or item and attests to the authenticity of the previous link the first BPC . Another entity that successfully authenticates the second link the authentication code can then be assured that previous links are also authentic because the retailer or facility owner only writes the second link upon authentication of the previous first link of the authenticity chain represented by the first BPC. Of course tag item authenticity chains may include more than two links and authentication of any link in a properly generated authenticity chain implicitly authenticates all preceding links.

Reader and tag communicate via signals and . When communicating each encodes modulates and transmits data to the other and each receives demodulates and decodes data from the other. The data can be modulated onto and demodulated from RF waveforms. The RF waveforms are typically in a suitable range of frequencies such as those near 900 MHz 13.56 MHz and so on.

The communication between reader and tag uses symbols also called RFID symbols. A symbol can be a delimiter a calibration value and so on. Symbols can be implemented for exchanging binary data such as 0 and 1 if that is desired. When symbols are processed by reader and tag they can be treated as values numbers and so on.

Tag can be a passive tag or an active or battery assisted tag i.e. a tag having its own power source . When tag is a passive tag it is powered from signal .

Tag is typically although not necessarily formed on a substantially planar inlay which can be made in many ways known in the art. Tag includes a circuit which may be implemented as an IC . In some embodiments IC is implemented in complementary metal oxide semiconductor CMOS technology. In other embodiments IC may be implemented in other technologies such as bipolar junction transistor BJT technology metal semiconductor field effect transistor MESFET technology and others as will be well known to those skilled in the art. IC is arranged on inlay .

Tag also includes an antenna for exchanging wireless signals with its environment. The antenna is often flat and attached to inlay . IC is electrically coupled to the antenna via suitable IC contacts not shown in . The term electrically coupled as used herein may mean a direct electrical connection or it may mean a connection that includes one or more intervening circuit blocks elements or devices. The electrical part of the term electrically coupled as used in this document shall mean a coupling that is one or more of ohmic galvanic capacitive and or inductive. Similarly the term electrically isolated as used herein means that electrical coupling of one or more types e.g. galvanic capacitive and or inductive is not present at least to the extent possible. For example elements that are electrically isolated from each other are galvanically isolated from each other capacitively isolated from each other and or inductively isolated from each other. Of course electrically isolated components will generally have some unavoidable stray capacitive or inductive coupling between them but the intent of the isolation is to minimize this stray coupling to a negligible level when compared with an electrically coupled path.

IC is shown with a single antenna port comprising two IC contacts electrically coupled to two antenna segments and which are shown here forming a dipole. Many other embodiments are possible using any number of ports contacts antennas and or antenna segments.

Diagram depicts top and side views of tag formed using a strap. Tag differs from tag in that it includes a substantially planar strap substrate having strap contacts and . IC is mounted on strap substrate such that the IC contacts on IC electrically couple to strap contacts and via suitable connections not shown . Strap substrate is then placed on inlay such that strap contacts and electrically couple to antenna segments and . Strap substrate may be affixed to inlay via pressing an interface layer one or more adhesives or any other suitable means.

Diagram depicts a side view of an alternative way to place strap substrate onto inlay . Instead of strap substrate s surface including strap contacts facing the surface of inlay strap substrate is placed with its strap contacts facing away from the surface of inlay . Strap contacts can then be either capacitively coupled to antenna segments through strap substrate or conductively coupled using a through via which may be formed by crimping strap contacts to antenna segments . In some embodiments the positions of strap substrate and inlay may be reversed with strap substrate mounted beneath inlay and strap contacts electrically coupled to antenna segments through inlay . Of course in yet other embodiments strap contacts may electrically couple to antenna segments through both inlay and strap substrate .

In operation the antenna receives a signal and communicates it to IC which both harvests power and responds if appropriate based on the incoming signal and the IC s internal state. If IC uses backscatter modulation then it responds by modulating the antenna s reflectance which generates response signal from signal transmitted by the reader. Electrically coupling and uncoupling the IC contacts of IC can modulate the antenna s reflectance as can varying the admittance of a shunt connected circuit element which is coupled to the IC contacts. Varying the impedance of a series connected circuit element is another means of modulating the antenna s reflectance.

In the embodiments of antenna segments and are separate from IC . In other embodiments the antenna segments may alternatively be formed on IC . Tag antennas according to embodiments may be designed in any form and are not limited to dipoles. For example the tag antenna may be a patch a slot a loop a coil a horn a spiral a monopole microstrip stripline or any other suitable antenna.

The components of the RFID system of may communicate with each other in any number of modes. One such mode is called full duplex. Another such mode is called half duplex and is described below.

RFID reader and RFID tag talk and listen to each other by taking turns. As seen on axis TIME when reader talks to tag the communication session is designated as R T and when tag talks to reader the communication session is designated as T R . Along the TIME axis a sample R T communication session occurs during a time interval and a following sample T R communication session occurs during a time interval . Of course interval is typically of a different duration than interval here the durations are shown approximately equal only for purposes of illustration.

According to blocks and RFID reader talks during interval and listens during interval . According to blocks and RFID tag listens while reader talks during interval and talks while reader listens during interval .

In terms of actual behavior during interval reader talks to tag as follows. According to block reader transmits signal which was first described in . At the same time according to block tag receives signal and processes it to extract data and so on. Meanwhile according to block tag does not backscatter with its antenna and according to block reader has no signal to receive from tag .

During interval tag talks to reader as follows. According to block reader transmits a Continuous Wave CW signal which can be thought of as a carrier that typically encodes no information. This CW signal serves both to transfer energy to tag for its own internal power needs and also as a carrier that tag can modulate with its backscatter. Indeed during interval according to block tag does not receive a signal for processing. Instead according to block tag modulates the CW emitted according to block so as to generate backscatter signal . Concurrently according to block reader receives backscatter signal and processes it.

Circuit shows two IC contacts suitable for coupling to antenna segments such as antenna segments of RFID tag of . When two IC contacts form the signal input from and signal return to an antenna they are often referred to as an antenna port. IC contacts may be made in any suitable way such as from metallic pads and so on. In some embodiments circuit uses more than two IC contacts especially when tag has more than one antenna port and or more than one antenna.

Circuit includes signal routing section which may include signal wiring signal muting busses receive transmit switches and so on that can route a signal to the components of circuit . In some embodiments IC contacts couple galvanically and or inductively to signal routing section . In other embodiments such as is shown in circuit includes optional capacitors and or which if present capacitively couple IC contacts to signal routing section . This capacitive coupling causes IC contacts to be galvanically decoupled from signal routing section and other circuit components.

Capacitive coupling and resultant galvanic decoupling between IC contacts and or and components of circuit is desirable in certain situations. For example in some RFID tag embodiments IC contacts and may galvanically connect to terminals of a tuning loop on the tag. In this situation capacitors and or galvanically decouple IC contact from IC contact thereby preventing the formation of a short circuit between the IC contacts through the tuning loop.

Capacitors may be implemented within circuit and or partly or completely external to circuit . For example a dielectric or insulating layer on the surface of the IC containing circuit may serve as the dielectric in capacitor and or capacitor . As another example a dielectric or insulating layer on the surface of a tag substrate e.g. inlay or strap substrate may serve as the dielectric in capacitors . Metallic or conductive layers positioned on both sides of the dielectric layer i.e. between the dielectric layer and the IC and between the dielectric layer and the tag substrate may then serve as terminals of the capacitors . The conductive layers may include IC contacts e.g. IC contacts antenna segments e.g. antenna segments or any other suitable conductive layers.

Circuit also includes a rectifier and PMU Power Management Unit that harvests energy from the RF signal received by antenna segments to power the circuits of IC during either or both reader to tag R T and tag to reader T R sessions. Rectifier and PMU may be implemented in any way known in the art.

Circuit additionally includes a demodulator that demodulates the RF signal received via IC contacts . Demodulator may be implemented in any way known in the art for example including a slicer an amplifier and so on.

Circuit further includes a processing block that receives the output from demodulator and performs operations such as command decoding memory interfacing and so on. In addition processing block may generate an output signal for transmission. Processing block may be implemented in any way known in the art for example by combinations of one or more of a processor memory decoder encoder and so on.

Circuit additionally includes a modulator that modulates an output signal generated by processing block . The modulated signal is transmitted by driving IC contacts and therefore driving the load presented by the coupled antenna segment or segments. Modulator may be implemented in any way known in the art for example including a switch driver amplifier and so on.

In one embodiment demodulator and modulator may be combined in a single transceiver circuit. In another embodiment modulator may modulate a signal using backscatter. In another embodiment modulator may include an active transmitter. In yet other embodiments demodulator and modulator may be part of processing block .

Circuit additionally includes a memory to store data . At least a portion of memory is preferably implemented as a Nonvolatile Memory NVM which means that data is retained even when circuit does not have power as is frequently the case for a passive RFID tag.

In some embodiments particularly in those with more than one antenna port circuit may contain multiple demodulators rectifiers PMUs modulators processing blocks and or memories.

In terms of processing a signal circuit operates differently during a R T session and a T R session. The different operations are described below in this case with circuit representing an IC of an RFID tag.

Version A shows as relatively obscured those components that do not play a part in processing a signal during a R T session. Rectifier and PMU may be active such as for converting RF power. Modulator generally does not transmit during a R T session and typically does not interact with the received RF signal significantly either because switching action in section of decouples modulator from the RF signal or by designing modulator to have a suitable impedance and so on.

Although modulator is typically inactive during a R T session it need not be so. For example during a R T session modulator could be adjusting its own parameters for operation in a future session and so on.

Version B shows as relatively obscured those components that do not play a part in processing a signal during a T R session. Rectifier and PMU may be active such as for converting RF power. Demodulator generally does not receive during a T R session and typically does not interact with the transmitted RF signal significantly either because switching action in section of decouples demodulator from the RF signal or by designing demodulator to have a suitable impedance and so on.

Although demodulator is typically inactive during a T R session it need not be so. For example during a T R session demodulator could be adjusting its own parameters for operation in a future session and so on.

In typical embodiments demodulator and modulator are operable to demodulate and modulate signals according to a protocol such as the Gen2 Specification mentioned above. In embodiments where circuit includes multiple demodulators and or modulators each may be configured to support different protocols or different sets of protocols. A protocol specifies in part symbol encodings and may include a set of modulations rates timings or any other parameter associated with data communications. In addition a protocol can be a variant of a stated specification such as the Gen2 Specification for example including fewer or additional commands than the stated specification calls for and so on. In such instances additional commands are sometimes called custom commands.

In some embodiments one or more of the blocks or components of reader system may be implemented as integrated circuits. For example local block one or more of the components of local block and or one or more of the remote component may be implemented as integrated circuits using CMOS technology BJT technology MESFET technology and or any other suitable implementation technology.

Local block is responsible for communicating with the tags. Local block includes a block of an antenna and a driver of the antenna for communicating with the tags. Some readers like that shown in local block contain a single antenna and driver. Some readers contain multiple antennas and drivers and a method to switch signals among them including sometimes using different antennas for transmitting and for receiving. Some readers contain multiple antennas and drivers that can operate simultaneously. A demodulator decoder block demodulates and decodes backscattered waves received from the tags via antenna driver block . Modulator encoder block encodes and modulates an RF wave that is to be transmitted to the tags via antenna driver block .

Local block additionally includes an optional local processor . Local processor may be implemented in any number of ways known in the art. Such ways include by way of examples and not of limitation digital and or analog processors such as microprocessors and digital signal processors DSPs controllers such as microcontrollers software running in a machine such as a general purpose computer programmable circuits such as Field Programmable Gate Arrays FPGAs Field Programmable Analog Arrays FPAAs Programmable Logic Devices PLDs Application Specific Integrated Circuits ASIC any combination of one or more of these and so on. In some cases some or all of the decoding function in block the encoding function in block or both may be performed instead by local processor . In some cases local processor may implement an encryption or authentication function in some cases one or more of these functions can be distributed among other blocks such as encoding block or may be entirely incorporated in another block.

Local block additionally includes an optional local memory . Local memory may be implemented in any number of ways known in the art including by way of example and not of limitation any of the memory types described above as well as any combination thereof. Local memory can be implemented separately from local processor or in an IC with local processor with or without other components. Local memory if provided can store programs for local processor to run if needed.

In some embodiments local memory stores data read from tags or data to be written to tags such as Electronic Product Codes EPCs Tag Identifiers TIDs and other data. Local memory can also include reference data that is to be compared to EPCs instructions and or rules for how to encode commands for the tags modes for controlling antenna secret keys key pairs and so on. In some of these embodiments local memory is provided as a database.

Some components of local block typically treat the data as analog such as the antenna driver block . Other components such as local memory typically treat the data as digital. At some point there is a conversion between analog and digital. Based on where this conversion occurs a reader may be characterized as analog or digital but most readers contain a mix of analog and digital functionality.

If remote components are provided they are coupled to local block via an electronic communications network . Network can be a Local Area Network LAN a Metropolitan Area Network MAN a Wide Area Network WAN a network of networks such as the internet or a local communication link such as a USB PCI and so on. Local block may include a local network connection for communicating with communications network . Communications on the network can be secure such as if they are encrypted or physically protected or insecure if they are not encrypted or otherwise protected.

There can be one or more remote component s . If more than one they can be located at the same location or in different locations. They can access each other and local block via communications network or via other similar networks and so on. Accordingly remote component s can use respective remote network connections. Only one such remote network connection is shown which is similar to local network connection etc.

Remote component s can also include a remote processor . Remote processor can be made in any way known in the art such as was described with reference to local processor . Remote processor may also implement an authentication function similar to local processor .

Remote component s can also include a remote memory . Remote memory can be made in any way known in the art such as was described with reference to local memory . Remote memory may include a local database and a different database of a standards organization such as one that can reference EPCs. Remote memory may also contain information associated with commands tag profiles keys or the like similar to local memory .

Of the above described elements it may be useful to consider a combination of these components designated as operational processing block . Operational processing block includes those components that are provided of the following local processor remote processor local network connection remote network connection and by extension an applicable portion of communications network that links remote network connection with local network connection . The portion can be dynamically changeable etc. In addition operational processing block can receive and decode RF waves received via antenna driver and cause antenna driver to transmit RF waves according to what it has processed.

Operational processing block includes either local processor or remote processor or both. If both are provided remote processor can be made such that it operates in a way complementary with that of local processor . In fact the two can cooperate. It will be appreciated that operational processing block as defined this way is in communication with both local memory and remote memory if both are present.

Accordingly operational processing block is location independent in that its functions can be implemented either by local processor or by remote processor or by a combination of both. Some of these functions are preferably implemented by local processor and some by remote processor . Operational processing block accesses local memory or remote memory or both for storing and or retrieving data.

RFID reader system operates by operational processing block generating communications for RFID tags. These communications are ultimately transmitted by antenna driver block with modulator encoder block encoding and modulating the information on an RF wave. Then data is received from the tags via antenna driver block demodulated and decoded by demodulator decoder block and processed by operational processing block .

Embodiments of an RFID reader system can be implemented as hardware software firmware or any combination. Such a system may be subdivided into components or modules. A person skilled in the art will recognize that some of these components or modules can be implemented as hardware some as software some as firmware and some as a combination. An example of such a subdivision is now described together with the RFID tag as an additional module.

An RFID tag is considered here as a module by itself. RFID tag conducts a wireless communication with the remainder via the air interface . Air interface is really a boundary in that signals or data that pass through it are not intended to be transformed from one thing to another. Specifications as to how readers and tags are to communicate with each other for example the Gen2 Specification also properly characterize that boundary as an interface.

RFID system includes one or more reader antennas and an RF front end module for interfacing with reader antenna s . These can be made as described above.

RFID system also includes a signal processing module . In one embodiment signal processing module exchanges waveforms with RF front end module such as I and Q waveform pairs.

RFID system also includes a physical driver module which is also known as data link module. In some embodiments physical driver module exchanges bits with signal processing module . Physical driver module can be the stage associated with the framing of data.

RFID system additionally includes a media access control module . In one embodiment media access control layer module exchanges packets of bits with physical driver module . Media access control layer module can make decisions for sharing the medium of wireless communication which in this case is the air interface.

RFID system moreover includes an application programming library module . This module can include application programming interfaces APIs other objects etc.

All of these RFID system functionalities can be supported by one or more processors. One of these processors can be considered a host processor. Such a host processor might include a host operating system OS and or central processing unit CPU as in module . In some embodiments the processor is not considered as a separate module but one that includes some of the above mentioned modules of RFID system . In some embodiments the one or more processors may perform operations associated with retrieving data that may include a tag public key an electronic signature a tag identifier an item identifier and or a signing authority public key. In some embodiments the one or more processors may authenticate an electronic signature create a tag challenge and or authenticate a tag response.

User interface module may be coupled to application programming library module for accessing the APIs. User interface module can be manual automatic or both. It can be supported by the host OS CPU module mentioned above or by a separate processor etc.

It will be observed that the modules of RFID system form a chain. Adjacent modules in the chain can be coupled by appropriate instrumentalities for exchanging signals. These instrumentalities include conductors buses interfaces and so on. These instrumentalities can be local e.g. to connect modules that are physically close to each other or over a network for remote communication.

The chain is used in one direction for receiving RFID waveforms and in the other direction for transmitting RFID waveforms. In receiving mode reader antenna s receives wireless waves which are in turn processed successively by the various modules in the chain. Processing can terminate in any one of the modules. In transmitting mode waveform initiation can be in any one of the modules. Ultimately signals are routed to reader antenna s to be transmitted as wireless waves.

The architecture of RFID system is presented for purposes of explanation and not of limitation. Its particular subdivision into modules need not be followed for creating embodiments. Furthermore the features of the present disclosure can be performed either within a single one of the modules or by a combination of them.

As mentioned previously embodiments are directed to maintaining authenticity chains of items or tags across different entities. Embodiments additionally include programs and methods of operation of the programs. A program is generally defined as a group of steps or operations leading to a desired result due to the nature of the elements in the steps and their sequence. A program may be implemented as a sequence of steps or operations for a processor but may be implemented in other processing elements such as FPGAs DSPs or other devices as described above.

Performing the steps instructions or operations of a program requires manipulating physical quantities. Usually though not necessarily these quantities may be transferred combined compared and otherwise manipulated or processed according to the steps or instructions and they may also be stored in a computer readable medium. These quantities include for example electrical magnetic and electromagnetic charges or particles states of matter and in the more general case can include the states of any physical devices or elements. It is convenient at times principally for reasons of common usage to refer to information represented by the states of these quantities as bits data bits samples values symbols characters terms numbers or the like. It should be borne in mind however that all of these and similar terms are associated with the appropriate physical quantities and that these terms are merely convenient labels applied to these physical quantities individually or in groups.

Embodiments furthermore include storage media. Such media individually or in combination with others have stored thereon instructions data keys signatures and other data of a program made according to the embodiments. A storage medium according to the embodiments is a computer readable medium such as a memory and is read by a processor of the type mentioned above. If a memory it can be implemented in any of the ways and using any of the technologies described above.

Even though it is said that the program may be stored in a computer readable medium it should be clear to a person skilled in the art that it need not be a single memory or even a single machine. Various portions modules or features of it may reside in separate memories or even separate machines. The separate machines may be connected directly or through a network such as a local access network LAN or a global network such as the Internet.

Often for the sake of convenience only it is desirable to implement and describe a program as software. The software can be unitary or thought of in terms of various interconnected distinct software modules.

Cryptographically secured data may be cryptographically secured in any number of ways. In some embodiments cryptographically secured data includes encrypted data formed by encrypting plaintext data and or hashed data using cryptographic operation . In other embodiments cryptographically secured data includes data and an electronic signature ES associated with data and used to allow a recipient to authenticate data . Data may be plaintext e.g. plaintext data hashed e.g. hashed data or encrypted e.g. encrypted data . If hashed or encrypted data may be processed to recover plaintext data as described below.

Subsequently or if cryptographically secured data includes hashed data the recipient may use a hash function to recover plaintext data from hashed data . Hash function may be the same as hash function or the reverse of hash function and the recipient may determine the appropriate hash function to use based on a communication from the sender and or a priori knowledge.

As described above cryptographically secured data may include an electronic signature ES that allows a recipient to authenticate data . Electronic signatures are cryptographic structures used to authenticate that a particular signed message originated from a particular source and has not been altered. The sender of a signed message generates an electronic signature based on a sender key and the original message and signs the message by attaching the signature. A message recipient can then cryptographically process the attached signature to determine whether it corresponds to the received message. If so the message may be presumed authentic and if not the message may be presumed counterfeit. Electronic signature if authenticated by a recipient of data provides assurance that data originated from a particular source and was not altered en route to the recipient.

Electronic signatures may be generated using symmetric and asymmetric cryptographic techniques. An electronic signature generated using symmetric cryptography may be known as a message authentication code MAC . To generate a MAC for a message a signatory also referred to as a sender uses a secret key and the message to generate the MAC. The sender may then send the message and the associated MAC to a recipient. The recipient in turn can use the same secret key to authenticate that the MAC corresponds to the message and that the sender knows the secret key. In some embodiments the sender may instead only send the MAC to the recipient and the recipient may recover the associated message from the MAC using the secret key.

An electronic signature generated using asymmetric cryptography may be known as a digital signature DS . To generate a DS for a message a signatory or sender uses the message and the private key from a private public key pair to generate the DS. The private key and public key in the key pair are mathematically related to each other and the signatory keeps the private key secret while making the public key available to others. The sender may then send both the message and the associated DS referred to as a digital signature with appendix to a recipient. The recipient can then in turn use the public key to authenticate that the DS corresponds to the message and that the sender possesses the private key. An authenticated MAC or DS gives the recipient reason to believe that the message was created by a known sender and that it was not altered in transit. In some embodiments digital signatures may be generated without using a separate hash using a digital signature scheme with message recovery. In such embodiments a DS may be generated directly from the data and only the DS sent to the recipient. During authentication the recipient directly decrypts the DS with the public key to recover the data. Of course other digital or electronic signature schemes may be used.

An important attribute of digital signatures is that they are difficult to forge or clone. A number of standards have been developed for digital signatures. The Digital Signature Standard DSS is a U.S. Government standard for digital signatures. DSS is specified in Federal Information Processing Standards FIPS and FIPS . FIPS specifies two digital signature algorithms the Digital Signature Algorithm DSA and the RSA digital signature algorithm. FIPS includes a third digital signature algorithm the Elliptic Curve Digital Signature Algorithm ECDSA . FIPS Secure Hash Standard SHS specifies the hash functions to be used in conjunction with FIPS and FIPS .

In this disclosure the term electronic signature or ES may refer to a MAC generated using symmetric cryptography or to a DS generated using asymmetric cryptography.

As described above authenticity chains allow an entity to authenticate an item or tag. depicts how an item authenticity chain may be maintained during checkout and return processes according to embodiments. In diagram a tag or item manufacturer may write a tag or item identifier ID to an RFID tag associated with an item at step . The ID identifies the tag and or the item to which the tag is attached and may be a tag identifier TID an item identifier II an electronic product code EPC a trade identification number such as a global trade item number GTIN or serialized GTIN SGTIN or any other identifier for the tag and or item. Also in step the manufacturer may generate a first brand protection code BPC based on the ID and write BPC to the tag to serve as a first link in an authenticity chain associated with the tag and or tagged item. In some embodiments BPC may be generated using one or more of the cryptographic techniques described above. For example the manufacturer may possess a manufacturer secret or private key and may use the key to generate an electronic signature based on the ID and optionally other suitable information e.g. a manufacturer identifier a timestamp a location identifier etc. to use as BPC. The manufacturer may then ship the tagged item to a retailer in step .

At step the retailer having received the tagged item shipped in step may write an owner code OC to the tag. The OC identifies an owner associated with the tag or item and allows discrimination between tags or items associated with different entities. For example the OC may identify the retailer receiving the tagged item. In some embodiments the retailer may attempt to authenticate BPC before writing the OC in order to ensure that the received tagged item is authentic. For example the retailer may have access to the manufacturer secret key used to generate BPC and may use the manufacturer secret key to authenticate BPC. As another example the retailer may know the manufacturer public key corresponding to the private key used to generate BPC and may use the manufacturer public key to authenticate BPC. In some embodiments the retailer may write the OC without authenticating BPC or may write the OC even if BPC cannot be authenticated.

In some embodiments at step the retailer may determine and write a second BPC BPC to the tag similar to BPC. For example the retailer may possess a retailer secret or private key and may use the key to generate an electronic signature based on the ID e.g. a tag identifier and or an item identifier BPC and or any other suitable information e.g. retailer identifier a timestamp a location identifier etc. . In some embodiments the retailer may instead select and retrieve an appropriate BPC from a set of stored BPCs such as a database of BPCs. The retailer may then write BPC to the tag alongside or overwriting all of or a portion of BPC. For example BPC may be shorter than BPC and the retailer may select a portion of BPC corresponding to the length of BPC and overwrite the selected BPC portion with BPC. As another example the retailer may select a portion of BPC having a particular length select a portion of BPC having the same length and overwrite the selected BPC portion with the selection BPC portion. As yet another example the retailer may overwrite non contiguous portions of BPC with portions of BPC. In some embodiments the retailer may overwrite BPC with BPC only after authenticating BPC. In this case BPC may serve as a second link in the authenticity chain of the tag item and overwriting the previous BPC BPC with BPC may reduce memory usage as compared to storing multiple BPCs.

At step the tagged item may transition to a point of sale POS such as a stationary register or a mobile checkout device. For example after step the tagged item may be placed within a retail store or facility and a customer may pick up the tagged item and decide to purchase it at the POS. At step if the tagged item is to be purchased the POS may determine whether the tagged item belongs to the retailer by reading the OC from the tag and may also authenticate the brand protection code stored on the tag BPC or BPC for example using a secret or public key associated with the tag item manufacturer or the retailer. Upon determining that the tagged item belongs to the retailer and authenticating BPC or BPC the POS may determine an exit code EC that indicates that the tagged item has been sold. In some embodiments the EC may be an electronic signature generated based on a retailer secret or private key the ID e.g. a tag identifier or an item identifier BPC BPC the OC and or any other suitable information e.g. POS identifier transaction timestamp etc. . In some embodiments the EC may additionally or instead be generated as described in U.S. Pat. No. 8 593 257 filed on Sep. 25 2010 U.S. Pat. No. 8 866 595 filed on Aug. 16 2013 U.S. Pat. No. 8 872 636 filed on Aug. 16 2013 U.S. Pat. No. 8 866 596 filed on Aug. 21 2013 U.S. Pat. No. 9 189 904 filed on Jan. 24 2014 and U.S. patent application Ser. No. 14 879 161 filed on Oct. 9 2015 each of which are hereby incorporated by reference in their entireties. For example the EC may be generated based on a ticket a value selected from a scratchlist an abridged code or any other suitable method.

After the purchase has been authorized and the EC has been determined the POS may write the EC to the tag to indicate that the item associated with the tag has been properly purchased or sold and is approved to exit the store. In some embodiments the POS may overwrite all of a portion of the already present BPC BPC with the EC similar to how the retailer may overwrite all or a portion of BPC with BPC. In this case the EC may serve as a second link if BPC is not present or a third link if BPC is present in the authenticity chain of the tag item.

After the tagged item has been purchased the customer may exit the store via an electronic article surveillance EAS gate at step . An EAS gate often positioned at an exit of a store or facility attempts to prevent or detect unauthorized exit of tags by finding tags that store the OC in other words tags that in step were indicated as being associated with the store and determining whether the tags have authentic ECs that indicate that their associated items have been properly sold and are approved to exit the store. If a tag that stores the OC does not have an authentic EC then the EAS gate determines that the tag is not authorized to exit and may initiate an alert or security procedure. Alert and security procedures may include sounding an audible or silent alarm activating a security system alerting an entity associated with the store alerting an authority e.g. security personnel police personnel military personnel a facility supervisor or any other authorized person writing an alert code to the tag sending a message to an entity or authority associated with the store directing a camera toward the exit taking a picture or a video from a camera directed toward the exit and or securing a physical barrier such as by locking a door or gate or activating an obstruction e.g. a barrier associated with the exit.

Accordingly when the customer with the tagged item attempts to exit the store the EAS gate may detect the tag storing the OC and associated with the item at step . The EAS gate may then determine whether the tag has an authentic EC that indicates that the associated item has been properly sold. In some embodiments the EAS gate may itself or be coupled to a controller that can authenticate the EC for example using a cryptographic scheme or any other suitable EC authentication method such as those described above and incorporated by reference. In other embodiments the EAS gate may query a database to determine whether the EC is authentic or rely on some other external entity for authentication of the EC. Upon authenticating the EC the EAS gate may allow the tagged item to exit. On the other hand if the EC had been incorrect or not present the EAS gate may initiate an alert or security procedure as described above.

In some embodiments the customer may be able to retrieve the ID s the EC and or any BPCs present on the tag via for example a mobile or external i.e. not associated with the retailer or store reader and use the retrieved code for some other purpose. For example the customer may retrieve the EC and or BPCs present on the tag provide the retrieved data to a website or application associated with the retailer and or manufacturer and receive a response indicating whether the tagged item is authentic. As another example the customer may retrieve the EC and or BPCs present on the tag provide the retrieved data to a website or application associated with the retailer and or manufacturer and receive additional information about the tagged item such as manufacture location manufacture date expiration date warranty information ingredients or materials care instructions certifications e.g. made with organic materials child free labor fair trade etc. other related products that the customer may be interested in and or any other suitable information.

Diagram also depicts an item return process according to embodiments. At step a customer may desire to return a tagged item such as the tagged item described in steps and accordingly may bring the tagged item to the store in step . At step the returns department of the store reads the ID OC and EC of the tag associated with the item. The returns department may first authenticate the OC to verify that the OC is associated with the store or retailer to ensure that the item was actually sold by the correct retailer. After authenticating the OC or in parallel with authenticating the OC the returns department may then authenticate the EC and correctly associated with the ID. For example the returns department may cryptographically process the EC to determine whether it is associated with the ID or the returns department may look up the EC and or ID in a store database to determine whether the two are associated. Upon authenticating that the EC is authentic and correctly associated with the ID the returns department may then overwrite the EC with a BPC. The BPC may be a new BPC generated as described above or may be one of BPC or BPC described above. In the latter situation BPC or BPC may be re generated by the returns department as described above or may be retrieved from a database. Subsequently the returned item may be re stocked in the store.

To authenticate tag and by association the item attached to tag an entity may attempt to authenticate AC . For example a retailer may authenticate AC in order to determine that a received tag or item is authentic as described above in step . An EAS gate may authenticate AC to determine whether a tagged item is authorized to leave a facility as described above in step . A returns department may authenticate AC to determine whether a returned tagged item is authentic as described above in step . In some embodiments ID and OC may be write locked or permanently write locked and thereby rendered unchangeable. According to some embodiments AC may be unlocked or permanently unlocked to facilitate erasure or overwriting for returned items as described above in step .

At optional step the recipient may determine whether BPC is authentic. If BPC is an electronic signature the recipient may have access to the secret key used to generate BPC or the public key corresponding to the private key used to generate BPC and may use the key to authenticate BPC. In some embodiments the recipient may have access to a database that stores authentic BPCs and may be able to determine whether BPC exists in the database and is associated with the correct tag item identifiers. If the recipient is unable to authenticate BPC then at step the recipient may deem the tag and or associated item counterfeit. In some embodiments the recipient may then initiate an alert or security procedure as described above.

On the other hand if at optional step the recipient determines that BPC is authentic or if optional step is omitted at step the recipient may write an owner code OC to the tag. The OC indicates that the recipient owns the tag and the tagged item as described above. At optional step if BPC was previously authenticated in optional step the recipient may overwrite at least a portion of BPC with a second brand protection code BPC. BPC similar to BPC in step of may be generated by the recipient based on a recipient key an identifier associated with the tag and or any other suitable information and may serve as a second link in an authenticity chain of the tag and or tagged item with BPC serving as the first link.

At step a point of sale POS may read one or more identifiers the OC and BPC or BPC from the tag. For example a customer may wish to purchase the tagged item and may use a POS device and or bring the tagged item to a POS for checkout. The POS along with determining whether the tagged item should be sold e.g. by authenticating the OC to ensure that the tagged item belongs to the correct facility and verifying payment information if necessary may determine whether the BPC on the tag BPC or BPC is authentic at step . The POS may assess the authenticity of BPC BPC using the same techniques described above in relation to step i.e. attempting to cryptographically authenticate the BPC and or looking up the BPC in a database . If the POS is unable to authenticate the BPC then it may deem the tag or tagged item counterfeit at step and may interrupt the checkout process and or initiate an alert or security procedure such as those described above in relation to step in .

On the other hand if the POS authenticates the tag then at step the POS may authorize the tag and tagged item to exit assuming that any necessary payment information has also been verified by overwriting at least a portion of the BPC on the tag with an exit code EC that indicates that the tagged item has been sold. In some embodiments the EC may be generated based on a tag or item identifier BPC BPC and or any other suitable data using a key associated with the recipient or the POS as described above in step of . The EC may serve as a second if BPC was not present or third if BPC was present link in the authenticity chain of the tag and or tagged item.

On the other hand if at step the recipient is able to authenticate the EC then at step the recipient may determine a brand protection code BPC based on the identifier s read from the tag as described above in step of . In some embodiments the recipient may itself generate the BPC from the identifiers and optionally other suitable data using a particular key. In other embodiments the recipient may request an appropriate BPC from another entity or may look up an appropriate BPC from a database. At step the recipient may then overwrite at least a portion of the EC with the determined BPC as described above.

The operations described in processes and are for illustrative purposes only. These operations may be implemented using additional or fewer operations and in different orders using the principles described herein.

In the above description a tag item authenticity chain is described as including one or more BPCs each generated upon the authentication of a previous BPC and optionally at least partially overwriting the previous BPC. In some embodiments an OC may be used as a link in an authenticity chain. For example step of describes a retailer writing the OC to the tag in response to authenticating BPC. In addition an OC such as OC in may be permanently write locked and thereby rendered unchangeable. In this situation the presence of the OC may attest to the authenticity of the tag or item. Subsequent links of the authenticity chain e.g. other BPCs may be stored in other memory locations e.g. the location of BPC in or AC in because the OC may be permanently write locked and unchangeable.

While the above description is provided in the context of a retailer or retail facility tag item authenticity chains as described herein may be used for any suitable application. For example authenticity chains as described herein may be applied to healthcare law enforcement military food supply and safety scientific and laboratory manufacturing construction or any other suitable application.

Brand protection exit and other authentication codes are described in some contexts above as being generated determined and authenticated based on a cryptographic key such as a secret key or a private key. In some embodiments such authentication codes may also or instead be based on one or more secrets. A secret may be a cryptographic key or may be some other data value known to one or more entities and used to generate authentication codes without using a cryptographic algorithm. For example a secret may be a randomly generated value or predetermined value for example a cover code used to mask one or more other data values to generate or determine an authentication code. Such masking may involve the use of one or more non cryptographic algorithms or techniques such as bitwise operations e.g. bitwise exclusive OR addition or similar arithmetic operations e.g. arithmetic addition multiplication etc. bit shifting operations or similar. Another entity may then be able to authenticate such an authentication code by using knowledge of the secret and the technique used to generate the authentication code.

The foregoing detailed description has set forth various embodiments of the devices and or processes via the use of block diagrams and or examples. Insofar as such block diagrams and or examples contain one or more functions and or aspects it will be understood by those within the art that each function and or aspect within such block diagrams or examples may be implemented individually and or collectively by a wide range of hardware software firmware or virtually any combination thereof. Those skilled in the art will recognize that some aspects of the RFID embodiments disclosed herein in whole or in part may be equivalently implemented employing integrated circuits as one or more computer programs running on one or more computers e.g. as one or more programs running on one or more computer systems as one or more programs running on one or more processors e.g. as one or more programs running on one or more microprocessors as firmware or as virtually any combination thereof and that designing the circuitry and or writing the code for the software and or firmware would be well within the skill of one of skill in the art in light of this disclosure.

The present disclosure is not to be limited in terms of the particular embodiments described in this application which are intended as illustrations of various aspects. Many modifications and variations can be made without departing from its spirit and scope as will be apparent to those skilled in the art. Functionally equivalent methods and apparatuses within the scope of the disclosure in addition to those enumerated herein will be apparent to those skilled in the art from the foregoing descriptions. Such modifications and variations are intended to fall within the scope of the appended claims. The present disclosure is to be limited only by the terms of the appended claims along with the full scope of equivalents to which such claims are entitled. It is to be understood that this disclosure is not limited to particular methods configurations antennas transmission lines and the like which can of course vary. It is also to be understood that the terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting.

With respect to the use of substantially any plural and or singular terms herein those having skill in the art can translate from the plural to the singular and or from the singular to the plural as is appropriate to the context and or application. The various singular plural permutations may be expressly set forth herein for sake of clarity.

It will be understood by those within the art that in general terms used herein and especially in the appended claims e.g. bodies of the appended claims are generally intended as open terms e.g. the term including should be interpreted as including but not limited to the term having should be interpreted as having at least the term includes should be interpreted as includes but is not limited to etc. . It will be further understood by those within the art that if a specific number of an introduced claim recitation is intended such an intent will be explicitly recited in the claim and in the absence of such recitation no such intent is present. For example as an aid to understanding the following appended claims may contain usage of the introductory phrases at least one and one or more to introduce claim recitations. However the use of such phrases should not be construed to imply that the introduction of a claim recitation by the indefinite articles a or an limits any particular claim containing such introduced claim recitation to embodiments containing only one such recitation even when the same claim includes the introductory phrases one or more or at least one and indefinite articles such as a or an e.g. a and or an should be interpreted to mean at least one or one or more the same holds true for the use of definite articles used to introduce claim recitations. In addition even if a specific number of an introduced claim recitation is explicitly recited those skilled in the art will recognize that such recitation should be interpreted to mean at least the recited number e.g. the bare recitation of two recitations without other modifiers means at least two recitations or two or more recitations .

Furthermore in those instances where a convention analogous to at least one of A B and C etc. is used in general such a construction is intended in the sense one having skill in the art would understand the convention e.g. a system having at least one of A B and C would include but not be limited to systems that have A alone B alone C alone A and B together A and C together B and C together and or A B and C together etc. . It will be further understood by those within the art that virtually any disjunctive word and or phrase presenting two or more alternative terms whether in the description claims or drawings should be understood to contemplate the possibilities of including one of the terms either of the terms or both terms. For example the phrase A or B will be understood to include the possibilities of A or B or A and B. 

As will be understood by one skilled in the art for any and all purposes such as in terms of providing a written description all ranges disclosed herein also encompass any and all possible subranges and combinations of subranges thereof. Any listed range can be easily recognized as sufficiently describing and enabling the same range being broken down into at least equal halves thirds quarters fifths tenths etc. As a non limiting example each range discussed herein can be readily broken down into a lower third middle third and upper third etc. As will also be understood by one skilled in the art all language such as up to at least greater than less than and the like include the number recited and refer to ranges which can be subsequently broken down into subranges as discussed above. Finally as will be understood by one skilled in the art a range includes each individual member. Thus for example a group having 1 3 cells refers to groups having 1 2 or 3 cells. Similarly a group having 1 5 cells refers to groups having 1 2 3 4 or 5 cells and so forth.

