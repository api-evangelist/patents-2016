---

title: Method and apparatus for digital predistortion of ultra wideband radio frequency upconverters
abstract: Method, apparatus, and article of manufacture for performing digital pre-distortion of wideband analog upconversion chains existing within communications systems. By pre-distorting for the deterministic non-linearities in an analog upconverter, a radiated passband signal will show an improved signal quality which will enhance the ability of a receiver to properly decode received data symbols, as well as perform equalization of the received signal constellation. It is desired that this pre-distortion technique will further improve the signal quality of communication systems who only implement pre-distortion techniques for compression effects due to power amplifiers.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09595983&OS=09595983&RS=09595983
owner: The United States of America as represented by the Secretary of the Air Force
number: 09595983
owner_city: Washington
owner_country: US
publication_date: 20160307
---
The invention described herein may be manufactured and used by or for the Government for governmental purposes without the payment of any royalty thereon.

This invention relates generally to high bandwidth radio frequency transmitters and more specifically to ultra wideband radio frequency upconverters wherein analog component nonlinearities may be pre compensated to improve received signal quality.

As data rate requirements necessary to support the wireless transmission of high quality intelligence surveillance and reconnaissance ISR information increase so do the need for high bandwidth communications systems to support the downlink of this ISR information. One method proposed to enable these high data rates is to increase wireless signal bandwidths to multi gigahertz GHz . Such a signal bandwidth can theoretically support much higher data rates than traditional kilohertz kHz to megahertz MHz wide signals while maintaining realistic modulation schemes that require only moderate signal to noise ratios SNR .

However existing commercial off the shelf COTS microwave frequency components are not designed with the intention of supporting multiple GHz of instantaneous signal bandwidth. Even though these components may support the operation of signals with wide bandwidths their magnitude and phase response across this band is non linear. While a narrow band signal may approach linear operation through an analog component the wideband nature of a multi GHz waveform means that some signal components may experience frequency selective fading that differs significantly from other frequency components across the same instantaneous signal bandwidth. This results in distortion of the waveform and provides a challenge for data recovery techniques at the receiver.

Existing receiver signal equalization techniques may provide some amount of benefit compensate for these non linearities but are limited in their capabilities. First since a receiver does not have information about the ideal transmitted data symbols the receiver equalizer must blindly attempt to recover the ideal symbols of a signal constellation then iteratively minimize the identified error. If the received signal is too degraded to determine these ideal symbols the receiver equalizer will be unable to improve the signal and the received symbols will not be properly decoded. Secondly as the amount of signal distortion increases due to the effects of non linear responses in the transmitter and receiver analog hardware in addition to distortion due to the power amplifier PA and wireless channel effects the burden on the receiver equalizer may become more than it can reasonably compensate for. These facts drive the need for a type of transmitter equalization to improve the response of the signal due to analog component non linearities.

Pre distortion of a transmitted radio frequency waveform is necessary when compression of a waveform within a high power amplifier PA causes non linear distortions in the passband signal. Because some amount of this distortion is dependent on the input signal power temperature stability and PA specifications given enough information a portion of the distortion can be deterministically modeled. Digital pre distortion is the practice of purposefully distorting the otherwise ideal digital data before analog transmission to compensate for the deterministic compression caused by the PA.

An optimal solution to the degradation of signal quality of ultra wideband signals through non linear analog components should be one which is low cost straightforward to implement and does not require significant changes to existing communication systems. The prior art has been able to isolate some of these parameters independently but has failed to optimize for all parameters at once.

In U.S. Pat. No. 3 755 754 a pre distortion technique is described for the compensation of perceived distortion occurring in a signal due to PA non linearities. In this case the original signal is separated into two signals where one is distorted through the PA and the other amplified linearly. The signals are then combined with a phase inversion causing a cancellation of some distortion components. However this technique targets distortion caused only by the PA while requiring additional analog hardware otherwise unnecessary in the original transmitter.

In U.S. Pat. No. 6 288 610 a method and apparatus for signal pre distortion is identified which implements a means to detect and compensate for distortion caused by a PA. This technique uses digital pre distortion techniques which minimizes the footprint necessary for overall pre distortion. However the method requires a second upconverter PA and power combiner to realize the distortion compensation significantly impacting the size and cost of the overall technique.

In United States Patent Application Publication 20050088230 an amplifier pre distortion processing technique is described which uses look up tables to implement a pre distortion filter on both the in phase and quadrature phase components of a quadrature amplitude modulated waveform. Using look up tables results in a pre distortion technique that is less costly to implement and requires a smaller digital footprint than other approaches in the prior art. However this implementation is used for pre distortion of a transmitter power amplifier not the non linearities of analog components which result in signal degradation of wideband waveforms.

In United States Patent Application Publication 20070153884 a method for calculating the pre distortion filter coefficients for a closed loop feedback system is provided. This method updates the pre distortion coefficients as the characteristics of a PA change over time. While this method is effective for real time updating it requires significantly more analog and digital hardware to support the additional downconversion and decoding of the PA affected signal before transmission.

In U.S. Pat. No. 8 351 877 a digital pre distortion system and method enables the pre distortion of a wideband waveform for the distortion effects of a PA. While this invention does address the wideband applications of pre distortion the technique is only applied to compensate for PA effects which results in an incomplete solution to distortion problems.

It is therefore an object of the present invention to provide an apparatus that extends the prior art s use of pre distortion techniques from not only the non linear effects of PA compression but also to the wideband non linear effects exhibited by analog upconversion components.

It is a further object of the present invention to sufficiently model the steady state magnitude response of the analog upconversion chain of a transmitter to determine the non linear effects introduced on the transmission data through the sounding of the analog components.

It is still a further object of the present invention to develop a finite impulse response filter whose magnitude response is the inversion of the steady state magnitude response of the analog upconversion chain derived using existing mean error minimization techniques.

It is yet still a further object of the present invention to inject the finite impulse response filter coefficients for each in phase and quadrature phase components of a quadrature amplitude modulated waveform prior to the digital to analog converter of the transmitter thereby pre distorting the otherwise ideal data symbols for the known effects of the analog upconversion chain.

It is yet another object of the present invention to provide the aforementioned features as a digital data transmission system apparatus a method to be applied to a digital data transmission system or as computer instructions for a computing device acting in cooperation with a digital data transmission system so as to provide the requisite predistortion of digital data transmissions.

Briefly stated the present invention achieves these and other objects through the use of a finite impulse response pre distortion filter.

First a known data sequence is generated of sufficient length to fully characterize an analog upconverter. The sequence should also be of sufficient length to minimize the mean signal error detected on the output of the upconversion chain to some steady state response. Additionally the data sequence should use the highest order modulation that will be used through the analog components. Finally the known sequence should include a unique word to be used for synchronization.

Next the generated sequence is injected into the communications chain of a transmitter immediately before the digital to analog converter DAC . This should be the final stage within the digital modulator before the signal is converted into the analog domain.

Following that the digital and analog components of the transmitter should be turned on and allowed to sufficiently warm such that the local oscillator frequencies and analog components sustain steady state responses.

After that the known random data sequence should be transmitted through the digital transmitter the DAC and the analog upconversion chain. The signal should then be captured at the output of the upconversion chain before the power amplifier with a sampling receiver whose analog to digital converter ADC sampling clock is phase matched to the transmitter DAC clock. The received sampled data and the original ideal data should then be aligned in time using the known unique word such that each ideal data symbol can also be represented by a corresponding upconverter effected symbol.

Following that a negative feedback loop should be implemented in conjunction with a minimization technique such least mean square or recursive least squares to determine the set of weighted coefficients that minimizes the mean error between the ideal data symbols and the corresponding upconverter effected symbols. The resultant coefficients represent the inversion of the magnitude response of the analog upconversion chain.

The generated set of coefficients should be injected as a finite impulse response filter directly before the DAC such that the otherwise ideal transmitted data symbols are pre distorted to pre compensate for the non linearities within the analog upconversion chain.

Therefore it is accurate to say that while the present invention 1. utilizes pre distortion techniques to compensate for signal distortion 2. and while the present invention can pre distort for perceived distortion via a set of digital filter coefficients as prior art requires to achieve the same the present invention provides a solution lacking in the prior art because it 3. can pre distort for the steady state distortion introduced by analog components acting on a wideband waveform. As such the present invention represents a significant departure from prior art methods.

According to an embodiment of the invention apparatus for performing pre distortion for analog upconversion comprises a known ideal random data sequence to sound an analog upconverter a means to sample and thereby capture the distorted waveform at the output of the analog upconverter a digital processor to compare the known ideal data with the upconverter effected data a negative feedback loop with a minimization technique to develop a set of pre distortion coefficients and a digital finite impulse response filter that the coefficients can be injected into thereby pre distorting the otherwise ideal data symbols.

The above and other objects features and advantages of the present invention will become apparent from the following description read in conjunction with the accompanying drawings in which like reference numerals designate the same elements.

Referring to the key components of the digital pre distortion scheme are the digital data source the digital transmitter and the analog upconverter . The digital data source consists of a known serial stream of symbols. Once the pre distortion filter coefficients are determined digital data source becomes the intended data to be transmitted.

Still referring to the data source enters the digital modulator within the digital transmitter where typical digital processing occurs including but not limited to forward error correction and pulse shaping. The output of is a baseband symbol consisting of an in phase component and quadrature phase component . These components pass through their respective pre distortion digital filter and . The coefficients of pre distortion digital filters and are determined according to the process depicted in . The distorted in phase component and distorted quadrature phase component feed into the digital to analog converter . This generates an analog output signal of the digital input values. The outputs of digital to analog converter are the in phase analog signal and quadrature phase analog signal .

Still referring to the analog signals and are fed into the analog upconverter block where the baseband signals are upconverted to the desired frequency for transmission.

Referring to the output of the Digital Transmitter are the analog in phase signal and analog quadrature phase signal . Both pass through their respective low pass filter and with cut off frequency of the pulse shaped bandwidth yielding signals and . A local oscillator generates a sinusoid at the carrier frequency to drive mixers and . The sinusoid signal passes through a 90 degree phase shifter to generate sinusoid that is 90 degrees delayed from 306. The in phase and quadrature signals are combined by to produce a radio frequency signal . This signal may pass through a driver amplifier to increase the signal strength loss during the combining stage resulting in . This signal is typically fed into a power amplifier or directly into an antenna.

Still referring to the combined signal is also fed into block for capture and downconversion of the data affected by the analog upconversion chain. This block calculates the filter coefficients utilized within filters and .

Referring to the effected data symbols are derived from the analog signal from . It is assumed that the capture analog downconversion and analog to digital sampling are performed without incurring further distortion of the data symbols. The effected data is passed into the filter coefficient block where it is filtered by a digital finite impulse response filter whose coefficients vary. The output of this filter is subtracted from the ideal data symbols generated at the beginning of this process at block . The difference signal is fed into the error minimization algorithm block along with the effected data . This block performs a least mean square minimization generating updated in phase and quadrature phase coefficients . Once the minimization has converged these coefficients are assigned to digital filters and .

It is important to note that there are many ways to implement the present invention. For example the invention may be implemented in electronic hardware comprising analog digital and computer circuitry. Certain aspects of the invention may be implemented in computer software either as software instructions fixed in a non transitory tangible storage media or as firmware fixed in electronic circuitry.

Having described preferred embodiments of the invention with reference to the accompanying drawings it is to be understood that the invention is not limited to those precise embodiments and that various changes and modifications may be effected therein by one skilled in the art without departing from the scope or spirit of the invention as defined in the appended claims.

