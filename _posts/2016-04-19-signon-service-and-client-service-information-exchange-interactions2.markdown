---

title: Sign-on service and client service information exchange interactions
abstract: Techniques are described for providing customizable sign-on functionality, such as via an access manager system that provides single sign-on functionality and other functionality to other services for use with those services' users. The access manager system may maintain various sign-on and other account information for various users, and provide single sign-on functionality for those users using that maintained information on behalf of multiple unrelated services with which those users interact. The access manager may allow a variety of types of customizations to single sign-on functionality and/or other functionality available from the access manager, such as on a per-service basis via configuration by an operator of the service, such as co-branding customizations, customizations of information to be gathered from users, customizations of authority that may be delegated to other services to act on behalf of users, etc., and with the customizations that are available being determined specifically for that service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09537853&OS=09537853&RS=09537853
owner: Amazon Technologies, Inc.
number: 09537853
owner_city: Reno
owner_country: US
publication_date: 20160419
---
This application is a continuation of co pending U.S. patent application Ser. No. 14 101 161 filed Dec. 9 2013 and entitled Customizable Sign On Service which is hereby incorporated by reference in its entirety. U.S. application Ser. No. 14 101 161 is a continuation of U.S. patent application Ser. No. 13 350 508 filed Jan. 13 2012 and entitled Customizable Sign On Service now U.S. Pat. No. 8 627 435 which is hereby incorporated by reference in its entirety. U.S. patent application Ser. No. 13 350 508 is a continuation of U.S. patent application Ser. No. 12 825 262 filed Jun. 28 2010 and entitled Customizable Sign On Service now U.S. Pat. No. 8 108 922. U.S. patent application Ser. No. 12 825 262 is a divisional application of U.S. patent application Ser. No. 11 396 285 filed Mar. 31 2006 and entitled Customizable Sign On Service now U.S. Pat. No. 7 912 762. U.S. patent application Ser No. 11 396 285 is also related to U.S. patent application Ser. No. 11 396 298 filed Mar. 31 2006 and entitled Enhanced Security For Messaging now U.S. Pat. No. 8 312 523 which is hereby incorporated by reference in its entirety.

The following disclosure relates generally to techniques for providing customizable user sign on functionality such as via a single sign on service that provides customizable sign on processes to users of other services that are customers of the single sign on service.

Use of computers in daily life has become ubiquitous such as to enable users to access and use a variety of types of remote services over the Internet e.g. via Web sites or via other access mechanisms e.g. cellphone networks . For example some such services may provide various types of information e.g. current news or reference material while others may provide a variety of types of activities and capabilities e.g. online banking online shopping email or other messaging services etc. . While some services may provide information and capabilities to anyone many others are restricted to authorized users such as to protect the privacy of user information by making it available only to authorized users e.g. to require a user to login to a email service before making the user s email available to manage user data used for the activities being performed e.g. for an online merchant to store financial and shipping information for a user to facilitate the user s shopping such as part of an account maintained for the user and to ensure that users have provided appropriate payment or satisfied other conditions for use of the service.

In order to be able to sign on or logon or login to a service to demonstrate authorization to access restricted information or functionality users must typically first register with the service and obtain appropriate sign on information e.g. a username and password unique to that service. However as such services proliferate that each have unique sign on information users are inconveniently forced to remember numerous distinct sets of sign on information for different Internet sites. In addition many operators of Internet sites and other providers of such services would prefer to be relieved of the burden of providing functionality to enable such sign on of user and to maintain user sign on and other authentication data.

In an attempt to address these situations single sign on systems have been created in which a user creates a single set of sign on information that enables access to a group of multiple affiliated services or systems. Unfortunately current single sign on systems have a variety of problems. For example many operators of services are reluctant to use sign on functionality provided by another operator. This reluctance may be due to a lack of consistency in the users experience when interacting with the sign on system e.g. due to a lack of consistent branding or other consistent appearance and functionality because available sign on systems may not provide functionality that is desired etc. In addition service operators and users may have concerns regarding security such as fears that imposters may be able to impersonate a user or service operator in interactions with the single sign on system and thus improperly obtain access to restricted information or functionality.

Thus it would be beneficial to provide techniques to improve single sign on services and to provide other benefits.

Techniques are described for providing customizable functionality for interacting with users such as via an access manager system that provides single sign on functionality and other functionality to other services. In some embodiments an operator of a Web site or other service available to users may interact with the access manager system to customize and otherwise configure single sign on functionality and or other functionality that the access manager system will make available to users of the service. The access manager system may provide such functionality to other services in various ways in various embodiments such as by enabling initial configuration to be performed by an operator of a service in an interactive manner and by enabling customized functionality to be provided to users of the service in a programmatic manner via an API application programming interface of the access manager system. In at least some such embodiments the access manager system maintains various sign on and other account information for various users and provides single sign on functionality for those users using that maintained information on behalf of multiple unrelated services with which those users interact. In addition in at least some embodiments the services on whose behalf the access manager system provides the customized functionality are each customers of the access manager system such as for customer services that have previously registered with the access manager system in order to configure the customized functionality to be provided e.g. in exchange for a fee .

In some embodiments the access manager may allow a variety of types of customizations to single sign on functionality and or other functionality available from the access manager. An operator of a customer service may configure the various types of customizations so that user interaction with the access manager on behalf of the customer service is customized for the particular customer service. For example in at least some embodiments such types of customizations may include various types of co branding for the service to be used by the access manager when interacting with users of the service such as to include various information configured for the service with each of one or more groups of information to be presented to users e.g. one or more Web pages to be displayed to users such as one or more indicated images e.g. logos indicated text indicated user selectable links other indicated user selectable controls e.g. a displayed menu bar such as available from an indicated URL Uniform Resource Locator or from executing indicated code capabilities provided from executing indicated code etc. In addition in at least some embodiments customizations to functionality available from the access manager include various types of information gathering from users of the service during interactions with the access manager such as to collect information from the users based on one or more predefined questions selected by an operator of the service and or one or more questions specified by the service operator e.g. demographic information about the user preference information information specific to the user for use by the service in performing its operations etc. . Co branding and information gathering customizations are discussed in greater detail below.

In some embodiments after a user interacts with the access manager to complete a customized sign on process for a service the access manager provides a credential to the service for the user such as to indicate that the user is an authorized user for the service and or to represent the user so that the service may make subsequent requests to perform actions on behalf of the user e.g. to make payments for the user to modify stored account information for the user etc. . The credentials may take a variety of forms in various embodiments such as to include information specific to the user e.g. a unique username or other identifier for the user an actual name or other identifying information for the user information gathered from the user during the customized sign on process etc. whether in an encrypted or unencrypted form or to instead merely be information that the access manager can later map to the user if returned e.g. a unique number for the access manager or relative to a service . In addition in at least some embodiments a credential provided to a service on behalf of a user is treated by the access manager as being specific to the service such that a later request to use the credential on behalf of the user will be treated as valid only if provided by or on behalf of the service. Credentials may also have a variety of other types of characteristics in at least some embodiments. For example a particular credential may be valid for only a limited period of time and or for only certain types of activities or operations on behalf of a user. If so the access manager may restrict use of the credentials based on such characteristics. Additional details related to credentials are discussed below.

In some embodiments additional types of customizations are allowed by the access manager for at least some services related to types of activities that the services are allowed to take. For example the types of actions that some services are allowed to take for their signed on users may be limited in various ways such as to reflect a degree of trust granted to the service by the access manager as one example credentials may in some embodiments be valid for only limited periods of time and if so some services may be authorized to refresh their users credentials to extend their period of validity in at least some circumstances e.g. for up to a specified number of times for up to a specified total period of validity in an unlimited and unrestricted manner etc. . In addition in at least some embodiments customizations allowed by the access manager for at least some services include one or more types of delegation of authority that a primary service may be able to provide to another secondary service to take actions on behalf of a user such as to reflect a degree of trust granted by the access manager to the primary service and or to the secondary service. For example at least some primary services to which credentials are provided may be authorized to delegate authority to other services to use such credentials in various ways including to use the credentials to take at least some types of actions on behalf of the represented users to perform refreshing of credentials with limited periods of validity in at least some circumstances to request issuance of a new credential for the user that is specific to the secondary service e.g. when credentials are only effective for the service to which they are originally issued etc. Additional details related to types of delegation of authority are included below.

The types of customizations that will be made available to a service by the access manager may be determined in various ways in various embodiments such as in an automatic manner based on information available about the service and or the operator of the service. For example some types of customizations may provide greater security and liability risks if a malicious service or a malicious party that attempts to impersonate or otherwise act on behalf of a benign service is allowed to perform them. With respect to co branding types of customizations allowing a service to add text and or an image to be displayed to users carries relatively little risk assuming that the context of the text is not offensive or illegal . Conversely allowing a service to specify executable code that the access manager will use when generating information to be provided to a user or that will be included with the information provided to a user e.g. a Java applet included as part of a Web page sent to the user may carry relatively high risk e.g. to allow the service specified code to inappropriately obtain information about the user such as by monitoring sign on information provided by the user to the access manager that would not otherwise be available to the service . Additional details related to determining types of customizations to make available to a service are included below.

In addition in some embodiments various techniques are used to inhibit malicious parties from performing unauthorized activities such as to prevent phishing attempts in which malicious parties attempt to impersonate actual authorized parties. For example in order to inhibit malicious users from attempting to interact with the access manager while impersonating services authorized to perform such interactions additional security techniques may be used to authenticate some or all messages sent from at least some of the services. In particular in some embodiments each service that is authorized to interact with the access manager is given at least one unique secret access key known to the service and to the access manager and the secret access key of a service is then used by the service when sending a message or other communication to the access manager so that the access manager can verify that the sender of the message is actually the service. For example each such message from a service may include an indication of a unique identifier for the service and may also include a digital signature that is generated using the secret access key based on at least a portion of the message contents. When the access manager receives such a message the access manager can use the service identifier to identify the service and to retrieve the secret access key for that service and can then generate its own digital signature in the same manner using the retrieved secret access key and the same portion of the message contents. If the digital signature generated by the access manager matches the digital signature included in the message by the sender the access manager can verify that the sender has access to both the unique identifier and the secret access key for the service and thus it is highly likely that the sender is actually the service. A secret access key may take a variety of forms in various embodiments such as a shared secret a PKI Public Key Infrastructure key pair an X.509 certificate a secret generated using hard tokens etc. Other security techniques may further be used in at least some embodiments and additional details regarding the use of secret access keys are included below.

For illustrative purposes some embodiments are described below in which specific types of services configure specific types of customizations of specific types of functionality provided by an access manager system to specific types of users of the services in specific manners. However it will be appreciated the described techniques can be used in a wide variety of other situations and that the invention is not limited to the exemplary details provided.

An example user then interacts with the application such as by requesting an operation in which the user will sign on to use one or more Web services provided by a remote third party Web service provider e.g. a Web service provider with which the user has an established account . Web services may allow heterogeneous applications and computers to interact and can be defined and implemented using a variety of underlying protocols and techniques. For example some Web service implementations return data in XML eXtensible Markup Language format using HTTP HyperText Transport Protocol in response to a Web service invocation request specified as a URI such as a URL that includes a specified operation and one or more query parameters. In other implementations additional underlying protocols are used for various purposes such as SOAP Simple Object Access Protocol for standard message exchange WSDL Web Services Description Language for description of service invocations and UDDI Universal Description Discovery and Integration service for discovery of available services. In some situations the application and Web service provider may have a predefined relationship while in other embodiments the application may merely interact with a defined API for the provided Web service on behalf of the application s end users without such a predefined relationship such as if the Web service provider is also a customer of the Access Manager system and is configured to accept and use credentials of the Access Manager system to represent users.

After the user request for the operation that triggers the sign on a sign on request message is generated by the application e.g. with a digital signature generated using the application s secret key to verify that the requester is the application and sent to user interaction manager process . If the message is verified the access manager may optionally return sign on information to be used by the application in gathering sign on information from the user e.g. indications of questions to ask the user to gather information or one or more pages or screens to be displayed to the user if the application is so designed and the application may perform the sign on process with the user to gather the various sign on information which in this example reflects an account that the user has previously established with the access manager system . The gathered information may then be sent to the access manager user interaction manager . In other embodiments the application may instead gather sign on information from the user without any initial interaction with the access manager system and send the sign on information for the user along with the initial request e.g. depending on the level of permissions granted the application although such a situation may expose the end user s sign on information to the application. When the access manager user interaction manager receives the sign on information it sends the sign on information to an account manager system which uses information in a user accounts database DB to verify the sign on information. An indication of user authentication is then sent back to the access manager user interaction manager such as a user ID or an error message. If the sign on information was valid a request is sent to the credential manager e.g. with the user ID and the credential manager generates a credential representing the user for use by the application and returns the credential to the access manager user interaction manager. After the access manager user interaction manager receives the credential it sends the credential back to the application.

The application then generates a Web service request and sends it to the Web service provider with the request optionally including a digital signature that is generated using the application s secret access key. When the Web service provider receives the request it optionally verifies the identity of the requestor using the digital signature if attached such as by sending a request to the Access Manager to request the verification not shown . In addition the Web service provider verifies the user credential in this example by sending the credential to the credential manager which generates the appropriate response e.g. to validate the credential and sends it to the Web service provider. When the credential is validated the Web service provider provides the requested Web service for the user and sends a response to the application. The application can then provide corresponding information and or functionality to the user based on the response. In some embodiments the application can further make various additional types of Web service and other requests such as to interact directly with the account manager system to make changes to the user account or to retrieve data from the user account database . After all the requests are done the user may sign out via the application or just allow the credential to expire after a limited period of time during which it is valid.

In a manner similar to that of illustrates an alternative example second group of information that may be displayed to a prospective customer service representative in order to specify one or more types of co branding customizations. In this example additional types of co branding customizations are available to the customer to reflect a relatively high level of permissions granted to the customer e.g. based on information provided with respect to and or other information available about the service or service operator . In other embodiments additional types of co branding customizations may be made available for other reasons e.g. for premium customers such as in exchange for additional fees . In this example the displayed information includes indications of the information from and further includes additional co branding customizations . The additional types of co branding customizations in this example include the ability. to further specify the appearance of information to be displayed to users to specify user selectable controls and or other information to be included in a header of the page or other information displayed to users and to specify other executable code to be included as part of the page or other information displayed or provided to users. These additional co branding customizations types are merely illustrative however and other additional types of customizations may be available in alternative embodiments.

Although in this example an operator of or other representative of a customer service individually specifies various customizations in response to corresponding prompts in other embodiments other techniques may be used to specify co branding customizations. For example a WYSWYG What You See is What You Get system may be employed in some embodiments in which the customer graphically specifies an appearance of a customized sign on page or other information to be displayed or otherwise presented to users or instead co branding customizations may instead be specified in a file using an appropriate format e.g. XML or X HTML eXtensible HyperText Markup Language fragments and sent to the access manager.

In some embodiments a secondary service affiliated with the primary customer service may itself need to be registered with the access manager in order to interact with the access manager on behalf of a user and thus the popular services may be based on the services already registered with the access manager. Alternatively if a specified service is not already registered with the access manager the access manager may automatically query the specified service to offer the ability to register. When the customer service is interacting with a user the delegation of authority to another service may occur in various ways such as when initiated by the user e.g. based on the user selecting a link or control displayed by the primary customer service that corresponds to capabilities provided via a secondary service such as a link to make a payment from an account of the user that will be delegated to a payment service and or if performed automatically by the primary customer service. In addition the interactions with the secondary service may in some embodiments be performed in a manner transparent to the user. For example if payment related capabilities are desired a secondary affiliated payment service may generate and send a page or other group of information to the user such as to obtain corresponding information from the user e.g. an indication of one or more other parties a verification of the user s sign on or other information for at least some types of actions etc. . In addition in order to provide a consistent experience to the user the secondary affiliated service may in at least some embodiments use previously specified co branding information for the primary customer service in the information displayed to the user. To obtain access to such previously specified co branding the secondary affiliated service may interact with the access manager to obtain the co branding information if authority to use that co branding information has been delegated to the secondary affiliated service. For example the primary customer service may delegate authority to the secondary affiliated service to be able to use specified types of co branding information for the primary customer service e.g. one or more logos or other images of the primary customer service in a specified manner and if so the secondary service may gain use of such co branding information by sending an appropriate request to the access manager e.g. a request that indicates the secondary service the primary customer service a type of information desired and optionally specific co brand ing information of the primary customer service . If the access manager determines that the secondary service is authorized to use that co branding information it will send back the co branding information or information that can be used by the secondary service to obtain the co branding information .

The sign on and information gathering may be done in various manners in different embodiments. For example although show Web pages in some embodiments other interfaces may be utilized including programmatically accessed interfaces. In addition multiple pages may be used to gather information about a user especially for the initial sign on of a user to a customer and various user interface widgets may be used in the user interface.

Although not illustrated here the customized sign on process and other types of customized user interactions may also be used in a variety of other situations and manners. For example while the customizing techniques were illustrated in as being used as part of one or more Web pages various other types of messages and information may instead be similarly customized such as one or more email messages e.g. email messages specified in HTML format or other types of electronic messages sent to end users. In addition the techniques may be used to co brand various other types of information provided to a user such as search engine results or information provided by a social networking service.

Embodiments of the Access Manager system and the Account Manager system are executing in the memory and they interact with other computing systems over the network e.g. via the Internet and or the World Wide Web . Users may first interact with the Account Manager system in order to establish and use accounts e.g. by each using a browser executing in memory of a user computing system such as to specify sign on information contact information financial information etc. that is stored in a user account database data structure on storage in some embodiments the Account Manager system and or one or more other affiliated systems not shown may further provide a variety of types of functionality to users such as online shopping functionality messaging services functionality information access functionality etc. The illustrated embodiment of the Access Manager system includes several manager components to provide various functionality including a Customer Registration Manager component a User Interaction Manager component a Credential Manager component a Customer Status Manager component and a Customer Verification Manager component although in other embodiments the functionality of the manager components may instead be organized in other manners. The Customer Registration Manager component interacts with operators and other representatives of services to register those services as customers of the Access Manager system and to customize sign on and other functionality to be provided to users of the services with the customer provided information being stored in a customer information database data structure on storage. After a prospective customer service has registered as a customer one or more users may interact with services and other functionality provided by customer service computing systems and be directed to the Access Manager system to perform a sign on to the customer service. The User Interaction Manager component will then interact with the user so as to provide a customized sign on process for the customer service such as based on previous stored user account information and or based on registering the user as a new user for the Account Manager system whether directly or by re directing the user to interact with the Account Manager system . In addition in some embodiments the User Interaction Manager component will gather various information for the user in a customized manner and will store the information in the collected user information database data structure. If the sign on attempt is successful the Credential Manager component will generate a credential representing the user store the credential information in the credential database data structure on storage and return the credential to the customer service e.g. via a response to the user that is re directed back to the customer service for storage as a credential on storage of a computing system of the customer service as well as to optionally provide any information gathered for the user.

A customer service may then interact with the Account Manager and or Access Manager systems in order to perform various actions on behalf of the user e.g. to modify and or use account information of the user such as by providing the credential representing the user. Under some circumstances a user may be directed by a customer service to an affiliated service provided by an affiliated service computing system with a credential issued to the customer service for the user being provided to the affiliated service and stored with credentials on storage of the affiliated service computing system. The user may then optionally be similarly re directed by the affiliated service to interact with the Access Manager system and or Account Manager system in order to perform actions on behalf of the user. Customer services or their representatives may also interact with the Customer Status Manager component to obtain various information about the service including information about the service s own customer account with the Access Manager system and gathered user information from the collected user information database. In addition in at least some embodiments some customer services may each request that the Access Manager system and Account Manager system provide additional customized functionality to track and provide a variety of types of information about actions of users of the customer service such as to make available to the customer service most or all of the user related information that the customer service would have if it implemented its own sign on service. If so such user information is stored in an alternative user pool database data structure and is made available to those customer services by the Customer Status Manager component while similar detailed information about other users or the same users when interacting with other services is not made available to those customer services in the illustrated embodiment.

In at least some embodiments a Customer Verification Manager component is used to provide various additional security measures regarding interactions of customer services with the Access Manager system and or Account Manager system. In particular in such embodiments at least some messages from customer services must include digital signatures that are generated based on information in the message and using a secret access key known to the service and to the Customer Verification Manager component e.g. a secret access key determined during initial registration of the service and stored in the service information database such digital signatures are generated by a customer service in the illustrated embodiment via a Signature Generator component executing in memory of the computing system of the customer service using a secret access key not shown of the customer service. If so the Customer Verification Manager component verifies the included digital signature e.g. by replicating it by generating a new matching digital signature using the secret access key for the customer that is known to the component in order to authenticate the received message before other of the systems or components respond to the message. Such authentication of messages may further be performed for at least some affiliated services in at least some embodiments and circumstances. Furthermore in some embodiments other types of messages may be similarly digitally signed using a secret access key of one or more related services and authenticated based on the digital signatures. For example these messages include messages from the Access Manager system and or Account Manager system to a customer service or affiliated service that are authenticated by the recipient service messages between customer services and affiliated services that are authenticated with the assistance of the Customer Verification Manager component unless the services have access to the secret access keys of the other services etc.

It will be appreciated that the illustrated computing systems are merely illustrative and are not intended to limit the scope of the present invention. Access manager computing system may be connected to other devices that are not illustrated including through one or more networks such as the Internet or the Web. More generally the various computing systems may each comprise any combination of hardware and software that can interact in the manners described including computers network devices Internet appliances PDAs Personal Digital Assistants wireless phones pagers electronic organizers television based systems and other various consumer products that include inter communication capabilities. In addition the functionality provided by the access manager system components illustrated in may in some embodiments be combined in fewer components or distributed in additional components. Similarly in some embodiments the functionalities of some of the illustrated components may not be provided and or other additional functionality may be available.

Those skilled in the art will also appreciate that while various items are illustrated as being stored in memory or on storage while being used these items or portions of them can be transferred between memory and other storage devices for purposes of memory management and data integrity. Alternatively in other embodiments some or all of the software components may execute in memory on another device and communicate with an illustrated computing system or device via inter computer communication. Some or all of the access manager system components or data structures may also be stored e.g. as instructions or structured data on a computer readable medium such as a hard disk a memory a network or a portable article to be read by an appropriate drive. The access manager components and data structures can also be transmitted as generated data signals e.g. as part of a carrier wave on a variety of computer readable transmission mediums including wireless based and wired cable based mediums. Accordingly the present invention may be practiced with other computer system configurations.

The routine begins at step where an indication is received from an operator or other representative of a service to register the service as a customer with the access manager. After step the routine receives information in step about the service e.g. a service provided by or as part of a Web site such as in an interactive manner by displaying a page asking for the information e.g. as illustrated in or instead as part of a programmatically accessed API. After the information is received at step the routine determines whether or not to accept the customer such as based on whether the service and or operator are determined to be sufficiently trustworthy e.g. using the information obtained in step and or based on other criteria. If the customer is not accepted the routine proceeds to step to send a registration denial message and then continues to step . Otherwise at step the routine determines a level of permissions to grant the customer such as based on a degree of trust assessed for the service and or the operator and optionally based on factors such as any liability of the access manager resulting from actions of the service e.g. based on a type of the service a number of users of the service the types of co branding and or other customizations that the customer is enabled to use such as if a customer is allowed to specify and use executable code etc. any past experience between the access manager and the customer etc. In addition in some embodiments a customer may be charged more money to receive a higher level of permissions e.g. as part of a premium service and thus gain additional functionality. The increased charges may be based at least in part on the customer s ability to and or likelihood of exposing the access manager to liability such as by exposing confidential or sensitive user information to unauthorized users by allowing unauthorized users to conduct financial transactions or otherwise perform operations on behalf of users etc. In at least some embodiments the level of permissions for a customer may be reviewed and changed at later times. After the level of permissions has been determined in step depending on the permissions granted the routine determines whether to allow the customer to configure any brands and if so whether the customer has any such brands. If so the routine proceeds to step where brands are configured as appropriate.

Otherwise or after step the routine proceeds to step where co branding customization types that are available to the customer according to the determined level of permissions are displayed such as for a first of the brands and or for all brands if brands were configured in step . In some embodiments the display may be a Web page and may include a user interface similar to that of . After displaying the co branding customization types available one or more indications of co branding customizations are optionally received by the routine at step and stored for later use. In some embodiments if multiple pages or other groups of information may be co branded each page may be separately configured. In step predefined types of information gathering that are available to the customer according to the determined level of permissions are displayed and one or more indications of information gathering customizations are optionally received in step and stored for later use. In step predefined types of authority delegation that are available to the customer according to the determined level of permissions are displayed and one or more indications of authority delegation customizations are optionally received and stored for later use. In step if multiple brands were configured and are being customized individually the routine returns to step to initiate configuration for the next brand and if not the routine proceeds to step to perform additional processing if appropriate e.g. storing various information in appropriate datastores generating and providing to the customer a unique identifier and a secret access key etc. . The routine then proceeds to step to determine whether to continue. If so the routine returns to step and if not the routine ends at step .

The illustrated routine may be performed in other ways in alternative embodiments. For example although the routine shows that each brand may be configured for multiple types of customizations in some embodiments brands may only be able to have individually configured co branding customizations. In other embodiments the customizations may be specified in a different order and if the access manager customer does not have permission for configuring a particular type of customization the steps related to that type of customization may be skipped. For example if a customer does not have permission to gather information from the user the routine may skip from step to . While not illustrated here in some embodiments the routine could additionally use various other security information and or mechanisms such as to verify the identity of the customer s representative.

In step the routine receives an indication of a request regarding a user on behalf of a customer service such as for the user to sign on for the service. In the illustrated embodiment the request includes a customer identifier associated with the customer and a digital signature for the request that is generated in a manner specific to the customer. The digital signature attached to the request is then checked by the Customer Verification Manager routine as illustrated in and if it is determined in step to not be valid the routine continues to step to send a failure notice and then continues to step . If the signature is valid the routine instead continues to step to determine the type of the request If the request is for something other than sign on the requested operation is performed as appropriate in step . If the request is a sign on request the previously configured customizations for the customer associated with the received customer identifier are retrieved in step and in step a sign on page is generated with the customized co branded content and sent to the user. Then at step the routine determines if the user has an account with the access manager and if not the routine obtains information about the user and registers the user with the access manager in step . If the user already has an account with the access manager provider then sign on information is received from the user at step and in step it is determined whether the sign on information is valid e.g. matches the stored sign on information for the user . If the sign on information is not valid then the routine continues to step to send a failure notice to the user.

If the sign on information is valid or after step then at step a credential or other indication of the valid sign on of the user is generated to be provided to the service or in other embodiments to be provided to the user for use with one or more services such as for a specified period of time or according to other indicated criteria . The routine then determines in step whether to retrieve additional information about the user to be provided to the service e.g. a username unique identifier actual name etc. such as based on prior customizations and current circumstances and if so continues to step to retrieve the additional information as appropriate. In some embodiments the ability of a customer service to obtain this additional information may be restricted by the level of permissions granted to the customer. After step or if no additional information was retrieved the routine then determines at step whether any information is to be gathered about the user such as based on prior customizations and current circumstances and if so continues to step to gather the information about the user as appropriate. After step or if no information was gathered the credential and optionally other data e.g. the retrieved and or gathered information is sent to the customer such as via the user using HTTP redirect functionality. After steps or the routine determines whether to continue in step . If so the routine returns to step and if not ends at step .

The routine begins at step where a credential related request is received such as from an external service or another access manager component depending on the request the request may also contain additional parameters including an existing credential on which to perform the request. After the request is received the routine proceeds to step where it is determined if the received request is to generate a new credential to represent a user for a service such as from the User Interaction Manager component. If so the credential is created as appropriate in step such as by mapping a unique random number to the user or retrieving information about the user for inclusion as part of the credential and the routine continues to step to store the credential and optionally provide in to the requester. If the request was not to generate a credential then the routine determines in step if the request is to refresh an existing credential to extend its period of validity such as from a service to which the credential was initially issued. If so the routine determines in step whether the requester has permission to refresh the credential e.g. based on a level of permission granted to the requester and or information specified by the user represented by the credential such as during the sign on to the service . If permission exists then the credential is refreshed in step before the routine continues to step . If there is not enough permission to refresh the user credential then an error message is indicated at step and the routine proceeds to step .

If it is determined in step that the request is not to refresh the credential the routine proceeds to step to determine if the request is to clone an existing credential such as a request from a secondary affiliate service to obtain use of a credential for a user that was issued to a primary customer service with which the secondary service is affiliated. If so the routine continues to step to determine whether the credential cloning is authorized such as based on authority delegated to the secondary service from a primary service. In addition in some embodiments the cloning of a credential representing a user may involve requesting the user to provide information and to optionally approve or otherwise acknowledge the cloning and in such embodiments the determination of whether the cloning is authorized may further be based at least in part on the user actions. If it is determined in step that permission exists then in step the credential is cloned and the routine continues to step and if not then at step an indication is sent that an error occurred and the routine proceeds to step .

If it is determined in step that the request is not to clone a credential then the routine proceeds to step to determine if the request is to verify whether a credential is valid. If so then the routine determines in step if the credential is currently valid for the requestor and optionally for an indicated action and sends an indication of the credential s validity to the requester. If the request is not to determine if a credential is valid then at step the routine determines if the request is to determine when the credential will expire. If so then at step the routine determines the expiration and indicates it to the requester and if not the routine continues to step to respond to other types of requests as appropriate. After steps or the routine determines at step whether to continue. if so the routine returns to step and if not ends at .

The routine begins at step where a request is received from a customer. In step the routine determines if the request is authorized such as by interacting with the Customer Verification Manager component and or based on the level of permissions granted to the customer. If not the routine proceeds to step but otherwise determines in steps whether the customer has requested to modify various types of information and if so performs the modifications as appropriate. Types of information that may be modified by the customer in the illustrated embodiment include co branding customizations in steps and information gathering customizations in steps and authority delegation customizations in steps and brands in steps and and customer account information in steps and . If the received request is not to modify information the routine determines in step if the request is to monitor users. If so previously tracked user information is retrieved in step and provided to the customer and if not the routine continues to step to perform other requested functionality as appropriate. After steps and or if it was determined in step that the request was not authorized the routine continues to step to determine whether to continue. If so the routine returns to step and if not ends at step .

The client side routine of begins at step where an indication to generate an outgoing message from a customer service that is to include various information is received and in which various information is gathered for use in generating a customer specific digital signature to accompany the message for security purposes. In some embodiments information used in generating the signature includes at least some of the content of the message as well as other information that is not included such as a secret access key. In addition in some embodiments other information may be added to the information used in generating the signature such as a current timestamp e.g. to prevent the message from later being reused if intercepted . The messages to be sent may have various forms including an HTTP request sent using a URL or other URI Uniform Resource Identifier in which the message contents are included as part of one or more query string parameter values and in which the digital signature will be included as a value of another query string parameter. In step the routine generates a digital signature based on the gathered information such as by using a previously selected digital signature algorithm and using previously selected types of message information e.g. particular message parameter values in a particular order . In step the signature is added to the message before it is sent out and the routine then ends at step until a next signed message is to be sent.

The Verification Manager routine of begins at step where a request for verification of an incoming message is received such as a request received from access manager system or one of its components regarding a message received from a customer service or an affiliated service. At step the routine first determines if the message is sufficiently recent such as based on whether time elapsed from a timestamp attached to the message exceeds a predetermined period of time. If the timestamp is too old the routine sends an indication in step that the signature is invalid and additional processing as appropriate is optionally performed in step e.g. generating a notification if a pattern of invalid messages is seen . Then the routine proceeds to step .

If the timestamp was sufficiently recent then the routine proceeds to step to retrieve the stored secret access key for the customer from whom the message was received such as based on an identifier assigned to the customer that is included in the message and associated with the secret access key. In other embodiments the customer or other affiliated service may be identified in other ways such as based on the IP address from which the request is received. After retrieving the secret access key and any additional information about the customer in step the routine generates a digital signature for the message at steps and in the same manner as that described previously with respect to steps and of such as to use information included in the message not including the digital signature and the retrieved secret access key. In step the newly generated signature is then checked against the signature included in the message. If the two digital signatures are determined in step to be the same the message is verified and a corresponding confirmation is sent in step . If the message is not verified it is considered a forgery and a corresponding indication is sent in step . After steps or the routine proceeds to step where it determines whether to continue. If so then the routine returns to step and if not ends at step .

While not illustrated here in some embodiments similar techniques may be used by services to verify messages from the access manager. In addition various embodiments may have additional security features and mechanisms beyond the signature based verification illustrated in such as to gather information regarding the identity of a representative of a service when the representative is initially registering the service.

Thus various techniques may be used to provide customizable sign on and other functionality to services as well as to use various techniques to enhance security of interactions. In addition in some embodiments a variety of additional information and techniques may be used. For example customers of the access manager customers may include Web sites such as ecommerce sites and may be unrelated to the provider of the access manager. The level of permissions granted to a customer by the access manager may also vary such as to grant a higher level of permissions to well known respected sites than to unknown sites. In addition a low level of co branding permissions may only allow an access manager customer to specify images and text to be used while an access manager customer with higher level permissions may be able to add images image maps to provide functionality when a user selects any part of or a designated portion of the image specified types of user selectable functionality e.g. a header with dropdown buttons text links background music JavaScript code Flash animations Shockwave movies Java applets custom CSS Cascading Style Sheets styles etc. In some embodiments the granting of permissions happens automatically in a realtime or near realtime process while in other embodiments the process may take longer e.g. to allow for manual review of the service . In addition in some embodiments the level of permissions granted to a customer may be reviewed and modified such as on a periodic basis. For example if problems or concerns with a customer have arisen the level of permissions may be decreased. Conversely the level of permissions may be increased if no such problems have occurred such as to grant some or all new customers low levels of permission that are gradually increased if warranted by continued experience with the customer. For example permissions may be increased based on an analysis or review of traffic and or usage patterns by or on behalf of the customer. In some embodiments reviews of the level of permissions granted may be triggered by external factors such as news about or changes to the customer e.g. a merger or buyout of a customer bankruptcy etc. .

A variety of types of services may be used as affiliated services including but not limited to payment processors credit card verification services consumer survey services advertising services fulfillment services etc. and in some embodiments the provider of the access manager may offer some of its services as affiliated services. Affiliated services may in some cases be provided access to a subset of the information for a customer or a user to facilitate providing their services for example a consumer survey service may want to know when a particular product shipped to a consumer as well as contact information in order to perform follow up with the consumer about the product and service.

A message or other request sent from a service to the access manager may take a variety of forms in various embodiments. In some embodiments a request may be an HTTP message with message parameters or other contents passed as a query string and at least some information e.g. secret access keys confidential user sign on information and other user information etc. is preferably sent by secure means e.g. secure HTTP or in an offline manner e.g. via physical mail telephone etc. . Similarly a user s sign on information or other identifying information may have various forms such as a username and password various biometric information PKI based information etc. In some embodiments credentials may be exchanged as Web browser cookies or alternatively in a format specified by the WS Federation Passive Profile e.g. a WS Trust RequestSecurityTokenResponse XML element or based on another sign on specification standard e.g. based on the Liberty Alliance Project on Microsoft s Passport service etc. . Similarly in some embodiments a sign on process may be performed in various ways such as via the process specified in WS Federation Passive Requestor Profile.

As previously noted in some embodiments at least some customer services may request the establishment and use of an alternative data pool for users of the service such as to track a variety of types of interactions with the users. For example alternative data pools may store information about users such as purchases products or services viewed login times information modifications that are made and possibly information about historical or other activities of the users that are not specific to the customer service and in some embodiments a customer may be allowed to configure what data to store in the alternative data pool. In some embodiments the availability of an alternative data pool to a customer may be dependent on the level of permissions granted to the customer.

In some embodiments secret access keys may be modified or re generated such as periodically or if compromised. In addition additional security may be obtained by maintaining information about how to use the secret access key available only to appropriate recipients and moreover to optionally using different processes for different customers. In some embodiments an indicated process may include a list of parameters whose values for a message are to be included an ordering of the message parameters and a type of encoding to use and a process may be indicated to a customer in various manners e.g. documentation for use by a service operator in manually incorporating the process into the service executable code to be given various input so as to perform the process etc. . A digital signature may be generated in various ways such as by using a message authentication code e.g. HMAC keyed Hash Message Authentication Code with MD5 Message Digest algorithm 5 .

Those skilled in the art will also appreciate that in some embodiments the functionality provided by the routines discussed above may be provided in alternative ways such as being split among more routines or consolidated into fewer routines. Similarly in some embodiments illustrated routines may provide more or less functionality than is described such as when other illustrated routines instead lack or include such functionality respectively or when the amount of functionality that is provided is altered. In addition while various operations may be illustrated as being performed in a particular manner e.g. in serial or in parallel and or in a particular order those skilled in the art will appreciate that in other embodiments the operations may be performed in other orders and in other manners. Those skilled in the art will also appreciate that the data structures discussed above may be structured in different manners such as by having a single data structure split into multiple data structures or by having multiple data structures consolidated into a single data structure. Similarly in some embodiments illustrated data structures may store more or less information than is described such as when other illustrated data structures instead lack or include such information respectively or when the amount or types of information that is stored is altered.

From the foregoing it will be appreciated that although specific embodiments have been described herein for purposes of illustration various modifications may be made without deviating from the spirit and scope of the invention. Accordingly the invention is not limited except as by the appended claims and the elements recited therein. In addition while certain aspects of the invention are presented below in certain claim forms the inventors contemplate the various aspects of the invention in any available claim form. For example while only some aspects of the invention may currently be recited as being embodied in a computer readable medium other aspects may likewise be so embodied.

