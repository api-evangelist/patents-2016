---

title: Spectral stitching method to increase instantaneous bandwidth in vector signal analyzers
abstract: Various embodiments are described of devices and associated methods for processing a signal using a plurality of vector signal analyzers (VSAs). An input signal may be split and provided to a plurality of VSAs, each of which may process a respective frequency band of the signal, where the respective frequency bands have regions of overlap. Each VSA may adjust the gain and phase of its respective signal such that continuity of phase and magnitude is preserved through the regions of overlap. The correction of gain and phase may be accomplished by a complex multiply with a complex calibration constant. A complex calibration constant may be determined for each VSA by comparing the gain and phase of one or more calibration tones generated with each region of overlap, as measured by each of the VSAs.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09548882&OS=09548882&RS=09548882
owner: National Instruments Corporation
number: 09548882
owner_city: Austin
owner_country: US
publication_date: 20160317
---
This application is a continuation of U.S. application Ser. No. 14 515 144 entitled Spectral Stitching Method to Increase Instantaneous Bandwidth in Vector Signal Analyzers by Stephen L. Dark et al. filed Oct. 15 2014 which is incorporated herein by reference in its entirety as though fully and completely set forth herein.

The present invention relates to the field of signal processing and more particularly to systems and methods for increasing instantaneous bandwidth in a vector signal analyzer or a vector signal generator.

Instantaneous bandwidth is an important banner specification for all radio frequency RF vector signal analyzers VSAs and RF vector signal generators VSGs . The desire of the industry is to increase the bandwidth as much as possible without sacrificing dynamic range. In many cases the limiting factor in achieving the largest possible bandwidth is the sample rate of the analog to digital converters ADCs and digital to analog converters DACs . While ADC and DAC vendors are always working to increase the converter rates there still exists a desire in many applications for bandwidths that exceed the capabilities of state of the art ADCs and DACs. There are several different methods within the industry for achieving larger bandwidths each with their own disadvantages.

The prior methods for creating larger instantaneous bandwidths that do not intentionally sacrifice resolution fall into two categories 1 Time Interleaving time and 2 Quadrature Mixing phase . Both of these methods are industry standards for increasing bandwidth.

Time Interleaving uses converters that have larger bandwidths than their sample rates allow. For ADCs this is made possible by placing faster sample and hold circuits on the front end than the ADC backend is capable of digitizing. Then by taking N ADCs and staggering them in time by the ADC sample period divided by N the samples can be interleaved together to create an effective larger sample rate. This method introduces errors resulting from inaccuracies in staggering the time alignment and from differences in the magnitude and phase between the various ADCs. Therefore several online and offline DSP correction algorithms have been created to combat these effects. In general it is difficult to achieve more than 8 bits of dynamic range without DSP correction. With offline DSP correction this can be improved to better than 12 bits of dynamic range but can be very sensitive to temperature. Online methods typically have to assume something about the input signal and other negative effects occur when those assumptions are broken.

Quadrature mixing uses a quadrature down converter or up converter to mix an RF signal into or from two signals an in phase signal and a quadrature phase signal. In the case of a down converter the RF signal is mixed with a sinusoid to create the in phase signal and the same RF signal is mixed with a sinusoid that is 90 degrees out of phase with the in phase sinusoid to create the quadrature phase signal. Finally each of these two analog signals is digitized with ADCs. These two signals are typically represented as a single complex signal where the in phase signal represents the real part and the quadrature phase part of the signal represents the imaginary part. As a result the positive frequency bandwidth is independent of the negative frequency bandwidth. Thus the net effect is a doubling of the bandwidth. Using this method the full resolution of the data converters is preserved. However this method typically creates a DC leakage spur and an image spur. In addition the method only scales to two converts.

Thus there exists a need for mechanisms capable of achieving the goal of larger instantaneous or modulation bandwidths from smaller bandwidths without the scalability and image rejection issues of the quadrature mixing technique and without the inaccuracies present for time interleaving methods.

Methods and systems are disclosed for processing a signal using a plurality of vector signal analyzers VSAs . In a presented method each of the plurality of VSAs may be provided with a respective component signal comprising a copy of a respective frequency band of an input signal. The combination of the respective frequency bands may comprise an aggregate frequency band having an aggregate center frequency. Each respective frequency band may have a respective region of overlap with at least one other respective frequency band. Each respective frequency band may also have a respective center frequency with a respective frequency offset from the aggregate center frequency. Each of the VSAs may be phase locked and time synchronized with respect to the other VSAs.

Each of the VSAs may process the provided respective component signal. The processing may comprise digitizing interpolating frequency shifting filtering and adjusting the gain and phase of the respective component signal. The digitizing may comprise shifting the respective center frequency of the respective frequency band to baseband and sampling at least a portion of the respective component signal corresponding to the respective measurement band. The frequency shifting may comprise shifting the respective component signal such that the respective center frequency is offset from baseband by the respective frequency offset. The filtering the respective component signals may be configured to cause a sum of the component signals to have a unity frequency response within each region of overlap. The filtering may be performed using a digital half band filter. The adjusting gain and phase of the respective component signals may be configured to cause the sum of the component signals to have a continuous frequency response over the aggregate frequency band.

The method may further comprise summing the respective component signals to obtain a composite signal.

A system is presented for processing a signal. The apparatus may comprise a signal splitter configured to receive an analog signal and output a plurality of copies of the analog signal. The system may further comprise a plurality of output ports each of the communication ports configured to provide to a respective vector signal analyzer VSA a respective copy of the modulated signal. The system may further comprise a plurality of input ports each of the input ports configured to receive from the respective VSA a respective digital signal. Each respective digital signal may comprise a digitized version of a respective frequency band of the analog signal. Each respective frequency band may have a region of overlap with at least one other frequency band received by another of the communication ports. Each respective frequency band may also have a respective center frequency having a respective frequency offset from an aggregate center frequency of an aggregate frequency band. The aggregate frequency band may comprise the combination of the frequency bands of the received digital signals. The respective VSA may be phase locked and time synchronized with respect to the VSAs of the other input ports.

The system may further comprise a plurality of parallel signal processing pathways. Each of the parallel signal processing pathways may be configured to receive a respective digital signal from one of the input ports and digitize interpolate frequency shift filter and adjust the gain and phase of the respective digital signal according to the method described above.

The system may further comprise a summing unit configured to sum the outputs of the plurality of parallel signal processing pathways to obtain a composite signal.

A method is provided for calibrating a signal processing system including at least a first VSA and a second VSA. The method may comprise providing a first component signal to the first VSA and providing a second component signal to the second VSA. The first component signal may comprise a first frequency band within an aggregate frequency band of an input signal and the second component signal may comprise a second frequency band within the aggregate frequency band of the input signal. The aggregate frequency band may have an aggregate center frequency. The first frequency band may have a first center frequency at a first frequency offset from the aggregate center frequency and the second frequency band may have a second center frequency at a second frequency offset from the aggregate center frequency. The second frequency band may have a region of overlap with the first frequency band the region of overlap containing a calibration tone. The second VSA may be phase locked and time synchronized with respect to the first VSA.

The method may further comprise digitizing interpolating frequency shifting and filtering each of the first and second component signals according to the method described above. The method may further comprise computing a complex calibration constant based on a magnitude ratio and a phase difference. The magnitude ratio may be determined by a magnitude of the calibration tone measured by the first VSA and a magnitude of the calibration tone measured by the second VSA. The phase difference may be determined by a phase of the calibration tone measured by the first VSA and a phase of the calibration tone measured by the second VSA.

The method may further comprise storing the complex calibration constant in memory. The complex calibration constant may be useable to correct phase and gain mismatch between the first VSA and the second VSA.

While the invention is susceptible to various modifications and alternative forms specific embodiments thereof are shown by way of example in the drawings and are herein described in detail. It should be understood however that the drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed but on the contrary the intention is to cover all modifications equivalents and alternatives falling within the spirit and scope of the present invention as defined by the appended claims. Note that the various section headings in the following Detailed Description are for organizational purposes only and are not meant to be used to limit the claims.

U.S. Patent Application No. 2013 0343490 filed Jun. 20 2012 entitled Synchronizing Receivers in a Signal Acquisition System invented by Wertz et al. 

U.S. Pat. No. 7 624 294 issued on Nov. 24 2009 entitled Synchronizing Measurement Devices Using Trigger Signals invented by Craig M. Conway and

U.S. Pat. No. 7 315 791 issued on Jan. 1 2008 entitled Application Programming Interface for Synchronizing Multiple Instrumentation Devices invented by Kosta Ilic et al.

Memory Medium Any of various types of memory devices or storage devices. The term memory medium is intended to include an installation medium e.g. a CD ROM floppy disks or tape device a computer system memory or random access memory such as DRAM DDR RAM SRAM EDO RAM Rambus RAM etc. a non volatile memory such as a Flash magnetic media e.g. a hard drive or optical storage registers or other similar types of memory elements etc. The memory medium may comprise other types of memory as well or combinations thereof. In addition the memory medium may be located in a first computer in which the programs are executed or may be located in a second different computer which connects to the first computer over a network such as the Internet. In the latter instance the second computer may provide program instructions to the first computer for execution. The term memory medium may include two or more memory mediums which may reside in different locations e.g. in different computers that are connected over a network.

Programmable Hardware Element includes various hardware devices comprising multiple programmable function blocks connected via a programmable interconnect. Examples include FPGAs Field Programmable Gate Arrays PLDs Programmable Logic Devices FPOAs Field Programmable Object Arrays and CPLDs Complex PLDs . The programmable function blocks may range from fine grained combinatorial logic or look up tables to coarse grained arithmetic logic units or processor cores . A programmable hardware element may also be referred to as reconfigurable logic .

Computer System any of various types of computing or processing systems including a personal computer system PC mainframe computer system workstation network appliance Internet appliance personal digital assistant PDA television system grid computing system or other device or combinations of devices. In general the term computer system can be broadly defined to encompass any device or combination of devices having at least one processor that executes instructions from a memory medium.

Local Oscillator LO a circuit configured to generate a periodic signal at a specified frequency and amplitude. The periodic signal may be a pure sinusoid and its frequency and or amplitude may be programmable. The periodic signal may or may not be phase or frequency locked to another periodic signal.

Time interleaving uses time as the mechanism to increase the bandwidth while quadrature mixing uses phase as its mechanism. The present spectral stitching approach uses frequency as its mechanism to achieve larger instantaneous bandwidths. The spectral stitching approach may be applied to both signal receivers such as RF radio frequency receivers for example and signal generators such as RF generators for example as discussed below. As used herein the term RF is intended to include the full spectrum of communication frequencies and includes at least radio and microwave frequencies.

Embodiments of the present invention may be realized in any of various forms. For example in some embodiments the present invention may be realized as a computer implemented method a computer readable memory medium or a computer system. In other embodiments the present invention may be realized using one or more custom designed hardware devices such as ASICs. In other embodiments the present invention may be realized using one or more programmable hardware elements such as FPGAs.

In some embodiments a computer readable memory medium may be configured so that it stores program instructions and or data where the program instructions if executed by a computer system cause the computer system to perform a method e.g. any of a method embodiments described herein or any combination of the method embodiments described herein or any subset of any of the method embodiments described herein or any combination of such subsets.

In some embodiments a computer system may be configured to include a processor or a set of processors and a memory medium where the memory medium stores program instructions where the processor is configured to read and execute the program instructions from the memory medium where the program instructions are executable to implement any of the various method embodiments described herein or any combination of the method embodiments described herein or any subset of any of the method embodiments described herein or any combination of such subsets . The computer system may be realized in any of various forms. For example the computer system may be a personal computer in any of its various realizations a workstation a computer on a card an application specific computer in a box a server computer a client computer a hand held device a tablet computer a wearable computer etc.

In a receive path spectral stitching may be performed by using a plurality N of vector signal analyzers VSAs to digitize an analog input receive RX signal such as an RF signal where each VSA handles a respective frequency band of the signal. Together the respective frequency bands comprise an aggregate frequency band of interest. The outputs of the N VSAs may therefore be recombined to form a composite signal having a bandwidth on the order of N times the bandwidth of each individual VSA thus covering the entire aggregate frequency band. The aggregate frequency band may be a region of interest within the input RX signal.

One or more calibration tones may be added to the inputRX signal to aid in calibrating the plurality of VSAs as discussed below. In some embodiments the one or more calibration tones may be generated by calibration tone generator and added to the input signal by a power combiner . In other embodiments the one or more calibration tones may be added to the input signal using a simple two port mux or using any other signal combining technique known in the art. In some embodiments the system may include multiple calibration tone generators which may require the power combiner to have more than two inputs. The one or more calibration tones may be generated and added to the input signal while the system is operating in a calibration mode as discussed below. Thus in normal operation the power combiner may not add the one or more calibration tones to the input signal.

A copy of at least a portion of the inputRX signal may be provided to each of the VSAs . This may be accomplished by splitting the input signal such as by using a power splitter having N outputs.

The output of each VSA may be provided to a summing unit . The output of the summing unit is a composite signal representing the sum of the output of each of the VSAs 

As mentioned previously each of the VSAs may handle a different frequency band of the inputRX signal. To ensure continuity across the full aggregate frequency band the different frequency bands handled by the respective VSAs should overlap. Thus in order for the sum of the outputs of the VSAs to accurately represent a digitized version of the aggregate frequency band of the inputRX signal the outputs of the VSAs may be further processed to provide continuity through the regions of overlap. Each of the VSAs may therefore comprise signal processing capabilities beyond those traditionally included in a VSA. In some embodiments each of the VSAs may not comprise a stand alone VSA. For example each of the VSAs may be implemented as a signal processing path on a programmable hardware element multiprocessor system etc.

At each of the digitize blocks a component signal comprising a respective frequency band of the inputRX signal may be digitized. Each of the digitize blocks may include functionality included in a traditional VSA.

In some embodiments each of the digitize blocks may receive a copy of the entire inputRX signal e.g. from the signal splitter . In other embodiments each of the digitize blocks may receive only a respective portion of the inputRX signal. Because each of the VSAs may handle a different frequency band of the inputRX signal each of the digitize blocks may digitize a respective component signal comprising a respective frequency band each respective frequency band identified by a respective center frequency.

The frequency bands may overlap to avoid gaps within the aggregate frequency band. For example the region represents a region of overlap between frequency band and frequency band i.e. between the respective component signals of VSAs and and the region represents the region of overlap between frequency band and frequency band i.e. between the respective component signals of VSAs and .

The digitizing performed by each of the digitize blocks may comprise performing I Q demodulation on the respective component signal to produce a pair of analog I in phase and Q quadrature signals.

The digitizing performed by each of the digitize blocks may also comprise frequency shifting the respective component signal or the I Q signal pair such that the respective center frequency is shifted to baseband. Each of the digitize blocks may then filter out portions of the shifted signal that are outside the respective frequency band e.g. by using a low pass filter. Alternatively each of the digitize blocks may frequency shift the received inputRX signal to a position other than baseband or forego frequency shifting and filter the shifted signal using a band pass filter.

In one embodiment each of the digitize blocks may comprise a respective local oscillator LO operating at the respective center frequency. The respective LO may be used for example in frequency shifting the respective center frequency to baseband. The LOs of the digitize blocks may have a fixed phase difference relative to each other. For example the LOs may be locked to a common reference such that the relative phases between the devices will remain fixed.

The digitizing performed by each of the digitize blocks may further comprise complex sampling the filtered signal as known in the art. The VSAs may be time synchronized such that the respective signals may be sampled simultaneously in each of the digitize blocks . Alternatively the respective signals may be sampled at a consistent offset of time. In this case the consistent offset may be measured and corrected. Each of the digitize blocks may output a complex I Q signal.

At filter blocks the respective component signals may be filtered. Because the respective frequency bands of the respective component signals overlap in frequency as shown in the overlap regions should be filtered to prevent power spikes or other artificial increases in magnitude in the overlap regions when the respective signals are summed by summing unit . In other words the respective component signals should be filtered such that their sum appears continuous. Specifically the respective component signals may be filtered such that the sum of overlapping signals provides a unity response at all points within the aggregate frequency band. More generally this continuous sum filtering may be configured in any manner such that the summed signals approximate the result that would be achieved if the entire aggregate frequency band had been digitized by a single VSA having sufficient bandwidth to digitize the entire aggregate frequency band.

Various filter shapes may be used to accomplish this. For example illustrates the response of a half band filter where the solid trace represents a filter response for a first VSA and the dotted trace represents a filter response for a second VSA with an overlapping frequency band. In the crossover point is located at 30 MHz where there is a 10 MHz crossover region. While a half band filter inherently has the needed spectral characteristics to filter overlapping frequency bands to sum together to produce unity gain it forces the crossover point to occur at the sampling frequency divided by four fs 4. In other embodiments this crossover may be moved further out in frequency using other filter methods e.g. to increase the effectiveness of the natural instantaneous bandwidth of each device.

The filtering illustrated as filter blocks may happen at any of various points in the VSA. For example the filtering may occur after the interpolate blocks . Alternatively some embodiments may perform the filtering of the filter blocks within the digitize blocks e.g. concurrently with the low pass filtering of the digitize blocks . In this case the filtering may be performed by an analog filter prior to complex sampling of the filtered signal.

At interpolate blocks each respective component signal may be interpolated. The interpolation factor should be set such that each respective interpolate block interpolates the respective component signal to at least the effective I Q rate required for the stitched data s bandwidth. For example in one embodiment the effective I Q rate may be required to be at least the Nyquist rate of the respective component signal. In another embodiment a higher rate e.g. 1.25 times the Nyquist rate may be selected.

At frequency shift blocks each respective component signal may be shifted into the proper location in frequency relative to the other devices. As a result each device will frequency shift its interpolated spectrum to a different location. Specifically each respective component signal may be shifted such that its respective center frequency is offset from baseband by the respective frequency offset by which it was originally offset from the aggregate center frequency. Thus the entire aggregate frequency band is frequency shifted to center at baseband.

For example in the case that there are three VSAs each using half band filters with an I Q rate of 120 MHz then the cross over points will be located at positive and negative 30 MHz. This means that the three respective center frequencies may be shifted to 60 MHz 0 Hz 60 MHz . Thus the respective frequency bands should be defined such that the respective frequency offsets are 60 MHz 0 Hz 60 MHz relative to the aggregate center frequency.

If the digitize blocks previously shifted the respective center frequencies to baseband then VSA may in this example frequency shift its spectrum to the left by 60 MHz VSA may shift by 0 Hz and VSA may frequency shift its spectrum to the right by 60 MHz. In other words each respective center frequency may be shifted by its respective frequency offset. In embodiments in which the respective frequencies were shifted by the digitize blocks to a frequency other than baseband then the respective center frequencies may be shifted by some value other than the respective frequency offsets.

At the gain and phase correction blocks the magnitude and phase of each respective component signal may be adjusted to make the spectrum continuous through the regions of overlap. This gain and phase correction may comprise a complex multiply of each of one or more of the respective component signals with a respective calibration constant. Determining a calibration constant for each of the gain and phase correction blocks is discussed below.

Where the VSAs are not time synchronized but have a constant delay relative to each other the gain and phase correction blocks may be further configured to measure and correct the delay.

In the power combiner the calibration tone generator and the power splitter may operate as described with regard to . The VSAs may be standard VSAs as known in the art without the additional signal processing capabilities of VSAs . Instead the additional signal processing functions may be performed by a separate digital signal processing block . For example the digital signal processing block may perform the functions of filtering interpolating frequency shifting and gain and phase correction as discussed with regard to blocks for each of the VSAs . For example the digital signal processing block may comprise a separate signal processing path for processing the output of each of the VSAs . The digital signal processing block may further comprise a summing function which may function in a manner similar to the summing unit .

The system presents an advantage over the system in that the system may allow a user to utilize standard off the shelf VSAs. For example system may be realized in the form of a signal processing chassis comprising the digital signal processing block and optionally further comprising one or more of the power combiner the calibration tone generator and the power splitter . The signal processing chassis may further comprise slots to accept a plurality of VSAs which may be standard off the shelf VSAs. The signal processing chassis may be configured to operate with a variable number of VSAs according to the preferences of the user. Further the VSAs may differ in bandwidth resolution or other characteristics according to the preferences of the user.

In order to adjust the magnitudes and phases of the respective signals in the receive path to provide continuity through the regions of overlap the relative magnitudes and phases between the respective signals without adjustment may be determined. This may be performed by injecting a calibration tone at each crossover point or region of overlap of the respective frequency bands. The calibration tone may then be measured and compared by the VSAs. Differences and or ratios between the measurements by different VSAs of the magnitude and phase of the calibration tone may be used to determine calibration constants for each of the VSAs.

For example to determine calibration constants for a system such as the system shown in or the system shown in the system may be set to a calibration mode. The calibration mode will be discussed herein with respect to the system shown in . However the same principles may be applied to other embodiments such as the system .

As shown in the power combiner may be used to combine the input signal with one or more calibration tones from the calibration tone generator . A calibration tone may comprise a real tone at a single known frequency falling within a region of overlap. A calibration tone may also have a known magnitude. In some embodiments a calibration tone may be injected at a single region of overlap at a time with each region of overlap being treated sequentially. In other embodiments calibration tones may be injected at multiple or all regions of overlap simultaneously. The combined signal may then be used as the input to the splitter where each of the splitter s outputs may be the input to one of N VSAs such as VSAs 

At the N VSAs each of the N 1 regions of overlap may comprise a respective calibration tone as shown in either simultaneously or sequentially . As illustrated calibration tone may be generated within region of overlap i.e. within the respective signals of VSAs and and calibration tone may be generated within region of overlap i.e. within the respective signals of VSAs and .

At blocks each respective signal may be digitized filtered interpolated and frequency shifted as discussed above with regard to . However the gain and phase correction block may operate differently in the calibration mode. Specifically the gain and phase correction block may measure the respective calibration tone within each region of overlap. For example the gain and phase correction block of VSA may measure the calibration tone since it falls within the respective frequency band which is processed by the VSA . The gain and phase correction block of VSA may also measure the calibration tone since it also falls within the respective frequency band which is processed by the VSA

Using the measurements of the calibration tone within each region of overlap respective calibration constants may be determined for use in realigning the respective signals through each region of overlap. For example for each respective VSA a complex calibration constant may be determined that when complex multiplied by a calibration tone measured by that respective VSA will result in an output calibration tone having a phase and magnitude matching an output calibration tone of an adjacent VSA. illustrates output calibration tones of VSAs and . The output calibration tones shown in represent the signals shown in after being multiplied by the determined calibration constants.

In one embodiment the magnitudes of the calibration tones generated by the calibration tone generator may be known. The calibration constants may therefore be determined such that the output calibration tones have a magnitude matching the generated calibration tones. In another embodiment the calibration constants may merely be determined such that the output calibration tones produced by adjacent VSAs have the same magnitude.

For example calibration tone may be measured by both VSA and VSA . Calibration tone may be measured by both VSA and VSA . The output signal of VSA will include an output calibration tone corresponding to calibration tone . The output signal of VSA will include output calibration tones corresponding to calibration tone and calibration tone . The output signal of VSA will include an output calibration tone corresponding to calibration tone .

A first calibration constant may optionally be determined for VSA such that complex multiplication of the first calibration constant with the output signal of VSA results in the output calibration tone corresponding to calibration tone having a magnitude matching the known magnitude of calibration tone .

A second calibration constant may be determined for VSA such that complex multiplication of the second calibration constant with the output signal of VSA results in the output calibration tone corresponding to calibration tone having a phase matching the phase of the output calibration tone of VSA . The second calibration constant may further be determined such that the output calibration tone corresponding to calibration tone has a magnitude matching the known magnitude of calibration tone and or the magnitude of the output calibration tone of VSA corresponding to calibration tone . In one embodiment a calibration constant determined to cause the output calibration tone of to match the phase and magnitude of the output calibration tone of VSA may be determined by performing a complex division of the calibration tone as measured by VSA by the calibration tone as measured by VSA . Because the complex multiplication of the second calibration constant is performed with the entire output signal of VSA the output calibration tone of VSA corresponding to calibration tone is also adjusted.

A third calibration constant may be determined for VSA such that complex multiplication of the third calibration constant with the output signal of VSA results in the output calibration tone corresponding to calibration tone having a phase matching the phase of the adjusted output calibration tone of VSA corresponding to calibration tone . The third calibration constant may further be determined such that the output calibration tone corresponding to calibration tone has a magnitude matching the known magnitude of calibration tone and or the magnitude of the output calibration tone of VSA corresponding to calibration tone .

The calibration constants for each of the VSAs should be determined or re determined each time the phases of the VSAs change relative to each other. For example the relative phases of the VSAs may change if the relative phases of the LOs of the VSAs change. This may occur e.g. if the LO frequencies of one or more VSAs change and the one or more VSAs are relocked. In some VSAs the phase of the LO can be made to be deterministic. If this is the case then a calibration constant may be determined once and stored for each frequency of the VSA. The stored calibration constant may then be recalled at some future time without the need for recalibration.

In a transmit path spectral stitching may be performed by using a plurality N of vector signal generators VSGs to generate an output analog transmit TX signal such as an RF signal where each VSG handles a respective frequency band of the signal. Together the respective frequency bands comprise an aggregate frequency band of interest. The outputs of the N VSAs may therefore be combined to form a composite signal having a bandwidth on the order of N times the bandwidth of each individual VSG thus covering the entire aggregate frequency band.

A digital input signal illustrated in as the TX Signal may be provided to the system. The input TX Signal may comprise a complex digital signal having a bandwidth that is larger than the bandwidth of each respective VSG. Therefore each of the VSGs may be provided with a respective component signal comprising at least a portion of the input TX Signal. Specifically each component signal may comprise a respective frequency band of the input TX Signal and each of the VSGs may process the respective frequency band. Each respective frequency band may have a respective center frequency having a respective frequency offset from an aggregate center frequency of the aggregate frequency band.

To ensure continuity across the full aggregate frequency band the respective frequency bands should overlap. Thus in order for the outputs of the VSGs to be recombined to accurately represent an analog version of the aggregate frequency band of the digital input signal the component signals may be further processed to provide continuity through the regions of overlap. Each of the VSGs may therefore comprise signal processing capabilities beyond those traditionally included in a VSG. Alternatively such further processing may be performed by signal processing circuitry outside of the VSGs such as by the digital signal processing DSP block which is described more fully below. Such an embodiment would allow a user to implement the present invention using standard off the shelf VSGs. In other embodiments each of the VSGs may not comprise a stand alone VSG. For example each of the VSGs may be implemented as a signal processing path on a programmable hardware element multiprocessor system etc.

Once the further processing has been performed e.g. by the DSP block or by each of the VSGs . each of the VSGs may convert the respective component signal to an analog signal. Each of the VSGs may also up convert the respective component signal such that the aggregate center frequency is located at a desired carrier frequency and each respective center frequency is offset from the desired carrier frequency by the respective frequency offset.

The combiner may comprise a power combiner with a plurality of inputs or may comprise any other hardware for combining analog signals as known in the art. The combiner may receive as inputs the outputs of the VSGs and may output a composite signal comprising a combination of its inputs.

A power splitter may provide copies of the composite signal as an output of the system i.e. as TX Out shown in and also to a calibration receiver . The calibration receiver may be used to receive one or more calibration tones for use in determining calibration constants for one or more of the VSGs as discussed below. The calibration receiver may be phase locked to the VSGs 

In some embodiments each of the frequency shift blocks may receive a copy of the entire digital input signal. In other embodiments each of the frequency shift blocks may receive only a respective portion of the digital input signal comprising a respective frequency band.

The frequency bands may overlap to avoid gaps within the aggregate frequency band. For example the region represents a region of overlap between frequency band and frequency band i.e. between the respective component signals of VSGs and and the region represents the region of overlap between frequency band and frequency band i.e. between the respective component signals of VSGs and .

At the frequency shift blocks each of the respective component signals may be shifted to baseband. Where the aggregate frequency band is initially at baseband this means that each respective component signal is frequency shifted by the negative of the respective frequency offset. For example if the respective frequency offset of the respective component signal being processed by the frequency shift block is 60 MHz then the frequency shift block would frequency shift the respective component signal by 60 MHz.

At the decimate blocks each respective component signal may be decimated to a rate that is less than or equal to the maximum sample rate of the corresponding VSG. This decimation may comprise merely dropping samples. Alternatively this decimation may comprise alias protected decimation utilizing an alias protection filter.

The filter blocks are similar to the filter blocks of . Because the respective frequency bands of the respective component signals overlap in frequency as shown in the overlap regions should be filtered to prevent power spikes in the overlap regions when the respective signals are combined by the combiner . In other words the respective component signals should be filtered such that their sum appears continuous. Specifically the respective component signals may be filtered such that the sum of overlapping signals provides a unity response at all points within the aggregate frequency band.

Various filter shapes may be used to accomplish this. For example illustrates the response of a half band filter where the solid trace represents a filter response for a first VSG and the dotted trace represents a filter response for a second VSG with an overlapping frequency band. In the crossover point is located at 30 MHz where there is a 10 MHz crossover region. While a half band filter inherently has the needed spectral characteristics to filter overlapping frequency bands to sum together to produce unity gain it forces the crossover point to occur at the sampling frequency divided by four fs 4. In other embodiments this crossover may be moved further out in frequency using other filter methods e.g. to increase the effectiveness of the natural instantaneous bandwidth of each device.

At the gain and phase correction blocks the magnitude and phase of each respective component signal may be adjusted to make the spectrum continuous through the regions of overlap. This gain and phase correction may comprise a complex multiply of each of one or more of the respective component signals with a respective calibration constant. Determining a calibration constant for each of the gain and phase correction blocks is discussed below.

In order to adjust the magnitudes and phases of the respective signals in the transmit path to provide continuity through the regions of overlap the relative magnitudes and phases between the respective signals without adjustment may be determined using one or more calibration tones. This may be performed in multiple ways.

For example to determine calibration constants for a system such as the system shown in the system may be set to a calibration mode which may operate according to one of the following approaches.

In a first approach a calibration tone may be added to the input TX Signal within a region of overlap of the respective frequency band of the first VSG and the respective frequency band of a second adjacent VSG. The calibration tone may be generated by a digital calibration tone generator not shown which may be comprised within the DSP block or may be a separate component. The calibration tone may be added to the input TX Signal using a switch a multiplexer or by using any other method known in the art. Preferably the calibration tone may be generated at the center of the region of overlap. For example the calibration tone generator may generate a calibration tone within the region as shown in . The respective outputs of the VSG and the VSG will thus each include a representation of the calibration tone. With the output of the VSG turned off or disabled the magnitude and phase of the representation of the calibration tone present in the output of the VSG may be measured by the calibration receiver . The output of the first VSG may then be turned off or disabled and the output of the second VSG may be enabled. For example the VSG may be enabled. The representation of the calibration tone present in the output of the VSG may then be measured by the calibration receiver . Where the calibration receiver is phase locked with the VSGs and throughout the time when the two measurements are made a relative phase difference of the VSGs and may be determined by comparing the phases of the two representations of the calibration tone as measured by the calibration receiver . A relative magnitude difference of the VSGs and may also be determined by comparing the magnitudes of the two representations of the calibration tone . A calibration constant may then be determined for one or more of the VSGs and based on the determined relative phase difference and the determined relative magnitude difference. This method may be repeated for each of the regions of overlap.

In a second approach an iterative method may be used to determine the relative magnitude and phases. In this method both the VSG and the VSG may each simultaneously generate an output comprising a representation of the calibration tone . Then the magnitude and phase of the VSG may be iteratively adjusted seeking to force the respective representations of the calibration tone present in the respective outputs of VSG and VSG to deconstructively interfere. In other words the magnitude and phase of the representation of the calibration tone present in the output of the VSG may be iteratively adjusted until the total output power at the frequency of the representation of the calibration tone is minimized. The calibration constant may then be determined by negating the VSG result to rotate it by 180 degrees. This procedure may then be repeated for each overlap region. While this second approach would take longer than the direct measurement of the first approach this second approach does not require the calibration receiver to be phase locked to the VSGs. Moreover since the calibration receiver is only making unlocked power measurements the calibration receiver may be replaced by a power meter thereby simplifying the hardware requirements of the calibration circuitry.

The calibration constants for each of the VSGs should be determined or re determined each time the phases of the VSGs change relative to each other. For example the relative phases of the VSGs may change if the relative phases of the LOs of the VSGs change. This may occur e.g. if the LO frequencies of one or more VSGs change and the one or more VSGs are relocked. In some VSGs the phase of the LO can be made to be deterministic. If this is the case then a calibration constant may be determined once and stored for each frequency of the VSG. The stored calibration constant may then be recalled at some future time without the need for recalibration.

Although the embodiments above have been described in considerable detail numerous variations and modifications will become apparent to those skilled in the art once the above disclosure is fully appreciated. It is intended that the following claims be interpreted to embrace all such variations and modifications.

