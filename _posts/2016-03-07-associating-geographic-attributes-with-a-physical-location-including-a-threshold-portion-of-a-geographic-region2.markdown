---

title: Associating geographic attributes with a physical location including a threshold portion of a geographic region
abstract: An online system receives a description of a physical location associated with a content item and a threshold distance of the physical location. To identify users eligible to be presented with the content item, the online system divides a geographic map of the physical location associated with the content item into a plurality of geo-tiles each representing a portion of the map. The online system computes and stores values describing portions of a geographic region represented by certain geo-tiles and associates the geographic region with the physical location if the stored values equal or exceed a threshold value. If the geographic region is associated with the physical location, users associated with the geographic region are identified by the online system as eligible to receive the content item.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09641972&OS=09641972&RS=09641972
owner: Facebook, Inc.
number: 09641972
owner_city: Menlo Park
owner_country: US
publication_date: 20160307
---
This disclosure relates generally to online systems and more specifically to presenting content to users of an online system.

Online systems such as social networking systems allow users to connect to and to communicate with other users of the online system. Users may create profiles on an online system that are tied to their identities and include information about the users such as interests and demographic information. The users may be individuals or entities such as corporations or charities. Online systems allow users to easily communicate and share content with other online system users by providing content to an online system for presentation to other users. Content provided to an online system by a user may be declarative information provided by a user status updates check ins to locations images photographs videos text data or any other information a user wishes to share with additional users of the online system. An online system may also generate content for presentation to a user such as content describing actions taken by other users on the online system.

Additionally many online systems commonly allow users e.g. businesses to sponsor presentation of content on an online system to gain public attention for a user s products or services or to persuade other users to take an action regarding the user s products or services. Content for which the online system receives compensation in exchange for presenting to users is referred to as sponsored content. Many online systems receive compensation from a user for presenting other online system users with certain types of sponsored content provided by the user. Frequently online systems charge a user for each presentation of sponsored content to an online system user or for each interaction with sponsored content by an online system user. For example an online system receives compensation from a user each time a content item provided by the user is displayed to another user on the online system each time another user interacts with a content item from the user presented by the online system e.g. selects a link included in the content item or each time another user performs another action after being presented with the content item e.g. visits a physical location associated with the user who provided the content item to the online system .

Content items may be associated with targeting criteria that identify characteristics of online system users eligible to be presented with the content item. For example a content item is eligible to be presented to an online system user having characteristics satisfying at least a threshold amount of targeting criteria associated with the content item however the content item is not eligible to be presented to another online system user having characteristics satisfying less than the threshold amount of targeting criteria associated with the content item. Targeting criteria associated with a content item are often specified by a user providing the content item to an online system. For example content items describing a particular restaurant are associated with targeting criteria identifying a threshold frequency of checking in to the restaurant or to similar restaurants via the online system profile information maintained by the online system including dining out as an interest or hobby and indicating a preference for a page about the restaurant on the online system. Hence targeting criteria associated with a content item allows an online system to identify users who are most likely to be interested in being presented with a particular content item as eligible be presented with the content item.

Some content items may be more relevant to some users than to other users based on physical locations associated with the users. For example content items describing a particular restaurant in the city of San Francisco are more likely to be relevant to users who frequently visit the area where the restaurant is located or who are current or former residents of San Francisco than to users who are not associated with the area or with the city. Hence targeting criteria associated with content items often identify a threshold distance from a physical location associated with the content items to identify users associated with a location within the threshold distance of the content items as eligible to be presented with the content items on the online system. Therefore targeting criteria associated with content items describing the restaurant in the previous example may specify a threshold distance from the physical location of the restaurant for a current location of online system users or for another location associated with online system users.

Conventional online systems do not identify users associated with locations greater than a threshold distance of a physical location specified by targeting criteria associated with a content item as eligible to be presented with the content item. However some users associated with locations that do not satisfy targeting criteria associated with the content item are interested in being presented with the content item. For example the online system does not identify a user living in San Francisco as eligible to be presented with a content item associated with a restaurant if a location associated with the user is not within a threshold distance of the location of the restaurant specified by targeting criteria associated with the content item even though the user may have an interest in the restaurant. Accordingly targeting criteria including location information may inadvertently prevent presentation of content items associated with the targeting criteria from users who would be interested in being presented with the content items. Although online systems may attempt to identify users who would be interested in receiving content items associated targeting criteria identifying physical locations but who are not associated with locations satisfying the targeting criteria identifying such users involves additional time when selecting content items for to users which may decrease user interaction with the online system.

An online system identifies users eligible to be presented with a content item on the online system based on a geographic attribute associated with the users. In various embodiments the geographic attribute describes a geographic region including a specific physical location or including a portion of an area surrounding the specific physical location. For example the online system identifies users associated with a hometown of a particular city and determines the users are eligible to be presented with a content item associated with a geographic landmark in the city if a threshold portion of the city is included within a threshold distance of the landmark. Example geographic attributes include a hometown a workplace a birthplace a current location or any other information describing a geographic region.

In various embodiments the online system associates users with the geographic attribute based on declarative information provided to the online system by the users. In some embodiments the online system associates users with the geographic attribute based on location information received by the online system. For example the online system associates a user with a geographic attribute in response to receiving a threshold amount of location information from client devices associated with the user within a threshold distance of a specific physical location included in the geographic attribute or in response to receiving a threshold number of check ins by the user at locations within the threshold distance of the specific physical location included in the geographic attribute.

Additionally a user may associate a physical location and a threshold distance from the physical location with a content item. For example a user providing an advertisement request ad request to the online system identifies a physical location associated with the ad request and a maximum distance of two miles from the physical location so an advertisement from the ad request is eligible for presentation to users associated with physical locations less than two miles from the identified physical location. Hence physical location and a threshold distance from the physical location associated with the content item act as targeting criteria for the content item. Hence the online system determines whether a user is eligible to be presented with the content item based at least in part on the geographic attribute associated with the user and the physical location and the threshold distance associated with the content item.

To determine whether a user is eligible to receive a content item associated with a physical location based on a geographic attribute associated with the user the online system determines whether an area within a specified distance or geo fence from the physical location associated with the content item includes at least threshold portion of the geographic region corresponding to the geographic attribute associated with the user. For example the online system determines whether a geo fence surrounding a physical location associated with a content item includes at least eighty percent of a city identified as a hometown of a user. If at least the threshold portion of the geographic region corresponding to the geographic attribute associated with the user is included in the geo fence from the physical location associated with a content item the online system determines the user is eligible to be presented with the content item. For example the online system determines a user is eligible to receive a content item associated with targeting criteria including a physical location and a threshold distance of the physical location if a geographic attributes associated with the user identifies a hometown determined to have at least a threshold portion included in a geo fence based on the threshold distance surrounding the physical location included in the targeting criteria.

To determine a portion of a geographic region within a specified distance i.e. a geo fence of a physical location the online system divides a map of a geographic area including the physical location into a plurality of geo tiles that each represent an area within the specified distance of the physical location and associates a geo tile identifier with each geo tile. In some embodiments the online system retrieves a set of geo tiles associated with the map of the physical location and stores geo tile identifiers associated with each geo tile. A size of a geo tile may be based on the density of objects e.g. buildings streets population etc. included in the geographic area included in the geo tile in some embodiments. For example each geo tile represents a geographic area having a density of objects within a threshold amount of densities of objects of geographic areas represented by other geo tiles. In the preceding example geographic areas including a low number of objects are represented by larger geo tiles while geographic areas including a high number of objects are represented by smaller geo tiles. Additionally the geographic region including the physical location and geo fence may be represented by multiple layers of geo tiles with different layers representing different levels of geo tile resolution. For example a layer includes geo tiles having a higher level of resolution representing smaller geographic areas with greater specificity of identifiable objects within the geo tiles while another layer includes geo tiles having a lower level of resolution representing larger geographic areas with less specificity of identifiable objects within the geo tiles.

Based on the geo tiles representing areas of the map of the geographic area including the physical location the online system determines whether a threshold amount of a geographic region is within the specified distance i.e. the geo fence of the physical location. The online system generates an index including geo tiles within the geo fence of the physical location having a portion of each geo tile within the geographic region. Information including a geo tile identifier for each geo tile in the index and a value describing a portion of the geographic region included in each geo tile in the index is stored by the online system. For example the online system identifies geo tiles representing at least a portion of a zip code computes a portion of the zip code represented by each of the identified geo tiles and stores the portion of the zip code represented by each of the identified geo tiles along with corresponding geo tile identifiers for the identified geo tiles. In various embodiments the value describing the portion of the geographic region included in each geo tile is a percentage of the area of the geographic region represented by the geo tile. For example the online system retrieves information describing a size of the geographic region determines a size of the geographic area included in a geo tile and determines the value for the geo tile based on the size of the geographic area included in the geo tile and the size of the geographic region. In some embodiments the online system stores additional information describing the geographic region e.g. name type geographic coordinates size etc. in association with the value and the geo tile identifier.

For each geo tile having at least a threshold portion of the geo tile within the geographic region the online system computes the value describing the portion of the geographic region included in the geo tile and stores the value in association with the corresponding geo tile identifier. However for a geo tile having at least a portion of the geo tile within the geographic region that is less than the threshold portion the online system computes the value based on a set of smaller geo tiles collectively representing the same geographic area as the geo tile. In some embodiments the online system divides the geo tile into smaller geo tiles each representing a portion of the divided geo tile. In other embodiments the online system retrieves a set of additional geo tiles each representing a portion of the divided geo tile.

In some embodiments the online system iteratively divides a geo tile having at least a portion of the geo tile within the geographic region that is less than the threshold portion into sets of smaller geo tiles. During each iteration the online system identifies geo tiles having at least a threshold portion of the geo tile within the geographic region computes the value describing the portion of the geographic region represented by each geo tile and stores the value in conjunction with a corresponding geo tile identifier. Also during each progression the online system also identifies geo tiles having at least a portion of the geo tile within the geographic region that is less than the threshold portion and divides the geo tiles having at least a portion of the geo tile within the geographic region that is less than the threshold portion until at least the threshold portion of the geographic region is within represented by each geo tile. The online system then computes the value describing the portion of the geographic region represented by each geo tile having at least threshold portion of the geo tile within the geographic region and stores the value in conjunction with a corresponding geo tile identifier. Hence the index may include geo tiles of varying sizes and resolutions representing geographic areas of various sizes and object densities.

The online system combines values associated with each geo tile in the index and determines whether the combined value equals or exceeds a threshold value. If the combined value equals or exceeds the threshold value the online system determines the geo fence of the physical location includes at least threshold amount of the geographic region. For example if the physical location is a city the value associated with each geo tile in the index is a percentage of the city represented by each geo tile and if a combined percentage of geo tiles in the index equals or exceeds a threshold value the online system determines a geographic region is within the geo fence of the city. In embodiments where progressively smaller geo tiles having a threshold area within the geographic region are indexed the online system combines values associated with the smallest mutually exclusive geo tiles in the index to determine the portion of the geographic region included in the geo fence of the physical location. The online system may reference the index to identify geographic regions included in a geo fence of physical location specified in targeting criteria associated with a content item when identifying users eligible to be presented with the content item. For example when the online system receives a request for content from as the online system references the index to identify geographic regions included in a geo fence of a physical location associated with a content item and identifies the content item as eligible for presentation to users having geographic attributes including the identified geographic regions.

The figures depict various embodiments for purposes of illustration only. One skilled in the art will readily recognize from the following discussion that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein.

The system environment shown by comprises one or more client devices a network one or more third party systems and the online system . In alternative configurations different and or additional components may be included in the system environment . The online system may be a social networking system a content sharing network or other system providing content to users.

The client devices are one or more computing devices capable of receiving user input as well as transmitting and or receiving data via the network . In one embodiment a client device is a conventional computer system such as a desktop or a laptop computer. Alternatively a client device may be a device having computer functionality such as a personal digital assistant PDA a mobile telephone a smartphone a smartwatch or another suitable device. A client device is configured to communicate via the network . In one embodiment a client device executes an application allowing a user of the client device to interact with the online system . For example a client device executes a browser application to enable interaction between the client device and the online system via the network . In another embodiment a client device interacts with the online system through an application programming interface API running on a native operating system of the client device such as IOS or ANDROID .

The client devices are configured to communicate via the network which may comprise any combination of local area and or wide area networks using both wired and or wireless communication systems. In one embodiment the network uses standard communications technologies and or protocols. For example the network includes communication links using technologies such as Ethernet 802.11 worldwide interoperability for microwave access WiMAX 3G 4G code division multiple access CDMA digital subscriber line DSL etc. Examples of networking protocols used for communicating via the network include multiprotocol label switching MPLS transmission control protocol Internet protocol TCP IP hypertext transport protocol HTTP simple mail transfer protocol SMTP and file transfer protocol FTP . Data exchanged over the network may be represented using any suitable format such as hypertext markup language HTML or extensible markup language XML . In some embodiments all or some of the communication links of the network may be encrypted using any suitable technique or techniques.

One or more third party systems may be coupled to the network for communicating with the online system which is further described below in conjunction with . In one embodiment a third party system is an application provider communicating information describing applications for execution by a client device or communicating data to client devices for use by an application executing on the client device . In other embodiments a third party system provides content or other information for presentation via a client device . A third party system may also communicate information to the online system such as advertisements content or information about an application provided by the third party system .

In some embodiments one or more of the third party systems provide content to the online system for presentation to users of the online system and provide compensation to the online system in exchange for presenting the content also referred to herein as sponsored content. For example a third party system provides advertisement requests which are further described below in conjunction with including advertisements for presentation and amounts of compensation provided by the third party system to the online system for presenting the advertisements. Other types of sponsored content may be provided by a third party system to the online system for presentation by the online system in exchange for compensation from the third party system . Sponsored content from a third party system may be associated with the third party system or with an entity on whose behalf the third party system operates.

Each user of the online system is associated with a user profile which is stored in the user profile store . A user profile includes declarative information about the user that was explicitly shared by the user and may also include profile information inferred by the online system . In one embodiment a user profile includes multiple data fields each describing one or more attributes of the corresponding online system user. Examples of information stored in a user profile include biographic demographic and other types of descriptive information such as work experience educational history gender hobbies or preferences location and the like. A user profile may also store other information provided by the user for example images or videos. In certain embodiments images of users may be tagged with information identifying the online system users displayed in an image with information identifying the images in which a user is tagged stored in the user profile of the user. A user profile in the user profile store may also maintain references to actions by the corresponding user performed on content items in the content store and stored in the action log .

While user profiles in the user profile store are frequently associated with individuals allowing individuals to interact with each other via the online system user profiles may also be stored for entities such as businesses or organizations. This allows an entity to establish a presence on the online system for connecting and exchanging content with other online system users. The entity may post information about itself about its products or provide other information to users of the online system using a brand page associated with the entity s user profile. Other users of the online system may connect to the brand page to receive information posted to the brand page or to receive information from the brand page. A user profile associated with the brand page may include information about the entity itself providing users with background or informational data about the entity. In some embodiments the brand page associated with the entity s user profile may retrieve information from one or more user profiles associated with users who have interacted with the brand page or with other content associated with the entity allowing the brand page to include information personalized to a user when presented to the user.

The content store stores objects that each represents various types of content. Examples of content represented by an object include a page post a status update a photograph a video a link a shared content item a gaming application achievement a check in event at a local business a brand page or any other type of content. Online system users may create objects stored by the content store such as status updates photos tagged by users to be associated with other objects in the online system events groups or applications. In some embodiments objects are received from third party applications or third party applications separate from the online system . In one embodiment objects in the content store represent single pieces of content or content items. Hence online system users are encouraged to communicate with each other by posting text and content items of various types of media to the online system through various communication channels. This increases the amount of interaction of users with each other and increases the frequency with which users interact within the online system .

The action logger receives communications about user actions internal to and or external to the online system populating the action log with information about user actions. Examples of actions include adding a connection to another user sending a message to another user uploading an image reading a message from another user viewing content associated with another user and attending an event posted by another user. In addition a number of actions may involve an object and one or more particular users so these actions are associated with the particular users as well and stored in the action log .

The action log may be used by the online system to track user actions on the online system as well as actions on third party systems that communicate information to the online system . Users may interact with various objects on the online system and information describing these interactions is stored in the action log . Examples of interactions with objects include commenting on posts sharing links checking in to physical locations via a client device accessing content items and any other suitable interactions. Additional examples of interactions with objects on the online system that are included in the action log include commenting on a photo album communicating with a user establishing a connection with an object joining an event joining a group creating an event authorizing an application using an application expressing a preference for an object liking the object and engaging in a transaction. Additionally the action log may record a user s interactions with advertisements on the online system as well as with other applications operating on the online system . In some embodiments data from the action log is used to infer interests or preferences of a user augmenting the interests included in the user s user profile and allowing a more complete understanding of user preferences.

In some embodiments the action logger receives communications about user actions with content presented to a user and populates the action log with information about the actions. Examples of interactions with content include viewing content items requesting additional content items for presentation indicating a preference for a content item sharing a content item with another user or performing any other suitable action. A user may interact with content items by providing inputs to a client device presenting content from the online system . The client device identifies actions corresponding to various provided inputs and communicates information describing the identified actions to the action logger which stores the information describing the identified actions in the action log .

The action log may also store user actions taken on a third party system such as an external website and communicated to the online system . For example an e commerce website may recognize a user of an online system through a social plug in enabling the e commerce website to identify the user of the online system . Because users of the online system are uniquely identifiable e commerce websites such as in the preceding example may communicate information about a user s actions outside of the online system to the online system for association with the user. Hence the action log may record information about actions users perform on a third party system including webpage viewing histories advertisements that were engaged purchases made and other patterns from shopping and buying. Additionally actions a user performs via an application associated with a third party system and executing on a client device may be communicated to the action logger by the application for recordation and association with the user in the action log .

In one embodiment the edge store stores information describing connections between users and other objects on the online system as edges. Some edges may be defined by users allowing users to specify their relationships with other users. For example users may generate edges with other users that parallel the users real life relationships such as friends co workers partners and so forth. Other edges are generated when users interact with objects in the online system such as expressing interest in a page on the online system sharing a link with other users of the online system and commenting on posts made by other users of the online system .

In one embodiment an edge may include various features each representing characteristics of interactions between users interactions between users and objects or interactions between objects. For example features included in an edge describe a rate of interaction between two users how recently two users have interacted with each other a rate or an amount of information retrieved by one user about an object a number of comments posted by a user about an object or types of comments posted by a user about an object. The features may also represent information describing a particular object or a particular user. For example a feature may represent a level of interest that a user has in a particular topic a rate at which the user logs into the online system or information describing demographic information about the user. Each feature may be associated with a source object or user a target object or user and a feature value. A feature may be specified as an expression based on values describing the source object or user the target object or user or interactions between the source object or user and the target object or user hence an edge may be represented as one or more feature expressions.

The edge store also stores information about edges such as affinity scores for objects interests and other users. Affinity scores or affinities may be computed by the online system over time to approximate a user s interest in an object or in another user in the online system based on the actions performed by the user. A user s affinity may be computed by the online system over time to approximate the user s interest in an object in a topic or in another user in the online system based on actions performed by the user. Computation of affinity is further described in U.S. patent application Ser. No. 12 978 265 filed on Dec. 23 2010 U.S. patent application Ser. No. 13 690 254 filed on Nov. 30 2012 U.S. patent application Ser. No. 13 689 969 filed on Nov. 30 2012 and U.S. patent application Ser. No. 13 690 088 filed on Nov. 30 2012 each of which is hereby incorporated by reference in its entirety. Multiple interactions between a user and a specific object may be stored as a single edge in the edge store in one embodiment. Alternatively each interaction between a user and a specific object is stored as a separate edge. In some embodiments connections between users may be stored in the user profile store or the user profile store may access the edge store to determine connections between users.

One or more advertisement requests ad requests are included in the ad request store . An ad request includes advertisement content also referred to as an advertisement and a bid amount. The advertisement is text image audio video or any other suitable data presented to a user. In various embodiments the advertisement also includes a landing page specifying a network address to which a user is directed when the advertisement content is accessed. The bid amount is associated with an ad request by an advertiser and is used to determine an expected value such as monetary compensation provided by the advertiser to the online system if an advertisement in the ad request is presented to a user if a user interacts with the advertisement in the ad request when presented to the user or if any suitable condition is satisfied when the advertisement in the ad request is presented to a user. For example the bid amount specifies a monetary amount that the online system receives from the advertiser if an advertisement in an ad request is displayed. In some embodiments the expected value to the online system for presenting the advertisement may be determined by multiplying the bid amount by a probability of the advertisement being accessed by a user.

Additionally an ad request may include one or more targeting criteria specified by the advertiser. Targeting criteria included in an ad request specify one or more characteristics of users eligible to be presented with advertisement content in the ad request. For example targeting criteria are used to identify users associated with user profile information edges or actions satisfying at least one of the targeting criteria. Hence targeting criteria allow an advertiser to identify users having specific characteristics simplifying subsequent distribution of content to different users.

In one embodiment targeting criteria may specify actions or types of connections between a user and another user or object of the online system . Targeting criteria may also specify interactions between a user and objects performed external to the online system such as on a third party system . For example targeting criteria identifies users who have performed a particular action such as having sent a message to another user having used an application having joined or left a group having joined an event having generated an event description having purchased or reviewed a product or service using an online marketplace having requested information from a third party system having installed an application or having performed any other suitable action. Including actions in targeting criteria allows advertisers to further refine users eligible to be presented with advertisement content from an ad request. As another example targeting criteria identifies users having a connection to another user or object or having a particular type of connection to another user or object. For example targeting criteria in an ad request identifies users connected to an entity.

The content selection module selects one or more content items for communication to a client device to be presented to a user. Content items eligible for presentation to the user are retrieved from the content store from the ad request store or from another source by the content selection module which selects one or more of the content items for presentation to the user. A content item eligible for presentation to the user is a content item associated with at least a threshold number of targeting criteria satisfied by characteristics of the user or is a content item that is not associated with targeting criteria. In various embodiments the content selection module includes content items eligible for presentation to the user in one or more selection processes which identify a set of content items for presentation to the user. For example the content selection module determines measures of relevance of various content items to the user based on characteristics associated with the user by the online system and based on the user s affinity for different content items. Information associated with the user included in the user profile store in the action log and in the edge store may be used to determine the measures of relevance. Based on the measures of relevance the content selection module selects content items for presentation to the user. For example the content selection module selects content items having the highest measures of relevance or having at least a threshold measure of relevance for presentation to the user. Alternatively the content selection module ranks content items based on their associated measures of relevance and selects content items having the highest positions in the ranking or having at least a threshold position in the ranking for presentation to the user.

Content items selected for presentation to the user may include advertisements from ad requests or other content items associated with bid amounts. The content selection module uses the bid amounts associated with ad requests when selecting content for presentation to the viewing user. In various embodiments the content selection module determines an expected value associated with various ad requests or other content items based on their bid amounts and selects advertisements from ad requests associated with a maximum expected value or associated with at least a threshold expected value for presentation. An expected value associated with an ad request or with a content item represents an expected amount of compensation received by the online system for presenting an advertisement from the ad request or the content item. For example the expected value associated with an ad request is a product of the ad request s bid amount and a likelihood of the user interacting with the advertisement content from the ad request. The content selection module may rank ad requests based on their associated bid amounts and select advertisements from ad requests having at least a threshold position in the ranking for presentation to the user. In some embodiments the content selection module ranks both content items not associated with bid amounts and ad requests in a unified ranking based on bid amounts associated with ad requests and measures of relevance associated with content items and ad requests. Based on the unified ranking the content selection module selects content for presentation to the user. Selecting ad requests and other content items through a unified ranking is further described in U.S. patent application Ser. No. 13 545 266 filed on Jul. 10 2012 which is hereby incorporated by reference in its entirety.

For example the content selection module receives a request to present a feed of content also referred to as a content feed to a user of the online system . The feed may include one or more advertisements as well as content items such as stories describing actions associated with other online system users connected to the user. The content selection module accesses one or more of the user profile store the content store the action log and the edge store to retrieve information about the user. For example content items or other data associated with users connected to the identified user are retrieved. Additionally one or more ad requests may be retrieved from the ad request store . The retrieved content items or ad requests are analyzed by the content selection module to identify candidate content items that are likely to be relevant to the identified user. For example content items associated with users not connected to the identified user or content items associated with users for which the identified user has less than a threshold affinity are discarded as candidate content items. Based on various criteria the content selection module selects one or more of the candidate content items or ad requests identified as candidate content items for presentation to the identified user. The selected content items or advertisements from selected ad requests are included in a feed of content that is presented to the user. For example the feed of content includes at least a threshold number of content items describing actions associated with users connected to the user via the online system .

In various embodiments the content selection module presents content to a user through a feed including a plurality of content items selected for presentation to the user. One or more advertisements may also be included in the feed. The content selection module may also determine an order in which selected content items or advertisements are presented via the feed. For example the content selection module orders content items or advertisements in the feed based on likelihoods of the user interacting with various content items or advertisements.

In various embodiments the online system allows physical locations to be associated with content items and allows geographic attributes which describe a geographic region including a specific physical location or including a portion of an area surrounding the specific physical location to be associated with users. To allow association of physical locations with users or content items the online system maintains maps representing various geographic areas that are divided into sets of geo tiles. The geo tile store includes stores the geo tiles along with information describing the geo tiles and maps. Each geo tile represents a portion of a map. For example a map representing four square miles of a town is divided into four geo tiles that each represent a one square mile quadrant of the town. The geo tile store may include geo tiles of various sizes. In some embodiments a size of a geo tile is based on a density of objects e.g. buildings streets population etc. included in an area represented by the geo tile. For example each geo tile of a map represents an area of the map having a density of objects that is within a threshold amount of densities of areas of the map represented by other geo tiles of the map. As an example areas of the map including a relatively low number of objects are represented by larger geo tiles while areas of the map including a relatively high number of objects are represented by smaller geo tiles. In other embodiments a map representing a geographic area may be divided into multiple layers of geo tiles with each layer including geo tiles having a particular level of resolution. For example a layer includes small geo tiles representing relatively smaller areas of the map with a relatively higher level of resolution represent and more specifically identify objects within the geo tiles while another layer includes relatively larger geo tiles representing relatively larger areas of the map with a relatively lower level of resolution represent and less specifically identify objects within the geo tiles.

Information describing a geo tile stored in the geo tile store may include one or more of a unique geo tile identifier for the geo tile geographic coordinates of the area represented by the geo tile a size of the geo tile a description of the scale or of the geographic area represented by the geo tile an object density associated with the geo tile a level of specificity with which the geo tiles identifies objects and a description of the geographic area represented by the geo tile. A description of a geographic area represented by a geo tile may identify one or more specific physical locations included in the geo tile e.g. a physical address specific geographic coordinates a landmark and may also identify one or more geographic regions each comprising a specific physical location and a threshold distance from the specific physical location.

As described below in conjunction with the online system for example the content selection module generates indices describing various geographic regions included geo tiles and in various sets of geo tiles. The generated indices are stored in the geo tile store . For example the online system computes a percentage of a city included in each geo tile of a set of geo tiles representing a neighborhood in the city and stores information describing the percentage of the city represented by each geo tile in an index including geo tile identifiers of geo tiles including at least a portion the neighborhood in association with a value indicating a percentage of the city included in a geo tile including at least a portion of the neighborhood in the geo tile store . In various embodiments the content selection module accesses an index from the geo tile store when an opportunity to present a content item associated with a physical location to a user is identified to determine if a the physical location included in the targeting criteria includes at least a threshold portion of a geographic region specified by a geographic attribute associated with the user as further described below in conjunction with .

The web server links the online system via the network to the one or more client devices as well as to the one or more third party systems . The web server serves web pages as well as other content such as JAVA FLASH XML and so forth. The web server may receive and route messages between the online system and the client device for example the messages are instant messages queued messages e.g. email text messages short message service SMS messages or messages sent using any other suitable messaging technique. A user may send a request to the web server to upload information e.g. images or videos that are stored in the content store . Additionally the web server may provide application programming interface API functionality to send data directly to native client device operating systems such as IOS ANDROID or BlackberryOS.

The online system receives a description of a physical location associated with a content item such as an advertisement request ad request or other content item for presentation to users of the online system . The physical location may be described in any suitable manner. For example the physical location associated with the content item is described as a physical address a set of geographic coordinates a name of a landmark a name of neighborhood or any other suitable description of a physical location. In some embodiments the physical location associated with the content item corresponds to a retail location or other location for obtaining a product or a service identified by the content item. For example the online system receives a description of a physical address associated with a content item. The physical location may be included in targeting criteria associated with the content item so users associated with a physical location within a threshold distance from the physical location associated with the content item are eligible to be presented with the content item.

In some embodiments the threshold distance from the physical location associated with the content item is included in the description of the physical location. For example an ad request is associated with a physical location and a threshold distance from the physical location specified by a user providing the ad request to the online system . Alternatively the online system determines the threshold distance from the physical location based on information maintained by the online system . The threshold distance from the physical location identifies a geo fence or boundary from the physical location associated with the content item. Physical locations less than the threshold distance from the physical location associated with the content item are within the geo fence and physical locations greater than the threshold distance from the physical location associated with the content item are outside determined to be outside of the geo fence. The online system determines users who are associated with a physical location within the geo fence of the physical location associated with the content item are eligible to be presented with the content item. A geo fence including a specific physical location may completely include one or more defined geographic regions e.g. neighborhoods communities districts etc. and may include portions of other defined geographic regions e.g. a portions of a neighborhood portions of a town portions of a county .

In the example of the online system receives information describing a physical location which is a specific neighborhood within the city of San Francisco associated with a content item and a geo fence around the physical location specifying a threshold distance of 3 miles from a center of the described physical location . For example is an example of the online system receiving a specific address associated with an ad request along with a threshold distance from the specific address so an advertisement from the ad request is eligible for presentation to users associated with a physical address within the threshold distance from the specific address.

The online system retrieves a map of the physical location associated with the content item. The retrieved map includes the geographic area within the geo fence and accesses a set of geo tiles representing a geographic area within the geo fence. In various embodiments the online system divides the map of the physical location associated with the content item and the geographic area within the geo fence from the physical location associated with the content item into multiple geo tiles that each represent a geographic area within the geo fence. The online system generates a unique geo tile identifier for each geo tile. For example the online system divides a map of a town that is 36 square miles into multiple mutually exclusive geo tiles each including four square miles and including at least a portion of the town the online system also associates a unique geo tile identifier with each of the geo tiles.

In various embodiments different geo tiles have different sizes. For example geo tiles A and B in are different sizes to allow the geo tiles to more accurately represent the geographic area within the geo fence . In some embodiments a size of a geo tile is based on the density of objects e.g. buildings streets population etc. included in a geographic area represented by the geo tile. For example a geo tile includes a density of buildings within a threshold amount of densities of buildings within other geo0tiles in this example geo tiles representing geographic areas including more buildings are smaller than geo tiles representing geographic areas including fewer buildings. Additionally the geographic area including the physical location and the geo fence surrounding the physical location may be represented by multiple layers of geo tiles in some embodiments. Different layers may include geo tiles having different levels of resolution. For example a layer includes small geo tiles representing relatively smaller areas of the map with a relatively higher level of resolution represent and more specifically identify objects within the geo tiles while another layer includes relatively larger geo tiles representing relatively larger areas of the map with a relatively lower level of resolution represent and less specifically identify objects within the geo tiles.

The online system identifies geo tiles in the accessed set of geo tiles that represent at least a portion of a specific geographic region which is a specific physical location and a threshold distance from the specific physical location to determine whether the physical location associated with the content item includes at least a threshold portion of the specific geographic region. For example the online system identifies a set of geo tiles representing geographic areas within a geo fence of the physical location associated with the content item and determines whether the identified set of geo tiles includes at least a threshold portion of the geographic area including the specific physical location. shows a subset of identified geo tiles that represent at least a portion of a specific geographic region which is a specific physical location and a threshold distance from the specific physical location and are within the geo fence of the physical location associated with the content item shown in . For example the subset of identified geo tiles represent a portion of a city i.e. the specific physical location . Geo tiles that do not represent at least a portion of the specific geographic region are not identified by the online system .

For each identified geo tile that represents at least a portion of the specific geographic region the online system determines whether at least a threshold portion of an identified geo tile represents the portion of the specific geographic region. For example the online system computes a portion of an identified geo tile that represents a portion of a city and determines whether the computed portion equals or exceeds a threshold portion. In various embodiments the portion of the identified geo tile representing a portion of the specific geographic region is a percentage of the identified geo tile that represents a portion of the geographic region. For example referring to the online system determines whether at least 50 of each identified geo tile represents a portion of the specific geographic region. In the example of the online system has identified geo tiles in which at least 50 of the geo tiles represent a portion of the specific geographic region and two geo tiles in which less than 50 of the geo tiles represent a portion of the specific geographic region.

Referring back to in response to determining the portion of an identified geo tile representing a portion of the specific geographic region equals or exceeds the threshold portion of identified the geo tile the online system computes a value associated with the identified geo tile and stores the value. For example the online system stores the computed value in association with a geo tile identifier corresponding to the identified geo tile. In various embodiments the value associated with the identified geo tile is based at least in part on the portion of the specific geographic region represented by the identified geo tile. For example the value is a percentage of the specific geographic region represented by the identified geo tile which may be a ratio of an area of the portion of the specific geographic region represented by the identified geo tile to an area of the specific geographic region. In another example the value for the identified geo tile is based in part on information obtained by the online system describing a size of the specific geographic region and a size and location of the identified geo tile in a map maintained by the online system . In another example the value is a number of square miles of the area of the specific geographic region represented by the identified geo tile. In various embodiments the online system computes and stores a computed value for an identified geo tile in an index in association with a geo tile identifier associated with the identified geo tile. The online system may store additional information in the index in association with the geo tile identifier such as and information describing the physical location associated with the content item the geo fence including the physical location associated with the content item and information identifying the specific geographic region. For example the online system computes a value of 0.20 for an identified geo tile representing 20 square miles of a 100 square mile specific geographic region and stores the value in an index along with a geo tile identifier uniquely associated with the identified geo tile and information describing the physical location associated with the content item and describing the specific geographic region.

In response to determining the portion of an identified geo tile representing a portion of the specific geographic region is less than the threshold portion of the geo tile the online system accesses an additional set of geo tiles that collectively represents the same geographic area represented by the identified geo tile. In various embodiments the online system divides the identified geo tile into smaller geo tiles that each represent a portion of the identified geo tile. For example the online system divides a section of a map represented by the identified geo tile into an additional set of geo tiles where each of the additional set of geo tiles represents a smaller area of the map than the area represented by the identified geo tile. In other embodiments rather than dividing the identified geo tile the online system retrieves an additional set of geo tiles each geo tile in the set representing a portion of the identified geo tile. The additional set of geo tiles accessed by the online system may include geo tiles associated with various layers of geo tiles having different object densities resolutions dimensions or any other suitable characteristic. For example the online system accesses an additional set of stored geo tiles representing the section of the map represented by the identified geo tile where each geo tile of the additional set has a lower object density or a higher geo tile resolution than the object density or resolution respectively of the identified geo tile.

Referring again to the example of the online system determines the portion of each identified geo tile representing a portion of the specific geographic region is less than the threshold portion. In response to this determination the online system accesses an additional set of mutually exclusive geo tiles that collectively represent the same geographic area e.g. section of a map including the specific location associated with the content item represented by the two identified geo tiles as illustrated in . In the online system divides the two identified geo tiles into an additional set of geo tiles that when combined represents the same section of the map as represented by the two identified geo tiles . Each geo tile from the additional set of geo tiles represents a smaller geographic area than the geographic area represented by an identified geo tile which was divided into the additional set of geo tiles. In some embodiments a geo tile of the additional set of geo tiles identifies objects within a geographic area represented by the geo tile of the additional set than the identified geo tile divided into the additional set . In some embodiments an identified geo tile is divided so each geo tile in the additional set has a density of objects within a threshold amount of densities of objects of other geo tiles in the set accordingly the additional set may include geo tiles having different sizes as further described above.

As further described above in conjunction with the online system identifies geo tiles of the additional set of geo tiles that represent at least a portion of the specific geographic region and determines whether at least a threshold portion of each of the identified geo tiles from the additional set of geo tiles represents the portion of the specific geographic region as described above in conjunction with . For each identified geo tile of the additional set of geo tiles in which at least a threshold portion of the identified geo tile of the additional set of geo tiles represents a portion of the specific geographic region the online system computes a value associated with the identified geo tile of the additional set of geo tiles and stores the value in association with a geo tile identifier uniquely associated with the identified geo tile of the additional set of geo tiles as further described above in conjunction with . For example referring to the online system identifies geo tiles of the additional set of geo tiles that represent at least a portion of the specific geographic area and determines whether a portion of an identified geo tile of the additional set representing a portion of the specific geographic region equals or exceeds 50 of the identified geo tile. In the example of the online system identifies nine geo tiles from the additional set of geo tiles where at least 50 of the identified geo tile from the additional set represents a portion of the specific geographic area. As further described above in conjunction with the online system computes a value associated with each of the nine identified geo tiles from the additional set and stores a value computed for an identified geo tile from the additional set in association with a geo tile identifier uniquely associated with the identified geo tile from the additional set . In the example of the online system also identifies two geo tiles from the additional set of geo tiles in which less than 50 of the identified geo tile represents a portion of the specific geographic area.

For each identified geo tile of the additional set of geo tiles in which less than the threshold portion of identified the geo tile represents a portion of the specific geographic region the online system accesses another additional set of geo tiles that collectively represents the same geographic area represented by the identified geo tile of the additional set of geo tiles repeats the steps described above until all geo tiles having at least a threshold portion representing a portion of the specific geographic region are identified a value for each geo tile having at least a threshold portion representing a portion of the specific geographic region is computed and the computed values are stored . Hence the online system may compute and store values for geo tiles having various sizes or resolutions representing geographic areas having various sizes or object densities to provide an area of the specific geographic region contained in each identified geo tile.

Based on the stored value associated with each identified geo tile the online system determines a portion of the specific geographic region included in the geo fence surrounding the physical location associated with the content item. In various embodiments the online system determines the portion of the specific geographic region included in the geo fence surrounding the physical location associated with the content item by combining the stored values associated with each identified geo tile representing in which at least a threshold portion of an identified geo tile or an identified geo tile from an additional set or from another additional set . For example if the value stored in association with an identifier for each identified geo tile is a percentage of the specific geographic region represented by each identified geo tile the online system determines a portion of the specific geographic region included in the geo fence surrounding the physical location associated with the content item by combining the percentages associated with the identified geo tiles.

As shown in the index may include additional information associated with geo tiles such as an amount of a geo tile representing a portion of the specific geographic area. Other information may alternatively or additionally be stored in the index such as a description of the physical location associated with the content item e.g. geographic coordinates of the physical location associated with the content item an identifier or a description of the geo fence surrounding the physical location associated with the content item a size e.g. an area of the geo fence surrounding the physical location associated with the content item an identifier of the specific geographic region e.g. physical coordinates describing the specific geographic region an identifier of the specific geographic region an amount of the specific geographic region included in the geo fence surrounding the physical location associated with the content item coordinates of locations in the geo fence surrounding the physical location associated with the content item that represent the specific geographic region or any other suitable information 

Based on the determined portion of the specific geographic region included in the geo fence surrounding the physical location associated with the content item the online system determines whether at least a threshold portion of the specific geographic region is included in the geo fence surrounding the physical location associated with the content item. For example referring to the online system determines whether the 52.7 of the specific geographic area included in the geo fence surrounding the physical location associated with the content item determined as further described above surrounding the physical location associated with the content item equals or exceeds a threshold value. If the threshold value is 50 the 52.7 of the specific geographic area included in the geo fence surrounding the physical location associated with the content item exceeds the threshold value.

In various embodiments if the portion of the specific geographic region included in the geo fence surrounding the physical location associated with the content item equals or exceeds the threshold value the online system associates the specific geographic region with the physical location. Hence users associated with a geographic attribute identifying the specific geographic region are identified by the online system as eligible to be presented with the content item associated with the specific physical location. For example if the online system receives an ad request including targeting criteria specifying an address for a restaurant and a threshold distance from the address for the restaurant and an advertisement the online system associates a particular city having at least the threshold portion of the city within the threshold distance from the address for the restaurant with the ad request. In this example the online system identifies users associated with the particular city e.g. identifying the particular city as a hometown or as a current location as eligible to be presented with the advertisement from the ad request even if the physical location of the users is outside of the threshold distance from the address for the restaurant. Hence in various embodiments one or more particular geographic regions are associated with a physical location so online system users having a geographic attribute specifying a particular geographic region are eligible to be presented with a content item associated with the physical location. For example the online system retrieves one or more geographic attributes associated with a user and includes a content item having targeting criteria specifying a physical address in one or more selection processes for the user if a geographic region described by a geographic attribute associated with the user is associated with the physical address specified by the targeting criteria determined based on an index maintained for the geographic region and for the physical address specified by the targeting criteria as further described above in conjunction with .

Example geographic attributes that may be associated with users and specify a geographic region include a hometown a workplace a birthplace and a current location e.g. a location received from a client device associated with the user . The geographic region may be specified in any suitable format such as a city name a zip code an area code a street address geographic coordinates or any other suitable information. A geographic attribute may be associated with a user by the online system based on information provided to the online system by the user based on information received by the online system from one or more client devices associated with the user from physical locations specified in content provided to the online system by the user or based on any other suitable information.

The foregoing description of the embodiments has been presented for the purpose of illustration it is not intended to be exhaustive or to limit the patent rights to the precise forms disclosed. Persons skilled in the relevant art can appreciate that many modifications and variations are possible in light of the above disclosure.

Some portions of this description describe the embodiments in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

Any of the steps operations or processes described herein may be performed or implemented with one or more hardware or software modules alone or in combination with other devices. In one embodiment a software module is implemented with a computer program product comprising a computer readable medium containing computer program code which can be executed by a computer processor for performing any or all of the steps operations or processes described.

Embodiments may also relate to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes and or it may comprise a general purpose computing device selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a nontransitory tangible computer readable storage medium or any type of media suitable for storing electronic instructions which may be coupled to a computer system bus. Furthermore any computing systems referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.

Embodiments may also relate to a product that is produced by a computing process described herein. Such a product may comprise information resulting from a computing process where the information is stored on a nontransitory tangible computer readable storage medium and may include any embodiment of a computer program product or other data combination described herein.

Finally the language used in the specification has been principally selected for readability and instructional purposes and it may not have been selected to delineate or circumscribe the patent rights. It is therefore intended that the scope of the patent rights be limited not by this detailed description but rather by any claims that issue on an application based hereon. Accordingly the disclosure of the embodiments is intended to be illustrative but not limiting of the scope of the patent rights which is set forth in the following claims.

