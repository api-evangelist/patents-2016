---

title: System, method, and computer-readable medium for mobile-terminated SMS message delivery for a mobile station attached with an IP-femtocell system
abstract: A system, method, and computer readable medium that facilitates delivery of mobile-terminated short message service messages to a mobile station attached with a femtocell system are provided. A convergence server deployed in a core network receives a short message for short message service delivery to a mobile station attached with a femtocell system. If there is no active traffic channel with the mobile station, or if the short message is to be delivered to the mobile station via a paging channel, the femtocell system triggers an authentication process. The convergence server constructs a short message service delivery request message, transmits the short message service delivery request message to the femtocell system, and receives one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station. The convergence server thereafter notifies the message center of the acknowledgment or negative acknowledgement received thereby.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09615253&OS=09615253&RS=09615253
owner: Open Invention Network, LLC
number: 09615253
owner_city: Durham
owner_country: US
publication_date: 20160915
---
The present invention is generally related to radio access technologies and more particularly to mechanisms for facilitating mobile station registration and authentication via a femtocell system.

This application is a continuation of U.S. Ser. No. 14 800 975 filed Jul. 16 2015 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR MOBILE TERMINATED SMS MESSAGE DELIVERY FOR A MOBILE STATION ATTACHED WITH AN IP FEMTOCELL SYSTEM issued as U.S. Pat. No. 9 451 463 on Sep. 20 2016 which is a continuation of U.S. Ser. No. 12 605 528 filed Oct. 26 2009 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR MOBILE TERMINATED SMS MESSAGE DELIVERY FOR A MOBILE STATION ATTACHED WITH AN IP FEMTOCELL SYSTEM issued as U.S. Pat. No. 9 107 051 on Aug. 11 2015 which is a continuation in part of U.S. Ser. No. 12 252 231 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR PROCESSING CALL ORIGINATIONS BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 194 590 on Jun. 5 2012 which is a continuation in part of U.S. Ser. No. 12 252 238 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR SHORT MESSAGE SERVICE PROCESSING BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 792 920 on Jul. 29 2014 which is a continuation in part of U.S. Ser. No. 12 252 246 filed on Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR USER EQUIPMENT REGISTRATION AND AUTHENTICATION PROCESSING BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 351 901 on Jan. 8 2013 the disclosures of each of which are incorporated herein by reference and each of which claims priority to U.S. provisional patent application Ser. No. 61 003 151 entitled SIP IOS adapter function filed Nov. 15 2007 the disclosure of which is incorporated herein by reference. Incorporated by reference is commonly assigned U.S. Ser. No. 12 252 237 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR CALL TERMINATION PROCESSING BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 700 094 on Apr. 15 2014 and U.S. Ser. No. 12 252 242 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR SHORT MESSAGE SERVICE TERMINATION PROCESSING BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 351 963 on Jan. 8 2013 and U.S. Ser. No. 12 252 199 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR IP FEMTOCELL PROVISIONED RADIO ACCESS NETWORK issued as U.S. Pat. No. 8 103 274 on Jan. 24 2012 and U.S. Ser. No. 12 252 202 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR USER EQUIPMENT HANDOFF WITHIN AN IP FEMTOCELL NETWORK issued as U.S. Pat. No. 8 532 054 on Sep. 10 2013 and U.S. Ser. No. 12 252 204 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR USER EQUIPMENT ACQUISITION OF AN IP FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 938 244 on Jan. 20 2015 and U.S. Ser. No. 12 252 210 filed Oct. 15 12008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR USER EQUIPMENT HANDOFF FROM A MACROCELLULAR NETWORK TO AN IP FEMTOCELL NETWORK issued as U.S. Pat. No. 8 848 655 on Sep. 30 2014 and U.S. Ser. No. 12 252 212 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR CONFIGURATION OF AN IP FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 995 997 on Mar. 31 2015 and U.S. Ser. No. 12 252 217 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR MOBILE TO MOBILE CALLS WITHIN FEMTOCELL NETWORK issued as U.S. Pat. No. 8 224 291 on Jul. 17 2012 and U.S. Ser. No. 12 252 222 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR ACCESS RESTRICTION OF USER EQUIPMENT DEVICES IN AN IP FEMTOCELL SYSTEM and U.S. Ser. No. 12 252 226 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR ABBREVIATED CODE DIALING IN A NETWORK SYSTEM issued as U.S. Pat. No. 8 346 216 on Jan. 1 2013 and U.S. Ser. No. 12 252 227 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR MULTI STAGE TRANSMIT PROTECTION IN A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 532 026 on Sep. 10 2013 and U.S. Ser. No. 12 252 234 filed Oct. 15 2008 entitled SYSTEM METHOD AND COMPUTER READABLE MEDIUM FOR MOBILE TERMINATED CALL PROCESSING BY A FEMTOCELL SYSTEM issued as U.S. Pat. No. 8 059 585 on Nov. 15 2011.

Contemporary cellular radio systems or mobile telecommunication systems provide an over the air interface to wireless mobile stations MSs also referred to as user equipments UEs via a radio access network RAN that interfaces with at least one core network. The RAN may be implemented as for example a CDMA2000 RAN a Universal Mobile Telecommunications System UMTS RAN a Global System for Mobile communications GSM RAN or another suitable radio access network implementation. The MSs may comprise for example a mobile terminal such as a mobile telephone a laptop computer featuring mobile telephony software and hardware a personal digital assistant PDA or other suitable equipment adapted to transfer and receive voice or data communications with the radio access network.

A RAN covers a geographical area comprised of any number of cells each comprising a relatively small geographic area of radio coverage. Each cell is provisioned by a cell site that includes a radio tower e.g. a base transceiver station BTS and associated equipment. BTSs communicate with MSs over an air interface within radio range of the BTSs.

Numerous BTSs in the RAN may be communicatively coupled to a base station controller BSC also commonly referred to as a radio network controller RNC . The BSC manages and monitors various system activities of the BTSs serviced thereby. BSCs are typically coupled with at least one core network.

BTSs are typically deployed by a carrier network in areas having a high population density. The traffic capacity of a cell site is limited by the site s capacity and affects the spacing of cell sites. In suburban areas sites are often up to two miles apart while cell sites deployed in dense urban areas may be as close as one quarter of a mile apart. Because the traffic capacity of a cell site is finitely limited as is the available frequency spectrum mobile operators have a vested interest in technologies that allow for increased subscriber capacity.

A microcell site comprises a cell in a mobile phone network that covers a limited geographic area such as a shopping center hotel airport or other infrastructure that may have a high density mobile phone usage. A microcell typically uses power control to limit the radius of the microcell coverage. Typically a microcell is less than a mile wide.

Although microcells are effective for adding network capacity in areas with high mobile telephone usage microcells extensively rely on the RAN e.g. a controlling BSC and other carrier functions. Because contemporary BSCs have limited processing and interface capacity the number of BTSs whether microcell BTSs or typical carrier BTSs able to be supported by the BSC or other RAN functions is disadvantageously limited.

Contemporary interest exists in providing enterprise and office access including small office home office SOHO radio access by an even smaller scale BTS. The radio coverage area of such a system is typically referred to as a femtocell. In a system featuring a femtocell an MS may be authorized to operate in the femtocell when proximate the femtocell system e.g. while the MS is located in the SOHO. When the MS moves beyond the coverage area of the femtocell the MS may then be serviced by the carrier network. The advantages of deployment of femtocells are numerous. For instance mobile users frequently spend large amounts of time located at for example home and many such users rely extensively on cellular network service for telecommunication services during these times. For example a recent survey indicated that nearly thirteen percent of U.S. cell phone customers do not have a landline telephone and rely solely on cell phones for receiving telephone service. From a carrier perspective it would be advantageous to have telephone services provisioned over a femtocell system e.g. deployed in the user s home to thereby reduce the load and effectively increase the capacity on the carrier RAN infrastructure. However no mechanisms have been provided for efficiently providing a convergence of femtocell and macrocellular systems in a manner that facilitates delivery of mobile terminated short message service SMS messages for a mobile station attached with a femtocell system.

In accordance with disclosed embodiments mechanisms that facilitate delivery of mobile terminated short message service SMS messages to a mobile station attached with a femtocell system are provided. A convergence server deployed in a core network receives a short message for short message service delivery to a mobile station attached with a femtocell system. If there is no active traffic channel to the mobile station or if the short message is to be delivered to the mobile station via a paging channel the femtocell system triggers an authentication process. The convergence server constructs a short message service delivery request message transmits the short message service delivery request message to the femtocell system and receives one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station. The convergence server thereafter notifies the message center of the acknowledgment or negative acknowledgement received thereby.

In accordance with an embodiment a method of facilitating mobile terminated short message delivery to a mobile station attached with a femtocell system is provided. The method includes receiving by a convergence server deployed in a core network a short message for short message service delivery to a mobile station attached with a femtocell system constructing by the convergence server a short message service delivery request message transmitting by the convergence server the short message service delivery request message to the femtocell system receiving by the convergence server one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station and notifying by the convergence server a mobile core network of the acknowledgment or negative acknowledgement received by the convergence server.

In accordance with another embodiment a computer readable medium having computer executable instructions tangibly embodied thereon for execution by a processing system the computer executable instructions for facilitating mobile terminated short message delivery to a mobile station attached with a femtocell system is provided. The computer readable medium includes instructions that when executed cause the processing system to notify by a convergence server deployed in a core network a message center that a mobile station attached with a femtocell system has become available for delivery of a short message receive by the convergence server the short message for short message service delivery to the mobile station construct by the convergence server a short message service delivery request message transmit by the convergence server the short message service delivery request message to the femtocell system receive by the convergence server one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station and notify by the convergence server a mobile core network of the acknowledgment or negative acknowledgement received by the convergence server.

In accordance with another embodiment a network system that facilitates mobile terminated short message delivery to a mobile station attached with a femtocell system is provided. The system includes a core network that includes a convergence server a mobile core network that includes a message center and an Internet Protocol based femtocell system that provides a radio access point for a mobile station. The convergence server receives a short message for short message service delivery to the mobile station attached with the femtocell system constructs a short message service delivery request message and transmits the short message service delivery request message to the femtocell system. The femtocell system attempts to transmit the short message to the mobile station by one of a traffic channel and a paging channel. The convergence server receives one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station and notifies the mobile core network of the acknowledgment or negative acknowledgement.

It is to be understood that the following disclosure provides many different embodiments or examples for implementing different features of various embodiments. Specific examples of components and arrangements are described below to simplify the present disclosure. These are of course merely examples and are not intended to be limiting.

Cellular network may include any number of base transceiver stations BTSs communicatively coupled with a base station controller BSC or RNC. Each individual BTS under the control of a given BSC may define a radio cell operating on a set of radio channels thereby providing service to an MS such as a mobile terminal. BSC manages the allocation of radio channels receives measurements from mobile terminals controls handovers as well as various other functions as is understood. BSC is interconnected with a Mobile Switching Center MSC that provides mobile terminal exchange services. BSC may be additionally coupled with a packet data serving node PDSN or other gateway service that provides a connection point between the CDMA radio access network and a packet network such as Internet and provides mobility management functions and packet routing services. MSC may communicatively interface with a circuit switched network such as the public switched telephone network PSTN and may additionally be communicatively coupled with an interworking function IWF that provides an interface between cellular network and PSTN .

System may also include a signaling system such as a signaling system 7 SS7 network . SS7 network provides a set of telephony signaling protocols which are used to set up the vast majority of the world s PSTN telephone calls. SS7 network is also used in cellular networks for circuit switched voice and packet switched data applications. As is understood SS7 network includes various signaling nodes such as any number of service control points SCPs signal transfer points STPs and service switching points SSPs .

BTSs deployed in cellular network may service numerous network subscribers. Cell cites provided by BTSs commonly feature site ranges of a quarter to a half mile e.g. in densely populated urban areas to one to two miles in suburban areas. In other remotely populated regions with suitable geography site ranges may span tens of miles and may be effectively limited in size by the limited transmission distance of relatively low powered MSs. As referred to herein a cell provided by a BTS deployed in carrier network for access by any authorized network subscriber is referred to as a macrocell.

BSC may additionally connect with a tunnel gateway system that is adapted to establish secured tunnels with respective femtocell systems . Femtocells comprise cellular access points that connect to a mobile operator s network using for example a residential Digital Subscriber Line DSL or cable broadband connection. Femtocells provide a radio access point for MS when the MS is within range of a femtocell system with which the MS has authorized access. For example femtocell system may be deployed in a residence of the user of MS . Accordingly when the user is within the residence mobile telecommunications may be provided to MS via an air interface provided by femtocell system . In this instance MS is effectively offloaded from the macro BTS e.g. BTS and communications to and from the MS are carried out with femtocell system over Internet . Thus femtocell systems may reduce the carrier radio resource demands by offloading MSs from macrocells to femtocells and thereby provide for increased subscriber capacity of cellular network .

In contemporary implementations such as that depicted in a femtocell system comprises a transceiver without intelligence and is thus required to be connected and managed by BSC . Thus femtocell systems are reliant on the carrier network centralized BSC which has limited capacity and thus does not exhibit desirable scaling characteristics or capabilities. Moreover high communications overhead are realized by the BTS backhaul.

System includes an Internet Protocol IP core network that interfaces with the SS7 network e.g. via IS 41. In accordance with an embodiment the IP core network includes a convergence server CS a softswitch Media Gateway Controller Function MGCF and a Media Gateway MGW among other components. The CS may be communicatively coupled with the SS7 network and a Packet Data Interworking Function PDIF e.g. via Session Initiation Protocol SIP communications. The CS provides SIP registration functions and a central interface point to Voice over Internet Protocol VoIP elements and the softswitch MGCF . The CS further provides SIP MSC and Interworking functions between existing VoIP network elements and the operator s core network. To this end the CS may interface directly with the MC and the HLR using for example a TIA 41 interface.

The softswitch MGCF may be communicatively coupled with the CS e.g. via SIP communications with the SS7 network and with the MGW . The softswitch MGCF may connect calls from one device to another and perform call control protocol conversion for example between SIP and ISDN User Part ISUP . The MGW may be communicatively coupled with the SS7 network and the PDIF in addition to the softswitch MGCF . The MGW may convert data between real time transport protocol RTP and pulse code modulation PCM and may also be employed for transcoding. Resources of the MGW may be controlled by the softswitch MGCF .

In accordance with an embodiment the system may include a Security Server SS that interfaces with the SS7 network e.g. via IS 41 and the PDIF e.g. via a Wm interface. The PDIF facilitates access to the IP core network via WiFi access points and may be responsible for such services as for example security access authentication policy enforcement user information collection and IP address allocation as well as other services. The PDIF may interface e.g. via SIP communications with the CS and may have Real time Transport Protocol RTP communications with the MGW . Further the PDIF may have secured IP communications e.g. IPsec established with one or more femtocell systems e.g. a femtocell system deployed at a user premise such as a home office. The secured communications may be established between the PDIF and the femtocell system over for example a broadband network interface such as a residential DSL or cable broadband connection. The femtocell system in turn provides a radio access point for one or more MSs when the MS is within range of the femtocell system with which the MS has authorized access.

In accordance with an embodiment a femtocell system may include integrated BTS and BSC functions and may feature additional capabilities available in the provided femtocell site coverage area. Femtocell system provides an IP accessible radio access network is adapted for operation with IP core network and provides radio link control functions. Femtocell system may be communicatively coupled with broadband network via any variety of backhaul technologies such as an 802.11x link a 10 100 BaseT LAN link a T1 E1 Span or fiber cable set top box DSL modem connected with a central office digital subscriber line access multiplexer a very small aperture terminal VSAT or another suitable backhaul infrastructure.

In an embodiment femtocell system includes a session initiation protocol SIP adapter that supports a SIP client pool and provides conversion of call set up functions to SIP client set up functions. To this end the femtocell system may be allocated an IP address. Additionally femtocell system includes electronic serial number ESN screening and or Mobile Equipment Identifier MEID screening to allow only designated MSs to access the femtocell. Configuration of the femtocell system with ESN s or MEID s may be made as part of an initial femtocell system activation.

In another embodiment a femtocell system may be implemented as a 3G compliant entity e.g. to service UMTS mobile terminals and may be deployed in a small office home office SOHO or other suitable enterprise. To this end the femtocell system may include an integrated RNC and radio node RN . In a particular implementation the femtocell system may be implemented as an Evolution Data Optimized EV DO entity e.g. a 1 EV DO integrated IP RAN. The femtocell system provides an IP accessible radio access network and provides radio link control functions.

System includes an IP Multimedia Subsystem IMS core network that interfaces with the SS7 network . In accordance with an embodiment the IMS core network includes a CS a MGCF an MGW an X Call Session Control Function X CSCF and a Home Subscriber Server HSS among other components. The X CSCF processes SIP signaling packets and provides a centralized interface for control and signaling including SIP registration functions in accordance with disclosed embodiments. The X CSCF may provide Interrogating CSCF I CSCF services Proxy CSCF P CSCF services and Serving CSCF S CSCF services. The X CSCF comprises various SIP servers or proxies that process SIP signaling packets in the IMS core network . P CSCF services provided by X CSCF may include provisioning a first point of contact for an IMS compliant MS. In such a situation the X CSCF may be located in a visited network or in an MS s home network if the visited network is not fully IMS compliant. An MS may discover the X CSCF e.g. by using Dynamic Host Configuration Protocol DHCP or by assignment in a packet data protocol context. S CSCF services provided by the X CSCF include provisioning as a central node of the signaling plane. To this end the S CSCF comprises a SIP server but additionally performs session control. Further the X CSCF is interfaced with the HSS and or HLR to download and upload user profiles for providing S CSCF services. The X CSCF further includes a SIP function for providing I CSCF services. To this end the X CSCF has an IP address that is published in the Domain Name System DNS that facilitates location of the X CSCF by remote servers. Thus I CSCF services of the X CSCF may be used as a forwarding point for receipt of SIP packets within the domain.

The CS may be configured to operate as an IMS application server that interfaces with the X CSCF using the ISC interface. The HSS comprises a user database that supports IMS network entities that manage or service calls. The HSS contains subscription related information e.g. subscriber profiles may perform authentication and authorization of users and may provide information about locations of MSs and IP information. In a fully standard IMS architecture the CS may interface with the HSS . However in other scenarios the HLR may anchor the service even with the HSS deployed within the system . Accordingly the CS may be communicatively interfaced with the HLR for location updates using for example a TIA 41 interface. Further the CS is preferably interfaced with the MC using for example a TIA 41 interface.

The CS may be communicatively coupled with the SS7 network the MGCF e.g. via SIP communications the X CSCF e.g. via ISC and the HSS e.g. via an Sh interface. The MGCF may be communicatively coupled with the MGW e.g. via an Mn interface the X CSCF e.g. via an Mg interface and the SS7 network in addition to the CS . The MGW may be communicatively coupled with the SS7 network and a PDIF in addition to the MGCF . The MGW may convert data between RTP and PCM and may also be employed for transcoding. Resources of the MGW may be controlled by the MGCF . The X CSCF may be communicatively coupled with the PDIF for exchanging SIP communications therewith and the HSS e.g. via a Cx interface in addition to the CS and the MGCF . The HSS may be communicatively coupled with the SS7 network e.g. via IS 41 and a SS e.g. via a Wx interface. The SS may be coupled with the PDIF e.g. via a Wm interface.

The PDIF facilitates access to the IMS core network via WiFi access points and may be responsible for such services as for example security access authentication policy enforcement user information collection and IP address allocation as well as other services. The PDIF may have RTP communications with the MGW . Further the PDIF may have secured IP communications e.g. IPsec established with one or more femtocell systems e.g. a femtocell system deployed at a user premise such as a home office. The secured communications may be established between the PDIF and the femtocell system over for example a broadband network interface such as residential DSL or cable broadband connection. The femtocell system in turn provides a radio access point for one or more MSs when the MS is within range of the femtocell system with which the MS has authorized access.

Femtocell system includes an electronic serial number screening function that may facilitate approving or rejecting service for an MS by femtocell system . Additionally femtocell system includes an Internet Operating System IOS and SIP Adapter collectively referred to as IOS SIP Adapter . IOS SIP adapter may invoke and manage SIP clients such as a user agent UA pool comprising one or more UAs. Each MS authorized to be serviced by femtocell system may have a UA allocated therefor by femtocell system in a manner that facilitates transmission of communications to and from an MS over an IP backhaul. Accordingly when an authorized MS is within the femtocell system site range telecommunication services may be provided to the MS via the IP backhaul and the femtocell system provisioned RAN. When the MS is moved beyond the service range of femtocell system telecommunication service may then be provided to the MS via macrocellular coverage. Femtocell system may perform a DNS ENUM registration on behalf of MSs authorized to obtain service from femtocell system and may generate and issue a SIP registration on behalf of an MS authorized for service access by the femtocell system .

Peripheral component interconnect PCI bus bridge connected to I O bus provides an interface to PCI local bus . A number of modems may be connected to a PCI local bus . Communication links to clients may be provided through a modem and network adapter connected to PCI local bus through add in connectors.

Additional PCI bus bridges and provide interfaces for additional PCI local buses and from which additional modems or network adapters may be supported. In this manner server allows connections to multiple system nodes. A memory mapped graphics adapter and hard disk may also be connected to I O bus as depicted either directly or indirectly.

Those of ordinary skill in the art will appreciate that the hardware depicted in may vary. For example other peripheral devices such as optical disk drives and the like also may be used in addition to or in place of the hardware depicted. The depicted example is not meant to imply architectural limitations with respect to the present invention.

While the CS depicted in comprises an SMP system it should be understood that any variety of server configurations and implementations may be substituted therefor. The depicted server is provided only to facilitate an understanding of disclosed embodiments and the configuration of the CS is immaterial with regard to the disclosed embodiments.

In many CDMA networks a subscriber is uniquely identified by the combination of an electronic serial number ESN and a mobile identification number MIN . A mobile equipment identifier MEID is an extension of the ESN that facilitates an increase in the number of manufacturers codes. A pseudo ESN p ESN may be derived from the MEID to be used in place of the ESN. The MIN ESN or MIN p ESN combination is used primarily for registration and authentication functions. Contemporary CDMA MSs may support an international mobile station identity IMSI and use the IMSI in place of the MIN to offer an improved address space and utilization by international applications. With the introduction of IMSI the concept of a mobile station identity may be either an MIN or an IMSI. Due to the variations in different parameters for identification it is assumed herein that a unique identifier is included in the username portion of the To Header of a SIP REGISTER request to create and identify the mobile station subscriber during the registration procedures described hereinbelow. This unique identifier is referred to herein as the register ID RegID . An optional network dependent predefined prefix may be stripped from the register ID prior to use in the convergence server functions. The register ID may contain an MIN or an IMSI paired with either an MEID an ESN or a p ESN. However other options may be suitably implemented without departing from the disclosed embodiments.

In accordance with an embodiment the CS emulates the functionality of a MSC and Visitor Location Register VLR to facilitate authentication and registration of MSs in a carrier s CDMA network. To this end the CS may interface with the HLR for authentication location updates and other services using an IS 41 interface.

In a pre IMS environment e.g. such as network system depicted in the CS receives a SIP REGISTER message directly from the femtocell system or from the femtocell system acting as a proxy for the MS . The CS provides SIP registration functions and is the central interface point to the softswitch MGCF and VoIP elements.

In an IMS network such as network system depicted in the CS functions as an IMS application server and the IMS infrastructure provides the centralized interface control and signaling including SIP registration functions. In this environment the femtocell system itself or alternatively the femtocell system acting as a proxy for the MS sends a SIP REGISTER e.g. via other CSCFs to the S CSCF which performs a third party registration of the MS with the CS based on initial filter criteria stored in the HSS .

In an embodiment the femtocell system may be configured to support Global Challenge based authentication on all system access e.g. Registration Call Origination Call Termination and Data Burst messages . The femtocell system may indicate a Global Challenge request by setting an authentication bit e.g. AUTH 1 in the overhead message train OMT . The femtocell system may also include a global random challenge value RAND used in generating the authentication result by both the MS and the HLR AC.

The femtocell system preferably establishes an IPsec tunnel over the broadband network with the PDIF or alternatively a P CSCF before sending any SIP traffic to the CS . The IPsec tunnel may be established immediately after the femtocell system is powered on or when an MS attempts to establish a connection with the femtocell system . In this implementation the CS is not involved in establishing the IPsec tunnel.

In an embodiment the CS may be configured to receive CDMA 1 authentication data at the end of a SIP registration message using a SIP MESSAGE received from the femtocell system . In this manner the CS conveys the result of the 1 authentication and if needed performs various authentication procedures such as a unique challenge SSD update and a call history count.

Based on the values in the OMT the MS determines that a new serving system has been encountered and that authentication is required based on the authentication bit value AUTH 1 . Subsequently the MS attempts to obtain the random number RAND to be used for the authentication from the OMT. If the random number is not available a zero value may be used by the MS as prescribed by TR 45 authentication procedures. The MS then generates an authentication result AUTHR . For example the MS may generate an authentication result from a shared secret data key SSD A stored by the MS the ESN or p ESN the MIN and the RAND value obtained from the OMT. The authentication result may be generated for example by execution of the well known CAVE algorithm by the MS . The MS then transmits a registration request to the femtocell system step . The register message may include the MS s MIN ESN or p ESN the authentication result AUTHR a CallHistoryCount COUNT and a random confirmation RANDC derived from the random number RAND used to compute the authentication result AUTHR .

On receiving the registration request from the MS the femtocell system sends a SIP REGISTER message to the CS step in accordance with an embodiment that includes the unique register ID associated with the MS e.g. derived from an MIN or an IMSI paired with either an MEID an ESN or a p ESN.

Optionally the femtocell system may establish an IPsec tunnel with the PDIF . The CS then acknowledges receipt of the SIP REGISTER message by transmitting a 200 OK SIP response to the femtocell system step .

A registration phase is then invoked by the femtocell system transmitting 1 authentication parameters received from the MS at step to CS in a SIP MESSAGE LOCATION UPDATING REQUEST step . The location updating request message includes the random number RAND rather than the random number confirmation RANDC . The location updating request message additionally may include parameters such as a Register ID ESN MEID MIN IMSI etc. Using the Register ID the CS may associate the location updating request with the preceding SIP REGISTER request received thereby from the femtocell system in step . If the location updating request message includes a P Access Network Info PANI header that may specify information about the access technology the CS may save the PANI information.

The CS acknowledges receipt of the location updating request message by transmitting a 200 OK SIP response to the femtocell system step . Network authentication and registration then occurs via exchanges between the CS and HLR AC step . As part of the authentication response the HLR AC may trigger Unique Challenge SSD update or CountUpdate procedures.

The CS informs the femtocell system of the authentication and registration results by transmitting a SIP location updating response message to the femtocell system step . In the event of an authentication or registration failure the CS may send a SIP MESSAGE containing for example an XML encoded message body that facilitates deregistration of the femtocell system . The femtocell system acknowledges receipt of the authentication and registration results by sending a 200 OK SIP response to the CS step . In the event of either a registration or authentication failure a deregistration process is invoked by the femtocell system transmitting a deregistration message e.g. a SIP REGISTER message with an expire value to the CS step . The CS acknowledges receipt of the deregistration message by transmitting a 200 OK SIP response to the femtocell system step .

The femtocell system transmits an OMT step at a predefined interval. An MS in idle mode may detect the OMT when the MS is within range of the femtocell system as described above with reference to . The OMT transmitted by the femtocell system may include an authentication bit AUTH having a value e.g. 1 that indicates authentication is required for all system access and a random number RAND generated by the femtocell system . On receipt of the OMT the MS determines that a new serving system has been encountered and that authentication is required based on the authentication bit value AUTH 1 . Subsequently the MS attempts to obtain the random number RAND to be used for the authentication from the OMT. If the random number is not available a zero value may be used by the MS as prescribed by TR 45 authentication procedures. The MS then generates an authentication result AUTHR and transmits a registration request to the femtocell system step . The registration message may include the MS s MIN ESN or p ESN the authentication result AUTHR a CallHistoryCount COUNT and a random number confirmation RANDC derived from the random number RAND used to compute the authentication result AUTHR .

An IMS registration phase is then initiated by the femtocell system sending a registration request to the S CSCF step . The S CSCF then sends a 3rd party registration request to the CS step and the CS returns a 200 OK SIP response to the S CSCF step for the 3rd party registration which completes the IMS network registration.

If the registration fails the CS informs the femtocell system to perform IMS network deregistration. Assuming the registration is successful an authentication process is then invoked by the femtocell system transmitting 1 authentication parameters received from the MS at step to CS in a SIP MESSAGE LOCATION UPDATING REQUEST step . The location updating request message includes the random number RAND rather than the random number confirmation RANDC . The location updating request message additionally may include parameters such as a Register ID ESN MEID MIN IMSI etc. If the location updating request message includes a P Access Network Info PANI header that may specify information about the access technology the CS saves the PANI information.

The CS acknowledges receipt of the location updating request message by transmitting a 200 OK SIP response to the femtocell system step . Network authentication and registration then occurs via exchanges between the CS and HLR AC step . As part of the authentication response the HLR AC may trigger Unique Challenge SSD update or CountUpdate procedures.

The CS informs the femtocell system of the authentication and registration results by transmitting a SIP location updating response message to the femtocell system step . In the event of an authentication or registration failure the CS may send a SIP MESSAGE containing for example an XML encoded message body that facilitates deregistration of the femtocell system . The femtocell system acknowledges receipt of the authentication and registration results by sending a 200 OK SIP response to the CS step .

In the event of either a registration or authentication failure a deregistration process is invoked by the femtocell system transmitting a deregistration message e.g. a SIP REGISTER message with a expire value to the S CSCF step . The S CSCF acknowledges receipt of the deregistration message by transmitting a 200 OK SIP response to the femtocell system step . The S CSCF then transmits the deregistration message to the CS step which acknowledges receipt of the deregistration message by transmitting a 200 OK SIP response to the S CSCF step thereby completing deregistration of the MS.

The CS may receive a SIP REGISTER message for a subscriber who is not currently SIP registered but for whom the CS maintains subscription data from the HLR. For example the CS may maintain the HLR subscription information for a configurable period after a SIP deregistration. In this scenario a MS re registration procedure may be invoked. The re registration may be consistent with that as described above with reference to except the CS is not required to request the user profile from the HLR.

Periodic registration is optionally required in mobile networks. If periodic registration is enabled the HLR may return an Authorization Period in response to a Registration Notification REGNOT . In this case the CS may send a SIP MESSAGE ORDERED REGISTRATION REQUEST before the Authorization Period expires. On receiving this request the femtocell system may send the ordered registration request to the MS to send registration related parameters.

Regardless of an Authorization Period timer the SIP registration period dictates the interval at which the SIP registration from the femtocell system needs to be refreshed. In such a case the femtocell system needs to refresh the registration prior to the expiration period while the MS is attached to the femtocell system . Such registration procedures are preferably processed locally at the CS . The femtocell system sends a SIP REGISTER message to the CS and the CS returns a SIP 200 OK response to the femtocell system .

When deregistration occurs e.g. either due to registration timeout or mobile initiated network deregistration the CS may typically not delete HLR subscriber data which is eligible to be aged out or removed by a REGCANC message. The CS may send a mobile station inactive MSINACT message to the HLR with the optional DeregistrationType parameter omitted which indicates that subscriber data is still being maintained by the CS . Such a situation may occur for example due to the MS being powered off and it is desirable to have the subscription data available when the MS is powered back on. However the time the MS was last registered is maintained with the subscription data.

If the MS does not re register for a configurable time e.g. 24 hours the subscriber data may be deleted and an MSINACT message is sent to the HLR with the DeregistrationType set to administrative reason indicating that the subscriber data has been purged from the CS . This may also occur as needed to free up space in the database thereby deleting the oldest data first based on when it was last accessed.

A mobile initiated de registration process may be invoked when the CS receives a SIP REGISTER from the femtocell system with a timeout of zero for a current registration. In an IMS network the CS may receive this message from the S CSCF as a 3rd party SIP REGISTER message. For example such a de registration may occur when the femtocell system receives a power down indication from the MS the femtocell system detects MS inactivity or the femtocell system detects a loss of radio contact.

Deregistration may additionally occur due to location updating. When the MS registers in a macrocell the HLR preferably notifies the CS accordingly. If the SIP registration for the corresponding MS is currently active the CS may send a SIP MESSAGE Deregister to the femtocell system requesting it to deregister. Registration cancellation may additionally occur due to administrative reasons as well. In such a case the MS may be in a call or using some network service. If the cancellation indicates that service is to be discontinued immediately the CS terminates any call in progress.

In accordance with disclosed embodiments mechanisms that facilitate mobile terminated short messages service SMS message delivery for a mobile station attached with a femtocell system are provided. As is understood SMS supports the transmission and reception of simple messages. SMS may support various types of services. For example an SMS bearer service may comprise a basic transport mechanism to convey an SMS message with a length up to 200 octets as a packet of data between two points or short message entities SMEs on the network. SMS teleservices may provide flexible custom applications for communication between SMS users i.e. SMEs . These services require two functional entities in addition to those used for basic mobile telecommunications. The message center MC e.g. MC provides a store and forward function for most mobile originated short messages and for all mobile terminated short messages. MS based SMEs are associated with an MC known as the home MC in the MS s home system. In the described embodiments it is assumed that the mobile core network comprises the MS s home carrier network and thus the MC comprises the MS s home and destination MC. A short message entity e.g. a mobile station a personal digital assistant PDA or any other suitable data processing system adapted to communicatively interface with the femtocell system and the mobile core network depicted in and further adapted to process SMS messages comprises a functional entity capable of composing and decomposing a short message.

In an embodiment the CS does not perform authentication validation of the MS credentials and instead the femtocell system performs the MS credentials authentication validation if required. If there is no active traffic channel to the MS the femtocell system triggers an authentication process block . If an active traffic channel is already established between the MS and the femtocell system or if the femtocell system elects to transmit the SMS message to the MS via a paging channel the steps of block are not executed.

If there is no active traffic channel to the MS and the paging channel is not to be used for SMS message delivery the femtocell system sends a paging request to the MS step . As part of the paging procedure authentication may be performed in accordance with steps . The MS replies by sending a page response to the femtocell system along with authentication parameters e.g. the Authentication Result AUTHR the CallHistoryCount COUNT and the RANDC calculated from the RAND used to compute the Authentication Result AUTHR step . The femtocell system then forwards the page response with the authentication parameters to the CS in for example the body of a SIP MESSAGE PAGING AUTH REQUEST step . In case of a paging failure the femtocell system sends a SIP MESSAGE SMD NAK which is forwarded by the CS to the MC as a negative acknowledgement in the smdpp result with an appropriate SMS CauseCode. The CS responds to the femtocell system with a SIP 200 OK message step . The CS then engages the destination MC in an authentication process step . The CS then forwards the authentication result to the femtocell using a SIP MESSAGE GLOBAL CHALLENGE RESPONSE step and the femtocell system responds with a SIP 200 OK message step .

If paging is not required or if the femtocell system receives a successful authentication result in step the femtocell system then proceeds with a message delivery sequence. To this end the femtocell system sends the SMS message SMD REQ to the MS on for example a control or traffic channel step . In the event of a successful SMS message delivery block the MS formats and sends an SMD ACK to the femtocell system to acknowledge successful receipt of the mobile terminated short message step . The femtocell system sends the SMD ACK as binary encoded data in the body of a SIP MESSAGE to the CS step which in turn sends a SIP 202 ACCEPTED message to the femtocell system to acknowledge receipt of the SMD ACK step . The CS sends a positive acknowledgement in an smdpp result to the destination home MC step .

In the event of a message delivery failure block the MS formats and sends an SMD NAK to the femtocell system step which sends the SMD NAK as binary encoded data in the body of a SIP MESSAGE to the CS step . The CS then sends a SIP 200 OK response to the femtocell system to acknowledge receipt of the SMD NAK step and sends a negative acknowledgement which includes an SMS CauseCode in a smdpp result to the destination MC step .

The paging authentication request message is transmitted from the femtocell system to authenticate the MS before delivery of a mobile terminated short message. The femtocell system preferably includes a 32 bit message identifier in a paging authentication request message ID field to correlate the request and the response s . When a global challenge results in a unique challenge SSD update and or count update the CS will include the same message in those transactions. The femtocell system preferably invokes a maximum timer for response to the paging authentication request message. For example the femtocell system may invoke the timer after receiving the 200 OK response from the CS for the paging authentication request transmitted to the CS. The timer may be stopped when the global challenge response is received by the femtocell system according to step of . If the paging authentication request results in an SSD update a unique challenge and or a count update the timeout may be increased accordingly.

The paging authentication request message preferably includes a random number field that includes the random number RAND used for authentication an authentication result field that includes the authentication result AUTHR and a count field .

The global challenge response message is transmitted from the CS to the femtocell system in response to a service request and paging authentication request to convey the global challenge authentication result authentication token and the encryption information CDMAPrivateLongCodeMask CDMAPLCM SignalingMessage EncryptionKey SMEKEY and VoicePrivacyMask VPMASK received from the AC. To this end the global challenge response message may include a global challenge response message ID field a successful authentication field that includes an identifier e.g. a Boolean value that specifies whether the authentication was successful and an authentication token field that includes the authentication token. Further the global challenge response message may include a CDMAPLCM field that includes the CDMA private long code mask a SMEKEY field that includes the signaling message encryption key and a VPMASK field that includes the voice privacy mask in the event of a successful authentication.

As described mechanisms that facilitate delivery of mobile terminated short message service messages to a mobile station attached with a femtocell system are provided. A convergence server deployed in a core network receives a short message for short message service delivery to a mobile station attached with a femtocell system. If there is no active traffic channel to the MS or if the short message is to be delivered to the mobile station via a paging channel the femtocell system triggers an authentication process. The convergence server constructs a short message service delivery request message transmits the short message service delivery request message to the femtocell system and receives one of an acknowledgement and a negative acknowledgment regarding delivery of the short message to the mobile station. The convergence server thereafter notifies the message center of the acknowledgment or negative acknowledgement received thereby.

The illustrative block diagrams depict process steps or blocks that may represent modules segments or portions of code that include one or more executable instructions for implementing specific logical functions or steps in the process. Although the particular examples illustrate specific process steps or procedures many alternative implementations are possible and may be made by simple design choice. Some process steps may be executed in different order from the specific description herein based on for example considerations of function purpose conformance to standard legacy structure user interface design and the like.

Aspects of the present invention may be implemented in software hardware firmware or a combination thereof. The various elements of the system either individually or in combination may be implemented as a computer program product tangibly embodied in a machine readable storage device for execution by a processing unit. Various steps of embodiments of the invention may be performed by a computer processor executing a program tangibly embodied on a computer readable medium to perform functions by operating on input and generating output. The computer readable medium may be for example a memory a transportable medium such as a compact disk a floppy disk or a diskette such that a computer program embodying the aspects of the present invention can be loaded onto a computer. The computer program is not limited to any particular embodiment and may for example be implemented in an operating system application program foreground or background process driver network stack or any combination thereof executing on a single processor or multiple processors. Additionally various steps of embodiments of the invention may provide one or more data structures generated produced received or otherwise implemented on a computer readable medium such as a memory.

Although embodiments of the present invention have been illustrated in the accompanied drawings and described in the foregoing description it will be understood that the invention is not limited to the embodiments disclosed but is capable of numerous rearrangements modifications and substitutions without departing from the spirit of the invention as set forth and defined by the following claims. For example the capabilities of the invention can be performed fully and or partially by one or more of the blocks modules processors or memories. Also these capabilities may be performed in the current manner or in a distributed manner and on or via any device able to provide and or receive information. Further although depicted in a particular manner various modules or blocks may be repositioned without departing from the scope of the current invention. Still further although depicted in a particular manner a greater or lesser number of modules and connections can be utilized with the present invention in order to accomplish the present invention to provide additional known features to the present invention and or to make the present invention more efficient. Also the information sent between various modules can be sent between the modules via at least one of a data network the Internet an Internet Protocol network a wireless source and a wired source and via plurality of protocols.

