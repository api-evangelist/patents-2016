---

title: 3D pointing devices and methods
abstract: Systems and methods according to the present invention address these needs and others by providing a handheld device, e.g., a 3D pointing device, which uses at least one sensor to detect motion of the handheld device. The detected motion can then be mapped into a desired output, e.g., cursor movement.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09575570&OS=09575570&RS=09575570
owner: HILLCREST LABORATORIES, INC.
number: 09575570
owner_city: Rockville
owner_country: US
publication_date: 20160211
---
This application is a continuation of U.S. application Ser. No. 11 820 525 filed Jun. 20 2007 which is a divisional application of U.S. patent application Ser. No. 11 119 663 filed May 2 2005 now U.S. Pat. No. 7 239 301 which is related to and claims priority from U.S. Provisional Patent Application Ser. No. 60 566 444 filed on Apr. 30 2004 entitled Freespace Pointing Device the disclosure of which is incorporated here by reference. This application is also related to and claims priority from U.S. Provisional Patent Application Ser. No. 60 612 571 filed on Sep. 23 2004 entitled Free Space Pointing Devices and Methods the disclosure of which is incorporated here by reference. This application is also related to and claims priority from U.S. Provisional Patent Application Ser. No. 60 641 383 filed on Jan. 5 2005 entitled Methods and Devices for Removing Unintentional Movement in Free Space Pointing Devices the disclosure of which is incorporated here by reference. This application is also related to and claims priority from U.S. Provisional Patent Application Ser. No. 60 641 410 filed on Jan. 5 2005 entitled Freespace Pointing Devices and Methods for Using Same the disclosure of which is incorporated here by reference. This application is also related to and claims priority from U.S. Provisional Patent Application Ser. No. 60 641 405 filed on Jan. 5 2005 entitled Handheld Remote Control Device the disclosure of which is incorporated here by reference. This application is also related to U.S. patent application Ser. Nos. 11 119 987 11 119 719 and 11 119 688 entitled Methods and Devices for Removing Unintentional Movement in 3D Pointing Devices 3D Pointing Devices with Orientation Compensation and Improved Usability Methods and Devices for Identifying Users Based on Tremor all of which were filed concurrently with U.S. application Ser. No. 11 119 663 filed May 2 2005 and all of which are incorporated here by reference.

The present invention describes three dimensional hereinafter 3D pointing techniques systems and devices as well as some techniques and devices which are usable in other types of handheld devices.

Technologies associated with the communication of information have evolved rapidly over the last several decades. Television cellular telephony the Internet and optical communication techniques to name just a few things combine to inundate consumers with available information and entertainment options. Taking television as an example the last three decades have seen the introduction of cable television service satellite television service pay per view movies and video on demand. Whereas television viewers of the 1960s could typically receive perhaps four or five over the air TV channels on their television sets today s TV watchers have the opportunity to select from hundreds thousands and potentially millions of channels of shows and information. Video on demand technology currently used primarily in hotels and the like provides the potential for in home entertainment selection from among thousands of movie titles.

The technological ability to provide so much information and content to end users provides both opportunities and challenges to system designers and service providers. One challenge is that while end users typically prefer having more choices rather than fewer this preference is counterweighted by their desire that the selection process be both fast and simple. Unfortunately the development of the systems and interfaces by which end users access media items has resulted in selection processes which are neither fast nor simple. Consider again the example of television programs. When television was in its infancy determining which program to watch was a relatively simple process primarily due to the small number of choices. One would consult a printed guide which was formatted for example as series of columns and rows which showed the correspondence between 1 nearby television channels 2 programs being transmitted on those channels and 3 date and time. The television was tuned to the desired channel by adjusting a tuner knob and the viewer watched the selected program. Later remote control devices were introduced that permitted viewers to tune the television from a distance. This addition to the user television interface created the phenomenon known as channel surfing whereby a viewer could rapidly view short segments being broadcast on a number of channels to quickly learn what programs were available at any given time.

Despite the fact that the number of channels and amount of viewable content has dramatically increased the generally available user interface control device options and frameworks for televisions has not changed much over the last 30 years. Printed guides are still the most prevalent mechanism for conveying programming information. The multiple button remote control with up and down arrows is still the most prevalent channel content selection mechanism. The reaction of those who design and implement the TV user interface to the increase in available media content has been a straightforward extension of the existing selection procedures and interface objects. Thus the number of rows in the printed guides has been increased to accommodate more channels. The number of buttons on the remote control devices has been increased to support additional functionality and content handling e.g. as shown in . However this approach has significantly increased both the time required for a viewer to review the available information and the complexity of actions required to implement a selection. Arguably the cumbersome nature of the existing interface has hampered commercial implementation of some services e.g. video on demand since consumers are resistant to new services that will add complexity to an interface that they view as already too slow and complex.

In addition to increases in bandwidth and content the user interface bottleneck problem is being exacerbated by the aggregation of technologies. Consumers are reacting positively to having the option of buying integrated systems rather than a number of segregable components. An example of this trend is the combination television VCR DVD in which three previously independent components are frequently sold today as an integrated unit. This trend is likely to continue potentially with an end result that most if not all of the communication devices currently found in the household will be packaged together as an integrated unit e.g. a television VCR DVD internet access radio stereo unit. Even those who continue to buy separate components will likely desire seamless control of and interworking between the separate components. With this increased aggregation comes the potential for more complexity in the user interface. For example when so called universal remote units were introduced e.g. to combine the functionality of TV remote units and VCR remote units the number of buttons on these universal remote units was typically more than the number of buttons on either the TV remote unit or VCR remote unit individually. This added number of buttons and functionality makes it very difficult to control anything but the simplest aspects of a TV or VCR without hunting for exactly the right button on the remote. Many times these universal remotes do not provide enough buttons to access many levels of control or features unique to certain TVs. In these cases the original device remote unit is still needed and the original hassle of handling multiple remotes remains due to user interface issues arising from the complexity of aggregation. Some remote units have addressed this problem by adding soft buttons that can be programmed with the expert commands. These soft buttons sometimes have accompanying LCD displays to indicate their action. These too have the flaw that they are difficult to use without looking away from the TV to the remote control. Yet another flaw in these remote units is the use of modes in an attempt to reduce the number of buttons. In these moded universal remote units a special button exists to select whether the remote should communicate with the TV DVD player cable set top box VCR etc. This causes many usability issues including sending commands to the wrong device forcing the user to look at the remote to make sure that it is in the right mode and it does not provide any simplification to the integration of multiple devices. The most advanced of these universal remote units provide some integration by allowing the user to program sequences of commands to multiple devices into the remote. This is such a difficult task that many users hire professional installers to program their universal remote units.

Some attempts have also been made to modernize the screen interface between end users and media systems. However these attempts typically suffer from among other drawbacks an inability to easily scale between large collections of media items and small collections of media items. For example interfaces which rely on lists of items may work well for small collections of media items but are tedious to browse for large collections of media items. Interfaces which rely on hierarchical navigation e.g. tree structures may be speedier to traverse than list interfaces for large collections of media items but are not readily adaptable to small collections of media items. Additionally users tend to lose interest in selection processes wherein the user has to move through three or more layers in a tree structure. For all of these cases current remote units make this selection processor even more tedious by forcing the user to repeatedly depress the up and down buttons to navigate the list or hierarchies. When selection skipping controls are available such as page up and page down the user usually has to look at the remote to find these special buttons or be trained to know that they even exist. Accordingly organizing frameworks techniques and systems which simplify the control and screen interface between users and media systems as well as accelerate the selection process while at the same time permitting service providers to take advantage of the increases in available bandwidth to end user equipment by facilitating the supply of a large number of media items and new services to the user have been proposed in U.S. patent application Ser. No. 10 768 432 filed on Jan. 30 2004 entitled A Control Framework with a Zoomable Graphical User Interface for Organizing Selecting and Launching Media Items the disclosure of which is incorporated here by reference.

Of particular interest for this specification are the remote devices usable to interact with such frameworks as well as other applications and systems. As mentioned in the above incorporated application various different types of remote devices can be used with such frameworks including for example trackballs mouse type pointing devices light pens etc. However another category of remote devices which can be used with such frameworks and other applications is 3D pointing devices. The phrase 3D pointing is used in this specification to refer to the ability of an input device to move in three or more dimensions in the air in front of e.g. a display screen and the corresponding ability of the user interface to translate those motions directly into user interface commands e.g. movement of a cursor on the display screen. The transfer of data between the 3D pointing device may be performed wirelessly or via a wire connecting the 3D pointing device to another device. Thus 3D pointing differs from e.g. conventional computer mouse pointing techniques which use a surface e.g. a desk surface or mousepad as a proxy surface from which relative movement of the mouse is translated into cursor movement on the computer display screen. An example of a 3D pointing device can be found in U.S. Pat. No. 5 440 326.

The 326 patent describes among other things a vertical gyroscope adapted for use as a pointing device for controlling the position of a cursor on the display of a computer. A motor at the core of the gyroscope is suspended by two pairs of orthogonal gimbals from a hand held controller device and nominally oriented with its spin axis vertical by a pendulous device. Electro optical shaft angle encoders sense the orientation of a hand held controller device as it is manipulated by a user and the resulting electrical output is converted into a format usable by a computer to control the movement of a cursor on the screen of the computer display.

However there is significant room for improvement in the area of handheld device design generally and 3D pointer design more specifically.

Systems and methods according to the present invention address these needs and others by providing a handheld device e.g. a 3D pointing device which uses at least one sensor to detect motion of the handheld device. The detected motion can then be mapped into a desired output e.g. cursor movement.

According to an exemplary embodiment of the present invention a pointing device includes a first rotational sensor for determining rotation of the pointing device about a first axis and generating a first rotational output associated therewith a second rotational sensor for determining rotation of the pointing device about a second axis and generating a second rotational output associated therewith an accelerometer for determining an acceleration of the pointing device and outputting an acceleration output associated therewith and a processing unit for modifying the first and second rotational outputs based on the acceleration and for generating an output based on the modified first and second rotational outputs.

According to another exemplary embodiment of the present invention a method for controlling a 3D pointing includes the steps of detecting a lack of movement associated with the 3D pointing device and placing the 3D pointing device into a reduced power state as a result of the detecting step.

According to yet another exemplary embodiment of the present invention a method for controlling a system includes the steps of detecting movement associated with a device determining if the movement indicates that the device is currently being held by a user and controlling the system based on a result of the determining step.

The following detailed description of the invention refers to the accompanying drawings. The same reference numbers in different drawings identify the same or similar elements. Also the following detailed description does not limit the invention. Instead the scope of the invention is defined by the appended claims.

In order to provide some context for this discussion an exemplary aggregated media system in which the present invention can be implemented will first be described with respect to . Those skilled in the art will appreciate however that the present invention is not restricted to implementation in this type of media system and that more or fewer components can be included therein. Therein an input output I O bus connects the system components in the media system together. The I O bus represents any of a number of different of mechanisms and techniques for routing signals between the media system components. For example the I O bus may include an appropriate number of independent audio patch cables that route audio signals coaxial cables that route video signals two wire serial lines or infrared or radio frequency transceivers that route control signals optical fiber or any other routing mechanisms that route other types of signals.

In this exemplary embodiment the media system includes a television monitor a video cassette recorder VCR digital video disk DVD recorder playback device audio video tuner and compact disk player coupled to the I O bus . The VCR DVD and compact disk player may be single disk or single cassette devices or alternatively may be multiple disk or multiple cassette devices. They may be independent units or integrated together. In addition the media system includes a microphone speaker system video camera and a wireless I O control device . According to exemplary embodiments of the present invention the wireless I O control device is a 3D pointing device according to one of the exemplary embodiments described below. The wireless I O control device can communicate with the entertainment system using e.g. an IR or RF transmitter or transceiver. Alternatively the I O control device can be connected to the entertainment system via a wire.

The entertainment system also includes a system controller . According to one exemplary embodiment of the present invention the system controller operates to store and display entertainment system data available from a plurality of entertainment system data sources and to control a wide variety of features associated with each of the system components. As shown in system controller is coupled either directly or indirectly to each of the system components as necessary through I O bus . In one exemplary embodiment in addition to or in place of I O bus system controller is configured with a wireless communication transmitter or transceiver which is capable of communicating with the system components via IR signals or RF signals. Regardless of the control medium the system controller is configured to control the media components of the media system via a graphical user interface described below.

As further illustrated in media system may be configured to receive media items from various media sources and service providers. In this exemplary embodiment media system receives media input from and optionally sends information to any or all of the following sources cable broadcast satellite broadcast e.g. via a satellite dish very high frequency VHF or ultra high frequency UHF radio frequency communication of the broadcast television networks e.g. via an aerial antenna telephone network and cable modem or another source of Internet content . Those skilled in the art will appreciate that the media components and media sources illustrated and described with respect to are purely exemplary and that media system may include more or fewer of both. For example other types of inputs to the system include AM FM radio and satellite radio.

More details regarding this exemplary entertainment system and frameworks associated therewith can be found in the above incorporated by reference U.S. patent application A Control Framework with a Zoomable Graphical User Interface for Organizing Selecting and Launching Media Items . Alternatively remote devices in accordance with the present invention can be used in conjunction with other systems for example computer systems including e.g. a display a processor and a memory system or with various other systems and applications.

As mentioned in the Background section remote devices which operate as 3D pointers are of particular interest for the present specification. Such devices enable the translation of movement e.g. gestures into commands to a user interface. An exemplary 3D pointing device is depicted in . Therein user movement of the 3D pointing can be defined for example in terms of a combination of x axis attitude roll y axis elevation pitch and or z axis heading yaw motion of the 3D pointing device . In addition some exemplary embodiments of the present invention can also measure linear movement of the 3D pointing device along the x y and z axes to generate cursor movement or other user interface commands. In the exemplary embodiment of the 3D pointing device includes two buttons and as well as a scroll wheel although other exemplary embodiments will include other physical configurations. According to exemplary embodiments of the present invention it is anticipated that 3D pointing devices will be held by a user in front of a display and that motion of the 3D pointing device will be translated by the 3D pointing device into output which is usable to interact with the information displayed on display e.g. to move the cursor on the display . For example rotation of the 3D pointing device about the y axis can be sensed by the 3D pointing device and translated into an output usable by the system to move cursor along the yaxis of the display . Likewise rotation of the 3D pointing device about the z axis can be sensed by the 3D pointing device and translated into an output usable by the system to move cursor along the xaxis of the display . It will be appreciated that the output of 3D pointing device can be used to interact with the display in a number of ways other than or in addition to cursor movement for example it can control cursor fading volume or media transport play pause fast forward and rewind . Input commands may include operations in addition to cursor movement for example a zoom in or zoom out on a particular region of a display. A cursor may or may not be visible. Similarly rotation of the 3D pointing device sensed about the x axis of 3D pointing device can be used in addition to or as an alternative to y axis and or z axis rotation to provide input to a user interface.

According to one exemplary embodiment of the present invention two rotational sensors and and one accelerometer can be employed as sensors in 3D pointing device as shown in . The rotational sensors and can for example be implemented using ADXRS150 or ADXRS401 sensors made by Analog Devices. It will be appreciated by those skilled in the art that other types of rotational sensors can be employed as rotational sensors and and that the ADXRS150 and ADXRS401 are purely used as an illustrative example. Unlike traditional gyroscopes these rotational sensors use MEMS technology to provide a resonating mass which is attached to a frame so that it can resonate only along one direction. The resonating mass is displaced when the body to which the sensor is affixed is rotated around the sensor s sensing axis. This displacement can be measured using the Coriolis acceleration effect to determine an angular velocity associated with rotation along the sensing axis. If the rotational sensors and have a single sensing axis as for example the ADXRS150s then they can be mounted in the 3D pointing device such that their sensing axes are aligned with the rotations to be measured. For this exemplary embodiment of the present invention this means that rotational sensor is mounted such that its sensing axis is parallel to the y axis and that rotational sensor is mounted such that its sensing axis is parallel to the z axis as shown in . Note however that aligning the sensing axes of the rotational sensors and parallel to the desired measurement axes is not required since exemplary embodiments of the present invention also provide techniques for compensating for offset between axes.

One challenge faced in implementing exemplary 3D pointing devices in accordance with the present invention is to employ components e.g. rotational sensors and which are not too costly while at the same time providing a high degree of correlation between movement of the 3D pointing device a user s expectation regarding how the user interface will react to that particular movement of the 3D pointing device and actual user interface performance in response to that movement. For example if the 3D pointing device is not moving the user will likely expect that the cursor ought not to be drifting across the screen. Likewise if the user rotates the 3D pointing device purely around the y axis she or he would likely not expect to see the resulting cursor movement on display contain any significant xaxis component. To achieve these and other aspects of exemplary embodiments of the present invention various measurements and calculations are performed by the handheld device which are used to adjust the outputs of one or more of the sensors and and or as part of the input used by a processor to determine an appropriate output for the user interface based on the outputs of the sensors and . These measurements and calculations are used to compensate for factors which fall broadly into two categories 1 factors which are intrinsic to the 3D pointing device e.g. errors associated with the particular sensors and used in the device or the way in which the sensors are mounted in the device and 2 factors which are not intrinsic to the 3D pointing device but are instead associated with the manner in which a user is using the 3D pointing device e.g. linear acceleration tilt and tremor. Exemplary techniques for handling each of these effects are described below.

A process model which describes the general operation of 3D pointing devices according to exemplary embodiments of the present invention is illustrated in . The rotational sensors and as well as the accelerometer produce analog signals which are sampled periodically e.g. 200 samples second. For the purposes of this discussion a set of these inputs shall be referred to using the notation x y z y z wherein x y z are the sampled output values of the exemplary three axis accelerometer which are associated with acceleration of the 3D pointing device in the x axis y axis and z axis directions respectively y is a the sampled output value from rotational sensor associated with the rotation of the 3D pointing device about the y axis and z is the sampled output value from rotational sensor associated with rotation of the 3D pointing device about the z axis.

The output from the accelerometer is provided and if the accelerometer provides analog output then the output is sampled and digitized by an A D converter not shown to generate sampled accelerometer output . The sampled output values are converted from raw units to units of acceleration e.g. gravities g as indicated by conversion function . The acceleration calibration block provides the values used for the conversion function . This calibration of the accelerometer output can include for example compensation for one or more of scale offset and axis misalignment error associated with the accelerometer . Exemplary conversions for the accelerometer data can be performed using the following equation . 1 wherein M is a 3 1 column vector composed of the sampled output values x y z P is a 3 1 column vector of sensor offsets and S is a 3 3 matrix that contains both scale axis misalignment and sensor rotation compensation. G T is a gain factor that is a function of temperature. The operator represents matrix multiplication and the . operator represents element multiplication. The exemplary accelerometer has an exemplary full range of 2 g. Sensor offset P refers to the sensor output M for an accelerometer measurement of 0 g. Scale refers to the conversion factor between the sampled unit value and g. The actual scale of any given accelerometer sensor may deviate from these nominal scale values due to e.g. manufacturing variances. Accordingly the scale factor in the equations above will be proportional to this deviation.

Accelerometer scale and offset deviations can be measured by for example applying 1 g of force along one an axis and measuring the result R1. Then a 1 g force is applied resulting in measurement R2. The individual axis scale s and the individual axis offset p can be computed as follows 1 2 2 2 1 2 2 3 In this simple case P is the column vector of the p for each axis and S is the diagonal matrix of the 1 s for each axis.

However in addition to scale and offset readings generated by accelerometer may also suffer from cross axes effects. Cross axes effects include non aligned axes e.g. wherein one or more of the sensing axes of the accelerometer as it is mounted in the 3D pointing device are not aligned with the corresponding axis in the inertial frame of reference or mechanical errors associated with the machining of the accelerometer itself e.g. wherein even though the axes are properly aligned a purely y axis acceleration force may result in a sensor reading along the z axis of the accelerometer . Both of these effects can also be measured and added to the calibration performed by function .

The accelerometer serves several purposes in exemplary 3D pointing devices according to exemplary embodiments of the present invention. For example if rotational sensors and are implemented using the exemplary Coriolis effect rotational sensors described above then the output of the rotational sensors and will vary based on the linear acceleration experienced by each rotational sensor. Thus one exemplary use of the accelerometer is to compensate for fluctuations in the readings generated by the rotational sensors and which are caused by variances in linear acceleration. This can be accomplished by multiplying the converted accelerometer readings by a gain matrix and subtracting or adding the results from or to the corresponding sampled rotational sensor data . For example the sampled rotational data y from rotational sensor can be compensated for linear acceleration at block as 4 wherein C is the 1 3 row vector of rotational sensor susceptibility to linear acceleration along each axis given in units g and A is the calibrated linear acceleration. Similarly linear acceleration compensation for the sampled rotational data z from rotational sensor can be provided at block . The gain matrices C vary between rotational sensors due to manufacturing differences. C may be computed using the average value for many rotational sensors or it may be custom computed for each rotational sensor.

Like the accelerometer data the sampled rotational data is then converted from a sampled unit value into a value associated with a rate of angular rotation e.g. radians s at function . This conversion step can also include calibration provided by function to compensate the sampled rotational data for e.g. scale and offset. Conversion calibration for both y and z can be accomplished using for example the following equation rad offset scale Offset 5 wherein refers to the value being converted calibrated offset T refers to an offset value associated with temperature scale refers to the conversion factor between the sampled unit value and rad s and dOffset refers to a dynamic offset value. Equation 5 may be implemented as a matrix equation in which case all variables are vectors except for scale. In matrix equation form scale corrects for axis misalignment and rotational offset factors. Each of these variables is discussed in more detail below.

The offset values offset T and dOffset can be determined in a number of different ways. When the 3D pointing device is not being rotated in for example the y axis direction the sensor should output its offset value. However the offset can be highly affected by temperature so this offset value will likely vary. Offset temperature calibration may be performed at the factory in which case the value s for offset T can be preprogrammed into the handheld device or alternatively offset temperature calibration may also be learned dynamically during the lifetime of the device. To accomplish dynamic offset compensation an input from a temperature sensor is used in rotation calibration function to compute the current value for offset T . The offset T parameter removes the majority of offset bias from the sensor readings. However negating nearly all cursor drift at zero movement can be useful for producing a high performance pointing device. Therefore the additional factor dOffset can be computed dynamically while the 3D pointing device is in use. The stationary detection function determines when the handheld is most likely stationary and when the offset should be recomputed. Exemplary techniques for implementing stationary detection function as well as other uses therefore are described below.

An exemplary implementation of dOffset computation employs calibrated sensor outputs which are low pass filtered. The stationary output detection function provides an indication to rotation calibration function to trigger computation of for example the mean of the low pass filter output. The stationary output detection function can also control when the newly computed mean is factored into the existing value for dOffset. Those skilled in the art will recognize that a multitude of different techniques can be used for computing the new value for dOffset from the existing value of dOffset and the new mean including but not limited to simple averaging low pass filtering and Kalman filtering. Additionally those skilled in the art will recognize that numerous variations for offset compensation of the rotational sensors and can be employed. For example the offset T function can have a constant value e.g. invariant with temperature more than two offset compensation values can be used and or only a single offset value can be computed used for offset compensation.

After conversion calibration at block the inputs from the rotational sensors and can be further processed to rotate those inputs into an inertial frame of reference i.e. to compensate for tilt associated with the manner in which the user is holding the 3D pointing device at function . Tilt correction is another significant aspect of some exemplary embodiments of the present invention as it is intended to compensate for differences in usage patterns of 3D pointing devices according to the present invention. More specifically tilt correction according to exemplary embodiments of the present invention is intended to compensate for the fact that users will hold pointing devices in their hands at different x axis rotational positions but that the sensing axes of the rotational sensors and in the 3D pointing devices are fixed. It is desirable that cursor translation across display is substantially insensitive to the way in which the user grips the 3D pointing device e.g. rotating the 3D pointing device back and forth in a manner generally corresponding to the horizontal dimension x axis of the display should result in cursor translation along the x axis while rotating the 3D pointing device up and down in a manner generally corresponding to the vertical dimension y axis of the display should result in cursor translation along the y axis regardless of the orientation in which the user is holding the 3D pointing device .

To better understand the need for tilt compensation according to exemplary embodiments of the present invention consider the example shown in . Therein the user is holding 3D pointing device in an exemplary inertial frame of reference which can be defined as having an x axis rotational value of 0 degrees. The inertial frame of reference can purely as an example correspond to the orientation illustrated in or it can be defined as any other orientation. Rotation of the 3D pointing device in either the y axis or z axis directions will be sensed by rotational sensors and respectively. For example rotation of the 3D pointing device around the z axis by an amount z as shown in will result in a corresponding cursor translation xin the xaxis dimension across the display i.e. the distance between the dotted version of cursor and the undotted version .

If on the other hand the user holds the 3D pointing device in a different orientation e.g. with some amount of x axis rotation relative to the inertial frame of reference then the information provided by the sensors and would not absent tilt compensation provide an accurate representation of the user s intended interface actions. For example referring to consider a situation wherein the user holds the 3D pointing device with an x axis rotation of 45 degrees relative to the exemplary inertial frame of reference as illustrated in . Assuming the same z axis rotation z by a user the cursor will instead be translated in both the x axis direction and the y axis direction by as shown in . This is due to the fact that the sensing axis of rotational sensor is now oriented between the y axis and the z axis because of the orientation of the device in the user s hand . Similarly the sensing axis of the rotational sensor is also oriented between the y axis and the z axis although in a different quadrant . In order to provide an interface which is transparent to the user in terms of how the 3D pointing device is held tilt compensation according to exemplary embodiments of the present invention translates the readings output from rotational sensors and back into the inertial frame of reference as part of processing the readings from these sensors into information indicative of rotational motion of the 3D pointing device .

According to exemplary embodiments of the present invention returning to this can be accomplished by determining the tilt of the 3D pointing device using the inputs y and z received from accelerometer at function . More specifically after the acceleration data is converted and calibrated as described above it can be low pass filtered at LPF to provide an average acceleration gravity value to the tilt determination function . Then tilt can be calculated in function as 

Once the calibrated sensor readings have been compensated for linear acceleration processed into readings indicative of angular rotation of the 3D pointing device and compensated for tilt post processing can be performed at blocks and . Exemplary post processing can include compensation for various factors such as human tremor. Although tremor may be removed using several different methods one way to remove tremor is by using hysteresis. The angular velocity produced by rotation function is integrated to produce an angular position. Hysteresis of a calibrated magnitude is then applied to the angular position. The derivative is taken of the output of the hysteresis block to again yield an angular velocity. The resulting output is then scaled at function e.g. based on the sampling period and used to generate a result within the interface e.g. movement of a cursor on a display .

Having provided a process description of exemplary 3D pointing devices according to the present invention illustrates an exemplary hardware architecture. Therein a processor communicates with other elements of the 3D pointing device including a scroll wheel JTAG LEDs switch matrix IR photodetector rotational sensors accelerometer and transceiver . The scroll wheel is an optional input component which enables a user to provide input to the interface by rotating the scroll wheel clockwise or counterclockwise. JTAG provides the programming and debugging interface to the processor. LEDs provide visual feedback to a user for example when a button is pressed. Switch matrix receives inputs e.g. indications that a button on the 3D pointing device has been depressed or released that are then passed on to processor . The optional IR photodetector can be provided to enable the exemplary 3D pointing device to learn IR codes from other remote controls. Rotational sensors provide readings to processor regarding e.g. the y axis and z axis rotation of the 3D pointing device as described above. Accelerometer provides readings to processor regarding the linear acceleration of the 3D pointing device which can be used as described above e.g. to perform tilt compensation and to compensate for errors which linear acceleration introduces into the rotational readings generated by rotational sensors . Transceiver is used to communicate information to and from 3D pointing device e.g. to the system controller or to a processor associated with a computer. The transceiver can be a wireless transceiver e.g. operating in accordance with the Bluetooth standards for short range wireless communication or an infrared transceiver. Alternatively 3D pointing device can communicate with systems via a wireline connection.

In the exemplary embodiment of the 3D pointing device includes two rotational sensors and as well as an accelerometer . However according to another exemplary embodiment of the present invention a 3D pointing device can alternatively include just one rotational sensor e.g. for measuring angular velocity in the z axis direction and an accelerometer. For such an exemplary embodiment similar functionality to that described above can be provided by using the accelerometer to determine the angular velocity along the axis which is not sensed by the rotational sensor. For example rotational velocity around the y axis can be computed using data generated by the accelerometer and calculating 

Stationary detection function mentioned briefly above can operate to determine whether the 3D pointing device is for example either stationary or active moving . This categorization can be performed in a number of different ways. One way according to an exemplary embodiment of the present invention is to compute the variance of the sampled input data of all inputs x y z y z over a predetermined window e.g. every quarter of a second. This variance is then compared with a threshold to classify the 3D pointing device as either stationary or active.

Another stationary detection technique according to exemplary embodiments of the present invention involves transforming the inputs into the frequency domain by e.g. performing a Fast Fourier Transform FFT on the input data. Then the data can be analyzed using e.g. peak detection methods to determine if the 3D pointing device is either stationary or active. Additionally a third category can be distinguished specifically the case where a user is holding the 3D pointing device but is not moving it also referred to herein as the stable state. This third category can be distinguished from stationary not held and active by detecting the small movement of the 3D pointing device introduced by a user s hand tremor when the 3D pointing device is being held by a user. Peak detection can also be used by stationary detection function to make this determination. Peaks within the range of human tremor frequencies e.g. nominally 8 12 Hz will typically exceed the noise floor of the device experienced when the device is stationary and not held by approximately 20 dB.

In the foregoing examples the variances in the frequency domain were sensed within a particular frequency range however the actual frequency range to be monitored and used to characterize the status of the 3D pointing device may vary. For example the nominal tremor frequency range may shift based on e.g. the ergonomics and weight of the 3D pointing device e.g. from 8 12 Hz to 4 7 Hz.

According to another exemplary embodiment of the present invention stationary detection mechanism can include a state machine. An exemplary state machine is shown in . Therein the ACTIVE state is in this example the default state during which the 3D pointing device is moving and being used to e.g. provide inputs to a user interface. The 3D pointing device can enter the ACTIVE state on power up of the device as indicated by the reset input. If the 3D pointing device stops moving it may then enter the INACTIVE state. The various state transitions illustrated in can be triggered by any of a number of different criteria including but not limited to data output from one or both of the rotational sensors and data output from the accelerometer time domain data frequency domain data or any combination thereof. State transition conditions will be generically referred to herein using the convention Condition . For example the 3D pointing device will transition from the ACTIVE state to the INACTIVE state when conditionoccurs. For the sole purpose of illustration consider that conditioncan in an exemplary 3D pointing device occur when mean and or standard deviation values from both the rotational sensor s and the accelerometer fall below first predetermined threshold values for a first predetermined time period. When in the ACTIVE state data received from the motion sensors e.g. rotational sensor s and or accelerometer can be separated into first data associated with intentional movement introduced by a user and second data associated with unintentional movement introduced by a user tremor using one or more processing techniques such as linear filtering Kalman filtering Kalman smoothing state space estimation Expectation Maximization or other model based techniques. The first data can then be further processed to generate an output associated with the intended movement of the handheld device e.g. to support cursor movement while the second data can be used as tremor input for e.g. user identification as described in more detail below.

State transitions can be determined by a number of different conditions based upon the interpreted sensor outputs. Exemplary condition metrics include the variance of the interpreted signals over a time window the threshold between a reference value and the interpreted signal over a time window the threshold between a reference value and the filtered interpreted signal over a time window and the threshold between a reference value and the interpreted signal from a start time can be used to determine state transitions. All or any combination of these condition metrics can be used to trigger state transitions. Alternatively other metrics can also be used. According to one exemplary embodiment of the present invention a transition from the INACTIVE state to the ACTIVE state occurs either when 1 a mean value of sensor output s over a time window is greater than predetermined threshold s or 2 a variance of values of sensor output s over a time window is greater than predetermined threshold s or 3 an instantaneous delta between sensor values is greater than a predetermined threshold.

The INACTIVE state enables the stationary detection mechanism to distinguish between brief pauses during which the 3D pointing device is still being used e.g. on the order of a tenth of a second and an actual transition to either a stable or stationary condition. This protects against the functions which are performed during the STABLE and STATIONARY states described below from inadvertently being performed when the 3D pointing device is being used. The 3D pointing device will transition back to the ACTIVE state when conditionoccurs e.g. if the 3D pointing device starts moving again such that the measured outputs from the rotational sensor s and the accelerometer exceeds the first threshold before a second predetermined time period in the INACTIVE state elapses.

The 3D pointing device will transition to either the STABLE state or the STATIONARY state after the second predetermined time period elapses. As mentioned earlier the STABLE state reflects the characterization of the 3D pointing device as being held by a person but being substantially unmoving while the STATIONARY state reflects a characterization of the 3D pointing device as not being held by a person. Thus an exemplary state machine according to the present invention can provide for a transition to the STABLE state after the second predetermined time period has elapsed if minimal movement associated with hand tremor is present or otherwise transition to the STATIONARY state.

The STABLE and STATIONARY states define times during which the 3D pointing device can perform various functions. For example since the STABLE state is intended to reflect times when the user is holding the 3D pointing device but is not moving it the device can record the movement of the 3D pointing device when it is in the STABLE state e.g. by storing outputs from the rotational sensor s and or the accelerometer while in this state. These stored measurements can be used to determine a tremor pattern associated with a particular user or users as described below. Likewise when in the STATIONARY state the 3D pointing device can take readings from the rotational sensors and or the accelerometer for use in compensating for offset as described above.

If the 3D pointing device starts to move while in either the STABLE or STATIONARY state this can trigger a return to the ACTIVE state. Otherwise after measurements are taken the device can transition to the SLEEP state. While in the sleep state the device can enter a power down mode wherein power consumption of the 3D pointing device is reduced and e.g. the sampling rate of the rotational sensors and or the accelerometer is also reduced. The SLEEP state can also be entered via an external command so that the user or another device can command the 3D pointing device to enter the SLEEP state.

Upon receipt of another command or if the 3D pointing device begins to move the device can transition from the SLEEP state to the WAKEUP state. Like the INACTIVE state the WAKEUP state provides an opportunity for the device to confirm that a transition to the ACTIVE state is justified e.g. that the 3D pointing device was not inadvertently jostled.

The conditions for state transitions may be symmetrical or may differ. Thus the threshold associated with the conditionmay be the same as or different from the threshold s associated with the condition. This enables 3D pointing devices according to the present invention to more accurately capture user input. For example exemplary embodiments which include a state machine implementation allow among other things for the threshold for transition into a stationary condition to be different than the threshold for the transition out of a stationary condition.

Entering or leaving a state can be used to trigger other device functions as well. For example the user interface can be powered up based a transition from any state to the ACTIVE state. Conversely the 3D pointing device and or the user interface can be turned off or enter a sleep mode when the 3D pointing device transitions from ACTIVE or STABLE to STATIONARY or INACTIVE. Alternatively the cursor can be displayed or removed from the screen based on the transition from or to the stationary state of the 3D pointing device .

As mentioned above the period of time during which the handheld device is in the STABLE state can for example be used to memorize tremor data associated with a particular user. Typically each user will exhibit a different tremor pattern. According to exemplary embodiments of the present invention this property of user tremor can be used to identify which user is currently holding the handheld device without requiring any other action on the part of the user e.g. entering a password . For example a user s tremor pattern can be memorized by the handheld or the system e.g. either stored in the 3D pointing device or transmitted to the system during an initialization procedure wherein the user is requested to hold the 3D pointing device as steadily as possible for e.g. 10 seconds.

This pattern can be used as the user s unique or quasi unique signature to perform a variety of user interface functions. For example the user interface and or the handheld device can identify the user from a group of users e.g. a family by comparing a current tremor pattern with those stored in memory. The identification can then be used for example to retrieve preference settings associated with the identified user. For example if the 3D pointing device is used in conjunction with the media systems described in the above incorporated by reference patent application then the media selection item display preferences associated with that user can be activated after the system recognizes the user via tremor pattern comparison. System security can also be implemented using tremor recognition e.g. access to the system may be forbidden or restricted based on the user identification performed after a user picks up the 3D pointing device .

A number of different approaches can be taken to implement schemes for tremor pattern detection classification and storage according to the present invention. One exemplary embodiment will now be described with respect to . An overall method for classifying tremor patterns is depicted in the flowchart of . Therein data sets are collected from a plurality of users at step . Data set collection can be part of a training initialization process wherein a user is asked to hold the device without introducing intentional motion for a predetermined period of time e.g. 5 15 seconds or can be performed on the fly during use of the handheld device. Moreover data collection can be performed while holding the handheld device in a predetermined orientation. Some purely exemplary frequency spectra data shown in was collected for a particular user holding a 3D pointing device in four different orientations.

Returning to the collected data can then be processed in order to identify classes which are each associated with different users of the handheld device . For example one or more feature sets can be extracted from each set of collected data for use in the classification process at step . The particular feature set or feature sets which are selected for use in step is chosen to provide good class distinction for tremor data and may vary depending upon implementation parameters associated with the user identification via tremor process including for example the number of users to be distinguished in the classification pool the amount and type of training data to be collected at step device characteristics state information as described above e.g. with respect to and associated Bayesian user information e.g. time of day . An exemplary list of feature sets which can be employed at step are provided below as Table 1 below.

Information regarding some of these feature sets and corresponding tests can be found in the article by J. Jakubowski K. Kwiatos A. Chwaleba S. Osowski IEEE Transactions on Biomedical Engineering vol. 49 no. 2 pp. 152 159 IEEE February 2002 the disclosure of which is incorporated here by reference. According to one purely exemplary embodiment of the present invention described in more detail below low frequency spectra from a power spectral density PSD of the collected data was used as the feature set at step . In addition to the domains transforms etc. listed above the features sets may also vary based on the number and types of sensors available in the handheld device for which tremor detection identification is to be employed. For example in the handheld 3D pointing device described in earlier exemplary embodiments tremor data can be collected from one or both of the rotational sensors the accelerometer or any combination thereof.

After extracting the feature set from the collected data the feature set can be reduced at step . More specifically the feature set can be reduced at step to the set of features which best represent the feature set for purposes of differentiating between classes users . For example the DC values of user tremor data may be omitted from the reduced feature set whereas the 9 Hz values of user tremor data may be included in the reduced feature set since the latter would be expected to be more useful in distinguishing between different user s hand tremors. The reduced feature set can for example be a Most Expressive Feature MEF set which is determined using a Principal Component Analysis PCA algorithm. The PCA algorithm employs a singular value decomposition of the features set to automatically find an appropriate set of basis vectors that best expresses the feature vectors e.g. in the sense of minimum mean squared error MMSE . An example for applying the PCA technique can be found in Eigenspace Based Recognition of Faces Comparisons and a New Approach authored by P. Navarrete and J. Ruiz del Solar Image Analysis and Processing 2001 the disclosure of which is incorporated here by reference.

The reduced feature sets can then be used to identify clusters at step which can be performed using supervised learning i.e. wherein the process operates based on a priori knowledge of which individual user contributed which data set or unsupervised learning i.e. wherein the process does not have any a priori information. Various techniques can be applied to determine clusters associated with tremor data according to exemplary embodiments of the present invention including for example K means clustering and RBF neural net classification. Once the clusters are identified then estimated statistics associated with the identified clusters e.g. mean and or covariance can be used to distinguish new feature vectors as lying within certain clusters or outside of certain clusters i.e. to identify a user who is currently holding the handheld device based on current sensor outputs at step . The learning method can be enhanced via use of the sensor state information described above e.g. with respect to by refining clusters centers during sensor operation after initial user cluster instantiation. In this way the maximum amount of available data is used to refine clusters in a supervised manner to support further unsupervised learning.

To test the afore described exemplary techniques for identifying users based on detected hand tremor data sets associated with four other users in addition to the data illustrated in were collected and analyzed in the general manner described above with respect to the flowchart of to demonstrate that hand tremor analysis can be used to distinguish between identify different users. Two of the data sets were collected from the same person holding the handheld device while the other three data sets were collected from different people holding the handheld device. In this test data was collected from both of the rotational sensors for each of the five data sets at step . Each of the data sets was processed to have zero mean and unit variance. For this exemplary test low frequency spectra from a PSD estimate e.g. peak frequencies were used for the feature set extraction averaged over the data collection time at step . More specifically 256 point FFTs were used averaged with a 75 overlap over N 2048 points within a frequency range of 0 30 Hz. The extracted feature set was reduced from a 38 20 matrix to a 20 20 matrix using the PCA algorithm which correctly recognized that certain eigenvectors associated with the extracted feature set are less expressive than others and can be discarded. illustrates eigenvalues generated as part of step in this example. Therein line depicts eigenvalues associated with feature set 2 data collected from rotational sensor z azis rotation and line depicts eigenvalues associated with feature set 1 data collected from rotational sensor y axis rotation .

In this test case the clustering step was performed based on the a priori knowledge supervised learning of which user generated which data set. In an actual implementation it is likely that an automated clustering technique e.g. one of those described above would be employed at step . For this purely exemplary test clusters were identified separately for data received from the rotational sensor and to define two class centroids associated with each data set. Then the sum of the distances Euclidean in this example between each vector in the data sets and the two class centroids was calculated. The results of this process are shown in . Therein the x axis represents the reduced data set vectors the y axis represents distance and the vertical lines partition distances to different class user centroids. It can be seen that within each partition the associated class vector to centroid distance is significantly lower than the other classes vector to centroid distance illustrating good class separation and an ability to distinguish identify users based on the hand tremor that they induce in a handheld device.

Some specific selections of e.g. feature sets etc. were made to perform the illustrated test however these selections are purely illustrative as mentioned herein.

A number of variations can be employed according to exemplary embodiments of the present invention. For example once the clusters are identified at step a cluster discrimination step can be performed in order to accentuate the discriminating feature s of each cluster. A cluster discriminant operates to apply a transformation matrix to the data which provides a minimum grouping within sets and a maximum distance between sets. Given a matrix which describes the overall covariance and another which describes the sum of the covariances of each of the clusters the linear discriminant s task is to derive a linear transformation which simultaneously maximizes the distances between classes and minimizes the within class scatter. Although a number of discriminants are known in the general field of pattern recognition for example the Fisher Linear Discriminant FLD not all are likely to be suitable to the specific problem of identifying users based on hand tremor as described herein. One specific discriminant which was used in the foregoing text example is known as the EFM 1 discriminant and is described in the article entitled Enhanced Fisher Linear Discriminant Models for Face Recognition authored by C. Liu and H. Wechsler Proc. 14th International Conference on Pattern Recognition Queensland Australia Aug. 17 20 1998 the disclosure of which is incorporated here by reference.

Moreover although the foregoing test was performed using a handheld pointing device in accordance with earlier described exemplary embodiments of the present invention tremor based identification of users is not so limited. In fact tremor based identification can be employed in any other type of 3D pointing device having any type of motion sensor or sensors including gyroscopes from which tremor data can be generated. Further tremor based identification in accordance with the present invention is also not limited to pointing devices but can be employed in any handheld device e.g. cell phones PDAs etc. which incorporate one or more motion sensors or which have some other mechanism for measuring hand tremor associated therewith. A training period may be employed to perform e.g. steps subsequent to which a handheld device can perform a method which simply gathers data associated with the hand tremor of a current user and compares that data with the previously established user classes to identify the current user. This identity information can then be used in a number of different applications examples of which are mentioned above.

For example the identity of the user as recognized by tremor based recognition or via another identification technique can be used to interpret gestures made by that user to signal commands to a user interface e.g. that of the above incorporated by reference patent application. For example in a gesture based command system wherein patterns of movement over time are associated with specific interface commands different users may employ somewhat different patterns of movement over time of the handheld to initiate the same interface command much like different people have different handwriting styles . The ability to provide for user identification can then be mapped to the different gesture patterns e.g. stored in the handheld or in the system such that the system as a whole correctly identifies each pattern of movement over time as the command gesture intended by the user.

As mentioned above exemplary embodiments of the present invention process movement data received from sensor s in the 3D pointing device to convert this data from the frame of reference of the 3D pointing device s body into another frame of reference e.g. the user s frame of reference. In the exemplary application of a 3D pointing device used to control a user interface displayed on a screen e.g. a television the user s frame of reference might be a coordinate system associated with the television screen. Regardless translation of the data from the body frame of reference into another frame of reference improves the usability of the handheld device by resulting in an operation that is from the user s perspective rather than the device s perspective. Thus when the user moves his or her hand from left to right in front of a display while holding the 3D pointing device the cursor will move in the left to right direction regardless of the orientation of the 3D pointing device.

To simplify this discussion an exemplary processing system associated with a 3D pointing device is shown in e.g. as described in more detail above. Therein the handheld system senses motion using one or more sensors e.g. rotational sensor s gyroscopes s accelerometer s magnetometer s optical sensor s camera s or any combination thereof. The sensors are then interpreted in block to produce an estimate of the motion that occurred. The processing block then translates the measured motion from the natural body reference frame of the device into the reference frame of the user. The movement is then mapped into meaningful actions that are interpreted at block forwarded to the system to produce a meaningful response such as moving an on screen cursor.

Block converts detected movement into the reference frame of the user instead of the reference frame of the device. Orientation may be represented by many different mathematically similar methods including Euler angles a direction cosine matrix DCM or a unit quaternion. Position is generally represented as an offset from the coordinate system origin in a consistent unit including but not limited to meters centimeters feet inches and miles. In one exemplary embodiment described above a 3D pointing device measures inertial forces including acceleration and rotational velocity. These forces are measured relative to the body of the device by sensors mounted therein. In order to convert the measured data into the user frame of reference the device estimates both its position and its orientation.

In this exemplary embodiment it is assumed that the user frame of reference is stationary and has fixed orientation although those skilled in the art will appreciate that this technique in accordance with the present invention can be readily extended to the cases where the user s frame of reference is non stationary by either directly transforming to the time varying frame or by first converting to a stationary frame and then converting to the moving frame. For the stationary fixed orientation user frame of reference example conversion from the body frame to the user frame can be performed by use of the following equations Rotate Pdelta Rotate Rotate Rotate Rotate where 

Rotate represents the quaternion rotation operator such that Rotate A Q is equal to Q A Q where Q is the quaternion conjugate and the vector A is a quaternion with the complex component equal to A and the real component equal to 0 

Pdelta is the difference between the origin of the user frame of reference and the body frame of reference in the user frame of reference coordinate system 

Q is the normalized rotation quaternion that represents the rotation from the body frame to the user frame. Since the rotation quaternion to rotate from the user frame to the body frame is Q we could replace Q with R where R is the rotation from the user frame to the body frame. Note that Q can be represented in a number of equivalent forms including Euler angles and the direction cosine matrix DCM and the above equations may vary slightly in their equivalent forms based upon different representations of Q. graphically illustrates the transformation from a body frame of reference to a user s frame of reference.

During operation the device estimates Q in an implementation dependent manner to perform this transformation. One exemplary implementation described above involves compensating for tilt i.e. variations in x axis roll of the 3D pointing device based on the manner in which it is held by a user . The orientation is computed by first estimating the acceleration component due to gravity in the body frame Ab. By definition the acceleration vector due to gravity in the user frame Ag is set to 0 0 1 . Since gravity cannot estimate the heading rotation about the z axis the body frame estimate for heading is used. Therefore the rotation quaternion has an axis of rotation in the z 0 plane. The following is one of several mathematically equivalent methods for computing the rotation quaternion cross product of unit vectors sin Quaternion 2 sin 2 cos 2 Position is then computed as the double integral of the acceleration in the user frame. The acceleration in the user frame is the acceleration of the body frame rotated into the user frame by Q above. Normally the origin is assumed to be zero when the device is first activated but the origin may be reset during normal operation either manually or automatically.

Generally when the device is not moving Pu Pu Wu and Wu are all 0. In this exemplary embodiment Pb and Wb are measured. Although an infinite number of rotations Q exist the minimal rotation can be selected from the available set and used to estimate Wu based on Wb. Alternatively Q may be computed using an assumed starting offset orientation Qo by integrating Wb over time as shown using the discrete time integral below Angle period sin Angle cos Angle Where represents multiplication and represents quaternion multiplication. Additional stability can be provided by constant field vectors including gravity and the earth s magnetic field and combined with the results above. The combination can be achieved using several numerical and filtering methods including but not limited to Kalman filtering.

A variety of different sensors could be employed as long as they measure motion with respect to the body of the device. Exemplary sensors include accelerometers rotational sensors gyroscopes magnetometers and cameras. The user frame does not need to be stationary. For example if the user s frame of reference is selected to be the user s forearm then the device would only respond to wrist and finger movement.

One skilled in the art will recognize the commutative property applies to the frame of reference transformations described in this invention. Therefore the order of the mathematical operations can be altered without materially affecting the invention described herein. In addition many motion processing algorithms can operate in either frame of reference equivalently especially when the user frame is chosen to be stationary with a constant orientation.

In addition to providing ease of use frame of reference transformations according to this exemplary embodiment of the present invention can also be used to address other challenges in handheld device implementations. For example if a sensor such as an accelerometer is not located precisely at the center of rotation in the body frame of reference the measured acceleration will include both the acceleration of the frame and acceleration components due to the rotation of the frame. Therefore the measured acceleration can first be transformed to a different target location within the body frame of the device using the following relationship body accelerometer where R is the vector from the accelerometer to the target location is the angular velocity of the body frame of reference and is the angular acceleration of the body frame of reference. If the body frame of the device is constructed such that it lies at R from the accelerometer then it should have zero angular acceleration effects and may be more easily used to compute the device movement in the user frame. This compensates for intentional or unintentional misalignment between the accelerometer and the center of the body frame of reference. In addition the estimate of the gravity vector becomes much simpler since there are fewer forces acting at the center of rotation. Then user Rotate body where Q is the rotation from the body frame of reference to the accelerometer frame of reference.

Unfortunately different users have different values for R. For example one user may use the handheld device by rotating their elbow while another may use the device by rotating their wrist. In addition people have different sized wrists and forearms. For improved usability this exemplary embodiment of the handheld dynamically computes R and moves the body origin such that it has minimal acceleration components due to angular motion. The exemplary embodiment estimates R by defining R as Rx 0 0 and solving for Rx using and minimizing Abody Rotate Ag Q . Note that many numerical methods exist including recursive least squares and Kalman filtering that may perform minimization to compute Rx.

Based on the foregoing it will be appreciated that the present invention describes various techniques for mapping sensed motion of a handheld device from one frame of reference e.g. a body frame of reference to another frame of reference e.g. a user s frame of reference . These mappings can be independent from other mappings associated with the use of the handheld device e.g. the mapping of sensed motion to cursor movement or can be combined therewith. Moreover transformations according to the present invention can be performed to transform the sensed motion in all three dimensions for translational motion and rotational motion or any subset thereof from the perspective of either the input side of the motion equation or the output side. Additionally the selection of the frame of reference into which the sensed motion is mapped or transformed can be made in a number of different ways. One example provided above shows the second frame of reference being a user s frame of reference associated with the tilt of the device however many other variations are possible. For example the user may select his or her desired frame of reference which setting can be stored in the handheld as one of a plurality of user preferences and used to perform the transformation. Other examples include user recognition and explicit command e.g. button or user interface selection as techniques for selecting the second frame of reference.

Additionally although some of the exemplary embodiments describe above operate on data in the velocity domain the present invention is not so limited. Mapping or transformation according to the present invention can alternatively or additionally be performed on for example position or acceleration data and can be for translational motion rotational motion or both. Also the order of processing is not critical. For example if the handheld device is being used to output gesture commands the mapping can be performed first and then the gesture determined or the gesture can be determined first and then the mapping can be performed.

According to exemplary embodiments of the present invention techniques for processing sensed motion remove undesirable effects due to for example other user device interactions such as button actuation and or tremor. Generally as referred to in the input to the system is human movement of the handheld 3D pointing device. This movement is sensed by the device block and processed into representative motion e.g. at block detailed examples of which are described above. It should be noted however that these exemplary embodiments of the present invention are not limited to application in the exemplary handheld 3D pointing device described above and are expressly intended to include other handheld devices e.g. 3D pointing devices using other types of motion sensors. The representative motion is then converted into a meaningful representation block that is processed by exemplary human factors techniques according to exemplary embodiments of the present invention at block . In the exemplary embodiment described herein the output of human factors processing is then mapped into for example 2D pointer movement. The processed movement is then output by the handheld device an example of which is data that can be used to control on screen pointer movement.

This exemplary embodiment of the present invention includes a variety of different techniques for processing movement during user initiated events including button clicks. According to a first exemplary embodiment both a distance threshold and a time threshold are employed to process movement information generated by the motion sensor s e.g. rotational sensor s accelerometer s magnetometer s gyroscope s camera s or any combination thereof etc. after a user action e.g. a button click has occurred. Distance alone may not be sufficient to yield both a stable and a responsive pointer during a button click. When a button press is detected by the hand held device the output pointer movement from 1516 is suppressed until either the distance exceeds a distance threshold or the amount of elapsed time exceeds a time threshold. Either or both of the distance and time thresholds may be different for e.g. a button press action and button release action. The exemplary button processing may optionally be disabled by sending a command to the handheld.

Different buttons can also have different thresholds from one another. The amount of movement that the handheld experiences during a button click depends upon a number of factors including but not limited to the user the button actuation force the button travel and the location of the button relative to the handheld center of support normally a user s hand . The button movement processing parameters may be set individually to optimize the performance for each button. In addition the parameters can be learned based upon the session history or based upon the user if the user is known to the system.

Additionally the human factors processing function may store and track the past movement history of the handheld device. For example when the handheld device detects that a button has been pressed a processing unit in the handheld device can back up to the time before the user initiated the button event. Physically actuating the button takes a non finite measurable amount of time that can be determined by psychological testing and dynamic device measurement. When the button is actuated the device can revert to the state before the button actuation occurred by deleting data samples taken from the motion sensor s during after the button actuation occurred. Therefore the errant movement that occurred during the button press will be ignored and erased . For example in response to a detected button press the output from block may change from a detected position P1 subsequent to a button press action to a recalled position P2 which position P2 had previously been output by block a predetermined time period prior to the button press action detection. If the device is already processing one button action and is still suppressing movement when another button action occurs it may be unnecessary for the human factors processing function to reiterate the backing up process.

In user interfaces at least two typical types of button activations can occur. In the first type fine mode clicking shown in the user intends precise actuation over a small target and carefully aligns the device stops movement and then presses the button. In the second type coarse mode clicking the target is large and the user anticipates the next action i.e. the user may only slow down the pointer without stopping or hovering over the target and may instead intend to click on the target on the fly . For fine mode clicking the above described processing technique operates to accurately remove unintentional motion data from the combined data output stream from the motion sensor s in the handheld device. However for the second type of movement further enhancements may be useful to improve performance.

To address the additional challenges posed by coarse mode clicking human factors processing unit may employ a second alternative or complementary technique. According to this second exemplary embodiment movement data received from the motion sensor s is processed into a movement vector and it is assumed that the user may intend some movement change of the cursor or other associated output from the device during the button actuation. As known from Newton s first law an object in motion tends to stay in motion . Thus when a button is pressed on the handheld device it creates a high frequency movement that deviates from the path. Using the motion vector and filtered movement information the output from the pointing device can continue during and after the user initiated event in a manner which is consistent with previous movement history. This can be accomplished by adding a filter to the processing chain. The filter is designed to permit intended motion during and after the user initiated event while excluding the high frequency movement associated with the event itself. Many processing methods such as low pass filtering enable the removal of high frequency components but at the expense of increased latency. Since latency the time between the movement of the device and the time the pointer moves may be important to the user exemplary embodiments of the present invention can use an adaptive filter which is switched into the signal processing path when a user initiated event is detected e.g. based on the same signal which is used by the handheld device to convey the user event to a user interface . The adaptive filter is configured as a low pass filter that attenuates sharp high frequency button presses. An additional input to the adaptive filtering block is an optional pre button activity warning that occurs before the button has been completely debounced. The pre button activity warning reduces the filter latency requirements by allowing the processing to be notified of a button event sooner than it would otherwise. The adaptive filter with the pre button activity warning minimizes the engineering tradeoff between intended movement and latency.

According to yet another exemplary embodiment of the present invention since the designers of 3D pointing devices usually know the direction of the undesirable movement at design time the direction of movement perturbation is therefore known based upon the ergonomics and intended use of the device. For example the designer knows the direction of button actuation relative to the device. The primary movement consists of either linear movement parallel to the button travel vector or rotational movement due to the torque about the users grip. This knowledge permits the implementation of a directional preference filter that includes the knowledge of the button actuation movement. For example the filter design can include state space filters such as a Kalman filter and adaptive filters. Such a filter detects the undesired deviation from the intended path in a known direction during button actuation and then interpolates the desired movement path during button actuation. This preferential filtering yields a more responsive pointer during intended changes in direction while still removing the unintended button movement. One skilled in the art will recognize that the state space filter can be extended to learn the design parameters during the course of normal use.

The human factors processing function according to exemplary embodiments of the present invention may implement one or both of the above described techniques and if both are used provide a classifier to switch between the techniques. For example when the first precise type of button click is detected the first technique can be used. When the second less precise type of button click is detected the second technique can be used. One classifier for switching between techniques can use the velocity of the handheld device at the time of button actuation or at the time just before button actuation. For example if a the velocity of the handheld device is below a predetermined velocity threshold then the first technique is employed which discards motion data generated subsequent to a detected event until either motion sensed by the motion sensor s indicates that the handheld device has moved more than a predetermined distance threshold or a predetermined time has expired otherwise b if the velocity of the handheld device is above the predetermined velocity then the second technique is employed which instead filters the motion data generated subsequent to a detected event.

Button clicks or presses as referred to in the foregoing exemplary embodiments include but are not limited to both button presses and button releases. All of the above techniques can be applied to any known device interaction that yields undesirable movement and are not limited to button clicks. For example the above techniques can be applied to scroll wheel actuation touch pad usage or capacitive strip usage. Thus exemplary embodiments of the present invention describe methods and devices for canceling unwanted movement that occurs based upon activating or deactivating another event.

The parameters for the methods describe above can be adapted to support the expected movement characteristic for the event. In the exemplary embodiment the parameters for button presses can be different from the parameters for button releases. In addition to movement cancellation the user interface may impose or suggest additional constraints on user event handling according to the present invention. For example in Microsoft Windows operating systems if the cursor moves while the button is pressed then a drag action is initiated. Therefore parameters associated with motion data processing in response to a button press action by a user can have values which tend to restrict pointer movement during button actuation in order to prevent unwanted drag events. In contrast cursor movement after a button release in Microsoft Windows operating systems has little effect on objects in the user interface and therefore exemplary motion data processing in accordance with the present invention can employ parameters e.g. time and or distance thresholds filter coefficients etc. which tend to be less restrictive of pointer movements as compared to the corresponding parameters associated with motion data processing subsequent to button presses.

The movement may be processed in the velocity or position domain in a number of different fashions to help remove unwanted button movement. Simple filtering in the velocity domain may be used. The filter may be an FIR or IIR filter although these may introduce an undesirable amount of processing delay. An adaptive filter can be used successfully without introducing too much delay.

Exemplary embodiments of the present invention can also be implemented as a Kalman filter or extended Kalman filter . The Kalman filter could select the most likely usage scenario stationary or moving and apply the appropriate movement. Neural networks can be used for the same result. Thus it will be appreciated that the present invention further provides a method for a detecting that an event has occurred b inferring the user s intended motion and c interpreting the user s intended motion rather than the actual motion of the handheld device. The motion can be in either the 6DOF 3D domain or the mapped 2DOF pointing domain. The 6DOF 3D domain could be in either the device s body frame of reference or the user s frame of reference.

According to another exemplary embodiment of the present invention the movement associated with the user initiated event can be modeled and included explicitly in a motion equation which provides an output from the handheld device based on the motion data gathered from the motion sensor s . More specifically using the button press example of a user initiated event the movement caused by button presses can be modeled a priori to determine one or more exemplary movement amplitudes and directions associated with the button press action and these values can then be stored in a memory unit of the handheld device. Then when a button press is detected the processing unit of the handheld device can use the modeled movement in the motion equation to adapt the output such that it reflects the user s intended motion rather than the movement detected by the motion sensor s that was associated with the button press. The processing unit can use the modeled values in a variety of different ways e.g. subtract them from the detected motion values attenuate the detected motion values based on the modeled values associated with the particular user initiated event adjust a semantic map associated with the handheld s output etc.

Thus it can be seen that exemplary embodiments of the present invention describe innovative methods of implementing a handheld remote control for various uses including controlling a television. The device can also be used for other applications e.g. as an input device to a personal computer and object control.

No longer does the remote control have to resemble a miniature keyboard of buttons the typical IR remote of today has 40 buttons . Rather remote control devices in accordance with the present invention can closely resemble a mouse in that the activity of pointing conveys information over and above the mere pressing of buttons. The result is a much more powerful user environment for the remote control of devices and applications. Imagine today s PC without a mouse and you have today s TV control environment. Now imagine adding mouse like functionality to the TV the result is a vastly improved user experience. All it requires is a wireless handheld capable of allowing pointing as well as button activation. The present invention describes just such a device. One advantage of this design over the traditional remote control is that it allows the user to position a cursor on the screen in addition to detecting button activation. The result is that screen sensitive buttons and controls in addition to gesture recognition are possible. The result is a very powerful flexible and extensible user interface when compared with the traditional remote control where adding a function requires a new button to be added. Exemplary embodiments of the present invention provide these capabilities using handheld remote control devices that employ e.g. MEMS based rotational sensors which measure angular velocity of the device. In addition exemplary embodiments provide for teach body frame adjustment calibration and post processing to remove unintentional movement. The result is a totally unique implementation that is better performing cheaper and smaller than conventional handheld remote control devices.

These exemplary techniques use MEMS sensors to measure rotational angular velocity and linear acceleration. Then calibration is used in conjunction with stationary detection to adjust and scale the raw readings. The linear acceleration readings are then integrated and used to determine orientation of the handheld body frame. This orientation data is then used to map the rotational velocity readings into the appropriate frame of reference. The final step is that the readings of all movement are post processed so that unintentional movement like human tremor is filtered out.

Systems and methods for processing data according to exemplary embodiments of the present invention can be performed by one or more processors executing sequences of instructions contained in a memory device. Such instructions may be read into the memory device from other computer readable mediums such as secondary data storage device s . Execution of the sequences of instructions contained in the memory device causes the processor to operate for example as described above. In alternative embodiments hard wire circuitry may be used in place of or in combination with software instructions to implement the present invention.

The above described exemplary embodiments are intended to be illustrative in all respects rather than restrictive of the present invention. Thus the present invention is capable of many variations in detailed implementation that can be derived from the description contained herein by a person skilled in the art. For example although the foregoing exemplary embodiments describe among other things the use of inertial sensors to detect movement of a device other types of sensors e.g. ultrasound magnetic or optical can be used instead of or in addition to inertial sensors in conjunction with the afore described signal processing. All such variations and modifications are considered to be within the scope and spirit of the present invention as defined by the following claims. No element act or instruction used in the description of the present application should be construed as critical or essential to the invention unless explicitly described as such. Also as used herein the article a is intended to include one or more items.

