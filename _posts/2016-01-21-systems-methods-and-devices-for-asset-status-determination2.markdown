---

title: Systems, methods and devices for asset status determination
abstract: A system for managing data related to at least one leaf node device, the system including a location processing engine located on a server that is remote from the at least one leaf node device; at least one point of interest (POI) device for collecting data relating to at least one leaf node device and transmitting the collected data with a timestamp using Bluetooth Low Energy (BLE); at least one reader node device for receiving the collected data from the point of interest (POI) device using BLE and transmitting the collected data to the location processing engine; and a database of the known locations of POI devices, wherein the known locations are used as a basis for determining the location of the at least one leaf node device that communicated with the POI device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09641964&OS=09641964&RS=09641964
owner: CloudLeaf, Inc.
number: 09641964
owner_city: Milpitas
owner_country: US
publication_date: 20160121
---
This application is a continuation in part of U.S. application Ser. No. 14 845 071 filed on Sep. 3 2015 entitled SYSTEMS METHODS AND DEVICES FOR ASSET STATUS DETERMINATION. U.S. application Ser. No. 14 845 071 claims priority to U.S. Provisional Appl. 62 045 420 filed on Sep. 3 2014 entitled DEVICES AND METHODS FOR BLUETOOTH AND BLUETOOTH LOW ENERGY BLE COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS U.S. Provisional Appl. 62 061 853 filed Oct. 9 2014 entitled DEVICES AND METHODS FOR BLUETOOTH AND BLUETOOTH LOW ENERGY BLE COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS U.S. Provisional Appl. 62 081 478 filed Nov. 18 2014 entitled DEVICES AND METHODS FOR BLUETOOTH AND BLUETOOTH LOW ENERGY BLE COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS U.S. Provisional Appl. 62 105 885 filed Jan. 21 2015 entitled DEVICES AND METHODS FOR BLUETOOTH AND BLUETOOTH LOW ENERGY BLE COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS U.S. Provisional Appl. 62 161 463 filed May 14 2015 entitled COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS and U.S. Provisional Appl. 62 161 789 filed May 14 2015 entitled COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS. 

This application is a continuation in part of PCT Appl. PCT US2015 048412 filed Sep. 3 2015 entitled SYSTEMS METHODS AND DEVICES FOR ASSET STATUS DETERMINATION. 

This application claims priority to U.S. Provisional Appl. 62 105 885 filed Jan. 21 2015 entitled DEVICES AND METHODS FOR BLUETOOTH AND BLUETOOTH LOW ENERGY BLE COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS. 

This application also claims priority to U.S. Provisional Appl. 62 161 463 filed May 14 2015 entitled COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS. 

This application also claims priority to U.S. Provisional Appl. 62 161 789 filed May 14 2015 entitled COMMUNICATIONS FOR INDUSTRIAL CONTROL STATUS AND LOGISTICAL SYSTEMS. 

All of the above mentioned patent applications are hereby incorporated by reference in their entirety.

The disclosure relates to Bluetooth Low Energy BLE systems containing end node devices and the monitoring control and data extraction therefrom for example in the area of asset management. The disclosure also relates to hardware and componentry to enable efficient communication and power usage for such BLE systems.

An asset management system is a software system that continually inputs current real time data from a set of computationally intelligent nodes where each such node associates with some asset coherently organizes these data provides methods to extract useful information and knowledge from these data and potentially provides methods to direct those nodes.

Asset management systems are useful in connection with the management of the manufacture storage delivery and other logistics associated with physical goods.

A critical aspect relates to tracking such goods and providing to the controlling industrial entities crucial data such as current and historic location of the goods current and historic rate at which the goods are traveling current and historic state information regarding those goods such as humidity temperature shock change in weight as detected by pressure gauges tamper detection by contact sensors and so on.

Within the field of enterprise asset management physical asset management includes various methods and systems that help various types of enterprises manage various physical and infrastructure assets including in relation to design construction commissioning operating maintaining repairing modifying replacing and decommissioning disposal of such physical and infrastructure assets which may include equipment tools structures production and service plants power generating assets water and waste treatment assets facilities distribution networks transport systems buildings inventory supplies vehicles products information technology systems and a wide range of other physical assets. Information technology systems have emerged that catalog and help enterprises manage physical assets including systems for recording locations of such assets and including systems that use networking and tagging technologies such as WiFi and RFID to store collect and manage certain information about the assets.

In the context of asset management systems the prior art fails to provide continuous instantaneous access to all tracked states and to instantaneously inform operators of events that require their attention.

Range real time access to data at the nodes the potential for interference scalability physical constraints centralized control and power consumption are all challenges in prior art systems that utilize Wi Fi and RFID. With respect to Wi Fi while Wi Fi appears to be a good choice due to Wi Fi s decent range and the fact that it contains proper protocols at all levels of the software stack it suffers from Wi Fi s demands of high power rendering a system based on purely battery powered Wi Fi devices infeasible. RFID has range constraints in that a reader must be in range of an asset in order to obtain the information therefrom.

The above is a non exhaustive list of shortcomings of the prior art that a BLE enabled asset management system hereinafter BLEATS can address. In embodiments a BLEATs asset management system may comprise a software system that continually inputs current real time data such as from a set of computationally intelligent tags where each such tag physically associates with some assets coherently organizes these data provides methods to extract useful information and knowledge from these data and potentially provides methods to direct those tags.

This disclosure presupposes knowledge and understanding of the subjects of Bluetooth Low Energy BLE devices and protocols and Internet physical devices and protocols these subjects being well known and well understood by those skilled in the art.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device and at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node wherein the location processing engine processes information relayed by the beam forming receiver hardware node to facilitate determination of the location of the leaf node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the leaf node is adapted to use the Bluetooth Low Energy protocol and to be deployed as an asset tag on a physical asset.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the beam forming gateway node and the leaf node can communicate over a range of at least twenty feet using not more than 10 mW of power.

The present disclosure describes a system for management of information relating to a leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one Bluetooth Low Energy enabled leaf node device adapted communicate through a gateway node and a processing engine located on a server that is remote from the at least one leaf node device for managing information relating to the leaf node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the managed information includes at least one of location data for the leaf node event data about the leaf node state information about the leaf node and sensor data collected by the leaf node.

The present disclosure describes a system for asset tagging the system according to one disclosed non limiting embodiment of the present disclosure can include at least one leaf data communication node adapted to be attached to a physical asset wherein the leaf data communication node is configured to continuously communicate in real time using the Bluetooth Low Energy protocol with at least one receiver node that collects real time information about the location of a plurality of assets.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the assets comprise at least one of human assets manufacturing assets and inventory assets.

The present disclosure describes a system for real time location management of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a remote location processing facility located on a server that is remote from the at least one leaf node device for determining the location of the at least one leaf node device at least one beam forming receiver hardware node for collecting and communicating sectorized data relating to the at least one leaf node and a Bluetooth Low Energy BLE enabled user device having an application for communicating with at least one of the beam forming receiver hardware node and the at least one leaf node to display the current location of the at least one leaf node wherein the location of the leaf node is determined by at least one of the remote location processing facility and the beam forming receiver hardware node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein at least one leaf node is deployed as an asset tag on a physical asset.

The present disclosure describes a method for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include taking at least one of signal strength information proximity information and phase angle information collected via Bluetooth Low Energy communication signals from the leaf node device delivering the collected information to a processing engine that is remote from the leaf node device and processing the collected information in real time to determine the location of the leaf node.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one beam forming gateway node for managing data relating to at least one leaf node wherein the leaf node is adapted to use the Bluetooth Low Energy protocol.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the data is managed according to location sectors located around the beam forming gateway node.

The present disclosure describes a system for asset tagging the system according to one disclosed non limiting embodiment of the present disclosure can include at least one Bluetooth Low Energy enabled leaf node device adapted to be attached as an asset tag on an asset and adapted to communicate through a gateway node to a remote location processing facility.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node that can identify a sector around the gateway node in which the leaf node is located.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the assets comprise at least one of human assets manufacturing assets and inventory assets.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the leaf node device has at least one sensor.

The present disclosure describes a system for managing information related to at least one leaf node device that uses Bluetooth Low Energy BLE data communication the system according to one disclosed non limiting embodiment of the present disclosure can include a software application installed on a mobile hardware device for communicating by the BLE data communication with at least one of a beam forming gateway node that collects data related to the leaf node device the leaf node device and a processing engine that is remote from the leaf node device to present at least one of location data event data state data and sensor data related to the least one leaf node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the beam forming gateway node forms sectorized beams that enable collection of directional information about the leaf node device.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node wherein the beams of the gateway node are shaped into sectors by use of a plurality of patch antennas.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the patch antennas are used to form four sectorized beams around the gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the sectorized beams collectively cover a 360 degree angle around the gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the sectorized beams are at least partially overlapping.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device and at least one beam forming receiver hardware node for collecting sectorized data relating to at least one leaf node wherein the beams of the beam forming receiver are shaped into sectors by use of at least one antenna selected from the group consisting of a patch antenna a linear antenna a point antenna a spherical antenna a circular polarization antenna a vertical polarization antenna a horizontal polarization antenna and an omnidirectional antenna with reflectors.

The present disclosure describes a system for managing data related to a leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one beam forming gateway node for collecting data relating to at least one leaf node and a database of the locations of points of interest corresponding to known locations of deployed gateways wherein the known locations are used as a basis for determining the locations of a plurality of leaf nodes that communicate with the gateways using BLE.

The present disclosure describes a system for managing and storing data related to at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one beam forming gateway node for collecting data relating to at least one leaf node and a database for storing the information collected from the leaf node devices.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node and a database of the locations of virtual points of interest corresponding to logical locations of beam forming gateway nodes within a flow of assets wherein the logical locations are used for determining the locations of a plurality of leaf nodes within the flow of assets wherein the leaf nodes communicate with the beam forming gateway nodes using BLE.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the logical location of a leaf node device is used to trigger an action.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein upon a leaf node arriving at a logical location an event is triggered by the beam forming gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein upon a leaf node sensing a triggering condition an event is triggered by the beam forming gateway node.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one gateway node for collecting data relating to at least one leaf node and a database of the locations of virtual points of interest corresponding to logical locations of gateway nodes within a flow of assets wherein the logical locations are used for determining the locations of a plurality of leaf nodes within the flow of assets wherein the leaf nodes communicate with the gateway nodes using BLE.

The present disclosure describes an information technology system for handling information to enable a real time location system using Bluetooth Low Energy BLE the system according to one disclosed non limiting embodiment of the present disclosure can include a device management system for mapping physical devices and handling sampled data with respect to the devices an asset visibility system for real time tracking of asset locations a process flow system for tracking travel paths of assets a logic layer for using logic to determine locations of assets and a presentation layer for presenting locations of assets trip metrics of assets and the like.

The present disclosure describes method of an information technology system for handling information relating to a real time location system RTLS that uses Bluetooth Low Energy BLE nodes for communication of data the system according to one disclosed non limiting embodiment of the present disclosure can include a process flow editor having a user interface to allow a user to at least one of access a stored process flow from a library and edit a process flow to create a customized process flow such that an asset may be tracked using the RTLS system with respect to at least one of a physical location corresponding to the process flow and a logical location with respect to a logical position within the process flow.

The present disclosure describes a method of an information technology system for handling information to enable an a real time location system using data communication nodes that communicate using the Bluetooth Low Energy protocol BLE the system according to one disclosed non limiting embodiment of the present disclosure can include taking raw event streams from a plurality of leaf data communication nodes transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types tagging active sessions of leaf data communication nodes performing domain level processing on the active sessions determining at least one event determining a transition of at least one leaf data communication node from a state or location to another state or location handing off the leaf data communication node as needed to one or more receivers tagging at least one event as a leaf data communication node transitions from first state to second state calculating at least one metric as to the location of at least one leaf data communication node and providing at least one of an alert and a notification based on the at least one tagged event.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the events are at least one of boundary events and visit events.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the events relate to at least one of battery status temperature location signal strength and phase angle.

The present disclosure describes a method of an information technology system for handling information to enable an a real time location system using data communication nodes that communicate using the Bluetooth Low Energy protocol BLE the method according to one disclosed non limiting embodiment of the present disclosure can include taking raw event streams from a plurality of leaf data communication nodes transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types tagging active sessions of leaf data communication nodes performing domain level processing on the active sessions and determining at least one event from the domain level processing.

The present disclosure describes a method of an information technology system for handling information to enable an a real time location system using data communication nodes that communicate using the Bluetooth Low Energy protocol BLE the method according to one disclosed non limiting embodiment of the present disclosure can include taking raw event streams from a plurality of leaf data communication nodes transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types tagging active sessions of leaf data communication nodes performing domain level processing on the active sessions determining a transition of at least one leaf data communication node from a state or location to another state or location and providing at least one of an alert and a notification based on the determined transition.

The present disclosure describes a method relating to an information technology system for handling information to enable a real time location system using Bluetooth Low Energy data communication nodes the method according to one disclosed non limiting embodiment of the present disclosure can include providing a reference data library containing at least one of device metadata context data business rules for stages of a processing pipeline business rules for a domain and process flows for devices that use the data communication nodes wherein the rules and flows may be customized for particular situations. Metadata may include a wide range of information about a device such as device identification device history descriptions of types of data that a device can handle and the like. Device metadata may also encapsulate various defined structures relating to the capabilities and configuration parameters of the leaf node. This metadata may be used to connect and control a leaf node in a generic way such as from the reader node or gateway.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one gateway for collecting data relating to a plurality of leaf nodes and time division multiplexing connections of the leaf nodes to the gateway in a time domain protocol and managing each of the connections in the time domain.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one gateway node for collecting data relating to a plurality of leaf nodes and providing a MAC layer designed to manage connections in the time domain thereby enabling concurrent connections of a large number of leaf nodes to a receiver of the gateway node.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes and providing a plurality of physical radios in each sector of the beam forming receiver hardware node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein 16 physical radios are provided per beam of the beam forming receiver hardware node.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes and providing a plurality of physical radios in each sector of the beam forming hardware receiver node wherein the plurality of radios have spectral diversity among them.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes providing a plurality of physical radios in each sector of the beam forming hardware receiver node implementing an antenna training phase for the receiver to map out null areas and in an operating phase steering at least one beam to avoid at least one null area mapped during the training phase.

The present disclosure describes a method relating to a real time location system using data communication nodes that communicate using the Bluetooth Low Energy protocol BLE the method according to one disclosed non limiting embodiment of the present disclosure can include providing a virtualized connection manager that manages connections of a plurality of leaf nodes to a receiver node in a TDM protocol.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one beam forming gateway node having a plurality of radios for collecting sectorized data from a plurality of leaf nodes and using a TDM protocol of the beam forming gateway node to enable the beam forming gateway node to handle a plurality of leaf node device connections per radio of the beam forming gateway node. In embodiments the plurality of connections per radio may comprise more than one more than ten more than one hundred or more than one thousand leaf node device data connections per radio of the beam forming gateway node.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one beam forming receiver hardware node having a plurality of radios for collecting sectorized data from a plurality of leaf nodes and using multiple radios per sector to enable long range communication between the beam forming receiver hardware node and the leaf nodes.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the range of communication between the beam forming receiver hardware node and a leaf node extends at least to at least one of ten meters twenty meters thirty meters forty meters fifty meters sixty meters seventy meters eighty meters ninety meters and one hundred meters.

The present disclosure describes a system for machine learning of the real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one beam forming receiver hardware node for collecting sectorized data relating to at least one leaf node a location processing engine located on a server that is remote from the at least one leaf node device wherein the location processing engine uses machine learning on the data flow collected by the beam forming receiver hardware node about the leaf node device to help determine the location of the leaf node and at least one leaf node wherein machine learning is also performed on at least one of the leaf node and the beam forming hardware receiver node. Thus machine learning logic may be tiered such that portions run on any of the cloud a reader node or a leaf node.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one gateway node for collecting sectorized data relating to at least one leaf node at least one leaf node that communicates using the Bluetooth Low Energy BLE protocol a location processing engine located on a server that is remote from the at least one leaf node device wherein the location processing engine orchestrates information for the gateway node at least one leaf node and at least one mobile application that presents information about the location of the at least one leaf node wherein the location processing engine includes an interpreter for interpreting heterogeneous languages used by the beam forming hardware receiver node the leaf node and the mobile application.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the interpreter handles at least one of code and logic that is at least one of customer specific and location specific.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the interpreter uses SCALA language.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the interpreter uses at least one Docker as an embedded container that includes logic interpreter on the local receiver.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one gateway node for collecting data relating to at least one leaf node at least one leaf node that communicates using the Bluetooth Low Energy BLE protocol and a location processing engine using a plurality of servers that are remote from the at least one leaf node device wherein the location processing engine load balances resources for a plurality of gateway nodes and wherein if a server of the plurality of servers becomes unavailable an alternate server is designated to manage data relayed by the gateway node that was served by the unavailable server.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one gateway node for collecting data relating to at least one leaf node at least one leaf node that communicates using the Bluetooth Low Energy BLE protocol and a location processing engine using a plurality of servers that are remote from the at least one leaf node device wherein the location processing engine load balances resources for a plurality of gateway nodes and wherein if a server of the plurality of servers becomes overloaded an alternate server is designated to manage data relayed by the gateway node that was served by the overloaded server.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include at least one gateway node for collecting data relating to at least one leaf node at least one leaf node that communicates using the Bluetooth Low Energy BLE protocol and a location processing engine located on a server that is remote from the at least one leaf node device wherein real time processing of location data about the leaf node and sensor data from the leaf node is distributed across the gateway node and the location processing engine.

The present disclosure describes a method for managing a work flow based on the real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing a location processing engine located on a server that is remote from the at least one leaf node device providing at least one gateway node for collecting data relating to at least one leaf node providing the location of at least one asset to an workflow management system and using the workflow management system guiding execution of at least one task of a workflow based on the asset location information. An industrial workflow may for example define work from start to completion with sequence of coordinated operations among sensors machines and people.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the asset is at least one of a hardware asset and a human asset. A workflow management system may include one or more information technology components including hardware and or software for assisting an enterprise or other user in managing a workflow such as a workflow involving one or more assets. Such a workflow management system may typically process inputs relating to a workflow such as handling alerts events and other inputs and provide direction assistance data or the like that assist the completion of a workflow such as by prompting a user as to the availability of information and guidance as to steps to complete the workflow. Workflow management systems may frequently relate to assets such as involving using assets to complete tasks manufacturing goods with assets using assets to perform services tracking assets reporting on information about assets and the like.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one gateway node for collecting data relating to a plurality of leaf nodes and providing a MAC layer designed to handle data connections to the receiver hardware node providing a virtual MAC address in the MAC layer to at least gateway node and accessing the gateway node by using the assigned virtual MAC addresses.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one gateway node for collecting data relating to a plurality of leaf nodes and providing a MAC layer designed to handle data connections to the gateway node providing a virtual MAC address in the MAC layer to at least one leaf node device and accessing the leaf node device through the gateway node by using the assigned virtual MAC addresses.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the MAC layer translates the virtual MAC address of the leaf node to an asset tag identifier.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node.

The present disclosure describes a method relating to a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing at least one gateway node for collecting data relating to a plurality of leaf nodes providing a virtual IP address to at least one leaf node device translating the virtual IP address at the gateway node into an asset tag identifier and accessing the leaf node device through the gateway node by using the assigned virtual IP address.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one gateway node for collecting data relating to at least one leaf node wherein a software language is provided to allow a user to at least one of query and control at least one of the leaf node and the gateway node based on at least one of an attribute and an event.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the attribute is at least one of the address the physical location the virtual location and a sensed condition of at least one of the leaf node device and the gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the event is at least one of a timing event and a sensed condition.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the gateway node is a beam forming gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the software language allows a user to at least one of schedule events query individual lead nodes query individual gateway nodes send commands to individual leaf nodes send commands to individual gateway nodes send commands to groups of leaf nodes in the system send command to groups of gateway nodes in the system and take action based on data transmitted by at least one of a leaf node and a gateway node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein a gateway node uses the software language to send an event notification to a remote server.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein a remote server uses the software language to request data from a gateway node identified in a registry.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein a remote server uses the software language to send a programmatic instruction to be executed by a gateway node.

The present disclosure describes a method of a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing a plurality of gateway nodes for collecting data relating to at least one leaf node configuring at least one leaf node to provide a rolling advertisement packet and using the rolling advertisement packet data to correlate information about the leaf node as the information is detected by a plurality of receiver hardware nodes.

The present disclosure describes a method relating to a system of real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing a plurality of gateway nodes for collecting data relating to at least one leaf node configuring at least one leaf node to provide a rolling advertisement packet having a time stamp and using the rolling advertisement packet time stamp data to synchronize information across components of the real time location system.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the real time location system further includes at least one of a location processing engine located on a server that is remote from the at least one leaf node device and a Bluetooth Low Energy BLE enabled user device having an application for communicating with at least one of the receiver hardware node and the at least one leaf node to display the current location of the at least one leaf node.

The present disclosure describes a method relating to a system of real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing a plurality of beam forming gateway nodes for collecting data relating to at least one leaf node identifying a characteristic of the environment of the leaf node and configuring at least one of a number of radios a number of sectors a type of antenna and a configuration of antennas based on the identified characteristic to facilitate communication between the gateway node and the leaf node.

The present disclosure describes a method of a system for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include providing a plurality of gateway nodes for collecting data relating to at least one leaf node and using the rolling advertisement packet data from a moving leaf node device to identify the leaf node as being present in the proximity of a gateway node. HM Why is this transient Please explain

The present disclosure describes system the system according to one disclosed non limiting embodiment of the present disclosure can include a gateway node that is configured to search for proximate Bluetooth Low Energy BLE devices through a sectorized spatial region and across a range of frequency spectral bands.

The present disclosure describes system the system according to one disclosed non limiting embodiment of the present disclosure can include a gateway node that is configured to search for proximate Bluetooth Low Energy BLE devices through a sectorized spatial region and across a range of frequency spectral bands in order to establish communication with at least one such BLE device and a channel switching facility of the gateway node that upon establishing communication with the BLE device switches to a data channel for continued communication with the BLE device.

The present disclosure describes system the system according to one disclosed non limiting embodiment of the present disclosure can include a plurality of gateway nodes each configured to interact with at least one leaf node device and a synchronization facility of such gateway nodes for exchanging PTP synchronization data among them to synchronize the gateway nodes to nanosecond resolution and a correlation facility for correlating sampled I and Q components of signals received by the gateway nodes from the leaf node device to determine the leaf node device position at a point in time.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the correlation facility is located on a server that is remote from the gateway nodes.

The present disclosure describes system the system according to one disclosed non limiting embodiment of the present disclosure can include a plurality of gateway nodes each configured to interact with at least one leaf node device and a synchronization facility of such gateway nodes for exchanging PTP synchronization data among them to synchronize the gateway nodes to nanosecond resolution wherein once synchronized the gateway nodes test interference with each other by simultaneously transmitting a packet and a plurality of gateway nodes monitor and sample the I and Q data with respect to the packet and wherein the system uses the interference test data to determine a map of gateway node interactions.

The present disclosure describes a method of a system of communication in an asset management system having a plurality of leaf nodes that communicate via Bluetooth Low Energy BLE the method according to one disclosed non limiting embodiment of the present disclosure can include detecting a collision of messages emitted by two leaf nodes on the same channel at the same time and upon detecting the collision having each of the leaf nodes wait a random amount of time then retransmit the messages thereby reducing the likelihood of a second collision of the messages.

The present disclosure describes a method of relating to an asset tracking system having a plurality of leaf nodes associated with a plurality of assets the method according to one disclosed non limiting embodiment of the present disclosure can include providing a plurality of gateway nodes for collecting data relating to at least one leaf node providing a geo location system of the gateway nodes to establish the positions of the gateway nodes and storing the positions of the gateway nodes in a data storage facility such that the positions can be used as references in determining relative locations of the leaf nodes.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device and at least one gateway node for collecting data relating to at least one leaf node wherein the location processing engine processes information relayed by the gateway node to facilitate determination of the location of the leaf node wherein the communication between the gateway node and the leaf node device is configured to hop between available BLE frequencies.

The present disclosure describes a system for real time location of at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device and at least one gateway node for collecting data relating to at least one leaf node wherein the location processing engine processes information relayed by the gateway node to facilitate determination of the location of the leaf node wherein the priority of communication between the gateway node and a leaf node device may be managed based on a communication bit that designates a message as a high priority message.

The present disclosure describes a system for real time location of at least one leaf node device that communicates using the Bluetooth Low Energy protocol the system according to one disclosed non limiting embodiment of the present disclosure can include at least one gateway node for collecting data relating to at least one leaf node and at least one access point device for providing Internet access to a region in which the leaf node may be located wherein the gateway node is integrated as a card in the chassis of the access point device and the gateway node and the access point device communicate through the backplane of the access point device.

The present disclosure describes a system for managing data related to at least one leaf node device the system according to one disclosed non limiting embodiment of the present disclosure can include a location processing engine located on a server that is remote from the at least one leaf node device at least one point of interest POI device for collecting data relating to at least one leaf node device and transmitting the collected data with a timestamp using Bluetooth Low Energy BLE at least one reader node device for receiving the collected data from the point of interest POI device using BLE and transmitting the collected data to the location processing engine and a database of the known locations of POI devices wherein the known locations are used as a basis for determining the location of the at least one leaf node device that communicated with the POI device.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the point of interest POI device uses one of an omnidirectional antenna and a directional antenna.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data is at least one of signal strength information proximity information and phase angle information.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data is collected via BLE communication signals from the leaf node device.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data is used as a basis for determining the location of the at least one leaf node device.

The present disclosure describes a method for real time location of at least one leaf node device the method according to one disclosed non limiting embodiment of the present disclosure can include taking at least one of signal strength information proximity information and phase angle information collected via Bluetooth Low Energy communication signals from the leaf node device delivering the collected information to a processing engine that is remote from the leaf node device and processing the collected information in real time to determine the location of the leaf node.

A further embodiment of any of the foregoing embodiments of the present disclosure may include time stamping the collected information with the time of collection.

A further embodiment of any of the foregoing embodiments of the present disclosure may include delivering to the processing engine at least one of identification and location information relating to the point of interest device that collected the information from the leaf node device.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the information about the leaf node device is collected by at least two collection devices wherein each collection device is from the group consisting of reader nodes and point of interest devices.

A further embodiment of any of the foregoing embodiments of the present disclosure may include processing the collected information together with the location information about the point of interest device to determine the location of the leaf node device.

A further embodiment of any of the foregoing embodiments of the present disclosure may include calculating an average location for a leaf node device based on two or more determinations of location for the leaf node device wherein each of the determinations of location is based on data from a different one of the two or more collection devices.

A further embodiment of any of the foregoing embodiments of the present disclosure may include storing the calculated average location of the leaf node device in a database.

The present disclosure describes a system for managing assets the system according to one disclosed non limiting embodiment of the present disclosure can include a leaf node device associated with an asset a plurality of POI devices each at known locations the POI devices each having a respective boundary and collecting data relating to the asset when the leaf node device is within the respective boundary a location processing engine remote from the leaf node device and the plurality of POI devices and a database of known locations of the POI devices wherein each POI that has collected data relating to the asset communicates the collected data relating to the asset to the location processing engine wherein the location processing engine accesses the database and determines the location of the asset based on the collected data related to the asset and known locations of the POI devices.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the point of interest POI device uses one of an omnidirectional antenna and a directional antenna.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data is at least one of signal strength information proximity information and phase angle information.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data is collected via BLE communication signals from the leaf node device.

A further embodiment of any of the foregoing embodiments of the present disclosure may include a sensor associated with the asset the sensor detecting data of a condition of said asset.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the collected data relating to the asset comprises said data of a condition of said asset.

A further embodiment of any of the foregoing embodiments of the present disclosure may include a remote server in communication with the plurality of POI devices.

A further embodiment of any of the foregoing embodiments of the present disclosure may include situations wherein the location processing engine is on the remote server.

As compared to RFID asset management system a BLEATS system offers favorable alternatives. For instance BLE has a greater range than RFID. Therefore an object of the system described herein is to increase the range of communication of end nodes in a system such as an asset management system.

In addition to the readily apparent advantages of a longer range of communication a longer range in such a system results in a system requiring fewer control devices. Therefore another object of the system disclosed herein is to enable management of large numbers of assets through an efficient architecture that uses relatively few reader nodes such as compared to conventional RFID or WiFi systems.

Also BLE interferes less with other devices than the prior art such as RFID. For example a BLEATS system provides for channel hopping to avoid signal collisions while active RFID does not. Therefore another object of the system described herein is to reduce interference that exists in asset management systems. For example when two BLE devices both transmit in the same geographic vicinity at the same time on the same channel then the messages can collide resulting in interference noise and potentially a meaningless garbled signal. If this happens then either the devices themselves may listen at the same time as they transmit or they may not do so. If the devices listen at the same time as they transmit then each such device may recognize the potential collision by recognizing that the device has emitted a signal at the same time and one the same channel as it has detected a signal from another device . Upon recognition the device may be programmed to retransmit the signal however there is a question as to when the re transmission should occur. To reduce the chance of a second collision each device may be programmed to wait for a random duration before trying again reducing the chances of a second collision. If the devices don t listen as they transmit then one of the devices in the intended audience such as a reader node may send out a message that indicates that whatever device tried to transmit on the specified channel at the specified time should wait a random amount of time then retransmit. By these and other methods collisions may be avoided.

Devices of the BLEATS system described herein most notably the leaf end node discussed herein can be powered through attached power sources including but not limited to battery power grid and solar cell rather than just received signal energy as is the case with passive RFID systems. Other approaches have been based on Wi Fi. While Wi Fi appears a good choice due to its decent range and the fact that it contains proper protocols at all levels of the software stack Wi Fi demands high power rending a system based on purely battery powered Wi Fi devices infeasible. Therefore another object of the system described herein is to improve power consumption of BLEATS system and the devices thereof.

Since communication in a BLEATS described herein is wireless the system can be configured and controlled remotely and it could configure itself dynamically through self discovery. There is no need for physical wiring to install and re arrange. Thus another object of the invention is to diminish the need for mechanical parts in asset management systems thus making such systems easier to manage.

While many different sorts of prior art devices exist they all have disparate means of communication. Embodiments of the system disclosed herein uses TCP IP for all communication above the MAC layer. Thus another object of the system disclosed herein is to unify and simplify all communication thereby streamlining operation of the system.

A BLEATS system according to the methods and systems disclosed herein may behave similarly whether it currently registers ten reader nodes discussed more fully below or one million. This is because the operators can increase the number of cloud servers even while the system is active. Thus another object of the invention is to increase the scalability of asset management systems including offering scalability during operation.

A BLEATS of the type described herein is flexible enough to adapt to future needs. If there is a new device that needs to be supported then the operators simply add the code for that support into the cloud servers.

A BLEATS system as described herein may be fault sensing and fault tolerant at many levels. Thus for example if any device of the system fails other devices compensate and pick up its work inasmuch as possible. Thus another object of the system described herein is to improve operational efficiency security and redundancy.

The above and other object of the system described herein will be apparent to one skilled in the art upon reviewing this disclosure.

Methods and systems disclosed herein include methods and systems for real time location. The term real time as used herein should be understood except where context indicates otherwise to refer to events happening concurrently or simultaneously or happening closely in time such as in near real time such as to the level of sub seconds to seconds resolution.

Methods and systems disclosed herein include methods and systems for managing information relating to one or more leaf nodes. References to managing information collecting information processing information presenting information or the like relating to a leaf node throughout this disclosure should be understood to encompass except where context indicates otherwise information about the location of a leaf node information about the direction velocity acceleration or other motion of a leaf node location related events relating to a leaf node such as the leaf node crossing a boundary or entering a zone information about other events of a leaf node such as turning on or off waking up going to sleep and the like information about states of a leaf node such as power status battery status quality of data connection schedule status and the like and data collected by or from or transmitted by the leaf node such as advertisement packets data from sensors associated with the leaf node or the like . A leaf node may also be referred to as a tag a leaf sense tag or LST .

References throughout this disclosure and the claims to a processing engine a location processing engine a processing pipeline a cloud processing engine a server based processing engine a cloud based processing engine a cloud location engine and location engine and cloud server are synonymous with one another and should be understood to encompass one or more data processing or storage modules applications components services resources and the like that may be disposed in a cloud computing or similar environment with one or more servers for processing data collected from or about one or more devices of the system including leaf nodes or data processed by collected from transmitted by or collected about one or more devices of the system including gateway nodes such as for determining locations of one or more devices of the system including leaf nodes determining or processing events relating to one or more devices of the system including leaf nodes managing or processing information about a device of the system including leaf nodes or the like and references to any of the foregoing should be understood except where context indicates otherwise to encompass any of them.

References throughout this disclosure to a gateway node a receiver a receiver node a gateway a leaf node reader gateway an LNRG a gateway device a reader node a reader or the like should be understood to encompass a device that collects processes manages or transmits data collected from or about one or more leaf nodes and optionally handles the exchange of data with one or more other gateway nodes and or with one or more cloud resources such as a cloud processing engine and references to any of the foregoing should be understood to encompass the others except where context indicates otherwise. References to a beam forming receiver node a beam forming hardware node a sectorized receiver node and the like should be understood to encompass certain embodiments of such a gateway node that involve formation of defined sectors around the gateway node such as by directing beams of one or more antennas to those sectors.

References throughout this disclosure to an asset should be understood to encompass except where context indicates otherwise the various types of assets that may be managed tracked and the like such as by or for an enterprise such as human assets such as workers who complete various workflows of an enterprise and other physical assets such as inventory assets manufacturing assets e.g. tools equipment components sub components materials and the like product assets and the like . Any of the devices in the system herein described are capable of BLE communication and may also be referred to as a BLE device.

In all dotted two way arrows indicate communication between or among relevant devices. For readability of the figure not all communication pathways are shown. The absence of a dotted line between two components does not indicate the inability of the components to communicate with one another. Embodiments may comprise a plurality of leaf nodes several shown herein as and . References to a leaf node a leaf sense tag an LST a tag or a leaf node device throughout this disclosure and the claims are synonymous with one another and may encompass various forms of devices tags e.g. asset tags sensor enabled devices sensors or the like that may be disposed in various environments and that are managed according to the methods and systems disclosed herein such as for asset location data collection data storage asset tracking or the like and references throughout this disclosure to any of the foregoing should be understood to encompass any such items except where context indicates otherwise.

In embodiments the leaf nodes collectively referred to as monitor and communicate information which in embodiments is real time communication regarding assets and collectively referred to as and thus are secured to or are in proximity to assets . An asset may be anything object to be monitored in a BLEATS or monitor and control system. Examples would include any object in an industrial manufacturing or logistical workflow. Assets may be people wearing or in proximity to a leaf node. Some types of assets will be described in connection below in connection with illustrations of BLEATS and the other monitor and control systems described herein. There are various configurations of leaf nodes in relation to assets. The leaf nodes are either in the same area as and in communication with the asset as shown by leaf node and asset have some sort of physical connection to the asset while remaining in the assets area as shown by leaf node and asset are affixed or otherwise mounted to the asset as shown by leaf node and asset or are within the asset for example within a shipping container or palate as shown by leaf node and asset .

Sensors and collectively referred to as are in communication with the leaf nodes. There are various configurations possible. In embodiments the sensor is in proximity to and in communication with the leaf node as shown by sensor and leaf node . Another embodiment is shown with sensor which is physically connected to leaf node . Another embodiment is shown with sensor which is affixed to or otherwise mounted to leaf node . Another embodiment is shown by sensor which is within leaf node . Another embodiment is shown by sensor which is within asset and in communication with leaf node . The preceding are non limiting illustrations and the skilled artisan will appreciate that sensors can be placed in a variety of locations and can exist in multiple configurations with respect to the leaf nodes and in various embodiments they communicate via BLE or other methods with leaf nodes and detect information indicative of the asset such information which will be discussed more fully below.

Reader nodes are shown as and and are collectively referred to herein as . In embodiments communication between the leaf nodes and the reader notes is via BLE protocols or other methods or protocols.

In embodiments the system may comprise one or more points of interest POIs also referred to herein as location markers . A POI has a known location. In embodiments the known location may be fixed. The known location may be associated with areas where a workflow occurs or a particular step of a workflow occurs. The known location may be associated with areas within which reader nodes and leaf nodes are deployed. The locations of POIs may be stored in a table database or map a given POI may know it s own location and communicate it during provisioning a static GPS coordinate may be placed in a POI or the location may be determined based on other factors. The POIs may communicate with both leaf nodes and reader nodes and measure their respective signal strength and orientation or signal source as described elsewhere herein. The large number of leaf nodes that may be seen by a POI may help in characterizing the POI s antenna radiation pattern in it s given environment.

In embodiments a POI may be a reader node with a known location. POIs that are also reader nodes may communicate with other POIs with leaf nodes with sensors with reader nodes and with the cloud server . Essentially these POIs may communicate in the same manners as the other reader nodes described herein. In embodiments a POI may a leaf node with a known location. POIs that are leaf nodes may communicate with other POIs leaf nodes sensors and reader nodes . However POIs that are leaf nodes do not have the capability to communicate directly over the Internet to the cloud server . Information from these POIs is shared with a reader node which communicates the information to the cloud server . However the leaf node POIs may extend the range of a BLEATS at reduced cost as compared to deploying additional reader nodes due to the reduced electronic complexity associated with the lack of additional connectivity.

As mentioned above leaf nodes may communicate directly with reader nodes via BLE protocols or other methods or protocols as shown by the dotted line connecting leaf nodes and . Also leaf nodes may communicate directly with other leaf nodes via BLE protocols or other methods or protocols as shown by the dotted line connecting leaf nodes and . Reader nodes may communicate directly with other reader nodes via BLE protocols and other methods or protocols as shown by the dotted line connecting with . Thus data exchange in the system described herein has various paths both direct and indirect as will become even more fully appreciated below . Regarding reader node to reader node communication reader nodes may communicate with each other using a variety of protocols including but not limited to 802.11 802.3 BLE. In embodiments such inter reader node communication is heterogeneous for example it may be that one reader node communicates with a second reader node via 802.3 and that second reader node communicates with a third reader node via BLE.

Adding among other things to the various communication pathways described above is at least one cloud server . While only one cloud server is shown it is to be understood that the system may comprise multiple servers which may be located in a single cloud or in a plurality of clouds which may be located on public cloud computing infrastructure e.g. Amazon private cloud computing infrastructure or a combination of those. Cloud server as used herein means at least one server except where context specifically indicates otherwise. Cloud server s comprises or accesses database . Database may contain a wide range of information about the components of the methods and systems disclosed herein the data collected by or about them or relevant data from other systems applications or processes. For example database may contain the unique identifiers and locations of devices of the system status information from or about any of them and information collected by or about them including sensor information. Database may in particular catalog information about the leaf nodes and reader nodes . The database may be a unified database or it may comprise a distributed collection of various data storage resources such as on device memory file system storage server based storage disk attached storage network storage or a plurality of linked databases among others. The cloud server may communicate with a other cloud servers b the reader nodes c operators collectively referred to as d leaf nodes and e POIs such as via Internet or other networking protocols. Cloud server being able to communicate with the various devices of the system may thus be an intermediate node in the communication pathway between any other devices described herein including other cloud servers . For example leaf node may send data via BLE directly to reader node which in turn communicates the data to cloud server and cloud server may send the data to another reader node or leaf node which can be used for example to control the operation thereof. This operational pathway and exchange of data is allowed to occur in this example even though leaf node may not in some instances be in direct communication with leaf node or reader node . In embodiments reader nodes may accrue data from multiple LSTs into a single message and processes it locally as much as possible before sending it to a cloud server. As mentioned herein reader nodes may use Internet protocol across the Internet to other cloud servers. The leaf nodes after some processing may upload various data to the reader nodes which after some local processing may push this data to the cloud servers. Operators may query the cloud servers for various data which the cloud servers have accrued from the reader nodes.

As discussed above the reader nodes may connect via an Internet protocol across the Internet to the cloud server s . In embodiments the leaf nodes after some processing communicate various data to the reader nodes which after some local processing push this data to the cloud servers. Operators may query the cloud servers for various data which the cloud servers have accrued from the reader nodes .

The system effectively enables users accessing the Internet through computers or mobile devices to communicate through the cloud servers and gateways with the leaf devices. The leaf devices connect to physical objects or locations and contain various sensors which allow them to monitor local information which users can now access and in some cases take local action which users can now direct.

With respect to the interaction with the operators the cloud server s interaction with operators may be via mobile devices collectively running application . In embodiments reader nodes may communicate directly with mobile devices via BLE Internet protocols or some other means and similarly leaf nodes may communicate directly with mobile devices thereby providing operators with direct access to relevant devices of the system. Mobile devices may include any type of computing or input device including desktop computers laptops PCs tablets smartphones and the like.

Another category of devices such as barcode readers passive RFID readers and the like herein referred to as out of system OOS devices are represented in as . OOS devices may communicate with any device of the system described herein via any protocol described herein and any other available method or protocol as applicable. In embodiments the leaf nodes are able to send messages sometime unsolicited to OOS devices . In an illustrative and non limiting example a barcode reader may provide a sequence number of an asset which may provide additional information and allow the system to link the specific asset with that location.

While many of the elements described in and herein are shown in a one to one correspondence such as one leaf node for each reader node this is not a requirement for the system. For example it may be the case that a system comprises five leaf nodes communicating with two reader nodes.

Also all references to communicate including any roots nominalizations and conjugations thereof are meant to encompass two way communication. The communication may be direct or indirect via an intermediate device such as for example cloud server . Further for ease of viewing all possible communication pathways shown in via dotted lines for some instance are not shown. A lack of a dotted line between two devices on does not indicate any lack of ability to communicate between devices as the above discussion makes clear.

Returning to the leaf nodes the leaf nodes are BLE enabled in embodiments. In embodiments the leaf nodes are battery powered or electricity grid powered. In embodiments leaf nodes contain at least one processing unit. In embodiments a leaf node may include a microcontroller and embedded software that allows the leaf node to operate independently of outside control. In embodiments a leaf node may include a sensor or optionally multiple sensors of different types noted throughout this disclosure which may be connected to the microcontroller such as by the GPIO general purpose input output capability of the microcontroller by serial peripheral interface SPI or by inter IC bus I2C a System management Bus with a master slave type protocol topology and one or more batteries. A leaf node may also have a memory such as for programming code for the leaf node or for data logging such as logging inputs from various sensors logging operating parameters and history or the like. Leaf nodes may exist outside of a system described herein such as a BLEATS or be may be transient in the BLEATS. This is because embodiments herein such as the BLEATS described herein detects advertisements of leaf nodes and may integrate them into the BLEATS itself aspects of which will be more fully described below. The skilled artisan will appreciate that in BLE there are 40 channels 0 through 39 which exist in spectrally different frequency region of the 2.4 GHz band that is 83.5 MHz wide ISM band. Channels 37 38 and 39 are advertisement channels and the other channels are data channels. Thus leaf nodes as with any device of the system may function without being explicitly deployed as part of the BLEATS. Leaf nodes may be associated an asset s or otherwise identified by the asset s it monitors and or with which it communicates. Every message propagated in the BLEATS system has a unique 128 bit identifier msg id whether the message originates from a leaf node a reader node or a cloud server. This includes the 64 bit device ID of the device that originated the message and a 64 bit unique timestamp. In embodiments messages that lack the msg id may be invalid and may be discarded as such.

As mentioned above leaf nodes may communicate either via a physical connection or a wireless connection including BLE with sensors . Sensors are within in proximity to or are secured or otherwise applied to an asset to detect conditions of conditions surrounding or conditions affecting the asset . Sensors may detect such conditions as temperature humidity light sound wind electric field magnetic field movement pressure weight presence of smoke presence of particular molecules or chemicals presence of radioactivity presence of contamination presence of biological materials and the like. As such sensors may be thermistors capacitive sensors piezo electric sensors optical sensors microphones weather sensors including barometers wind sensors temperature sensors humidity sensors and the like chemical sensors MEMs based sensors gyroscopic sensors magnetic sensors biological sensors pressure sensors transducers acoustic sensors radioactivity sensors acidity sensors and accelerometers among others. Location can also be sensed by methods disclosed herein as well as via GPS each of which may be referred to herein as a location sensor.

A reader node may include a microcontroller unit or MCU with associated memory and data storage. The reader node may include beam forming elements such as multiple BLE physical radios or a single radio e.g. an nRF51822 from Nordic Semiconductor for communication with one or more leaf nodes . For communication with the cloud server the reader node may include one or more of an Ethernet interface e.g. a Gigabit Ethernet interface with PoE Power over Ethernet connected to the MCU with an USB interface a Wi Fi client and the like. In embodiments the MCU is a digital programmable automaton that runs an embedded software system such that the MCU operates automatically and independently of operator control according to a programmed set of rules in response to inputs collected by the MCU . This automaton may contain a plurality of microcontrollers and various forms of memory including SRAM DRAM uSD and SSD. These digital and software elements are except as otherwise specified off the shelf and well known and well understood in the art. The MCU controls the physical components of the reader nodes such as components for beam forming for sending and receiving signals for handling power and the like through various electrical components such as digital analog converters referred to as DACs. In embodiments when a reader node establishes communication with at least one cloud server the cloud server directs the reader node to take action or to provide the cloud server with data. Based on its configuration which will be more fully described in connection with various embodiments disclosed herein a reader node may send notifications to a cloud server .

Referring back to operators may interact with the system via an application running on a mobile device. It should be noted however there are different layers within the system and different types of interaction that can be undertaken with the system and among the components of the system such as interactions at the physical layer e.g. bit level wireless data transmissions between LNRGs and LSTs interactions at the data link layer e.g. media access control layer interactions and logical link control layer interactions higher level network and transport layer interactions such as involving use of the conventional TCP IP stack and presentation and application layer interactions. A significant advantage of the system is the available use of the conventional TCP IP stack for communications above the physical and MAC layers of communication. The use of the TCP IP stack in particular allows a wide range of conventional applications and systems to interact with the system in a standardized way. This standardizes the communications and management thereof and leverages existing protocols and the advantages of those protocols. Except where called out herein it should be understood that the TCP IP stack and the various network protocols supported by it may be employed in connection with the methods and systems disclosed herein.

In various embodiments an application that uses or interacts with the system disclosed herein may be run or resident on various devices of the system i.e. reader nodes deployed with the system mobile devices and servers such as cloud servers or it may run on external infrastructure and interoperate with the system. Applications may in embodiments include user interface elements that allow users to undertake a wide range of actions with respect to system components such as the leaf nodes reader nodes cloud server or server based components as well as with various data that is collected processed handled and reported by those devices. Users may for example and without limitation view one or more leaf nodes or groups of nodes view locations of the leaf nodes view data e.g. sensor data collected by leaf nodes view nodes by their relationship or proximity to one or more reader nodes and the like.

In embodiments data from or about the components of the system may be provided through one or more application programming interfaces APIs such as provided in connection with one or more servers one or more reader nodes or one or more leaf nodes. Such APIs may for example allow developers to interact with the system or its components such as to obtain data such as location data with respect to leaf nodes or reader nodes feeds of sensor data from leaf nodes or the like that is transmitted from the system or its components to monitor processes undertaken within the system to send instructions to the system or components thereof or the like. For example a developer of an application may use an API to program an application to pull data from a server of the system for use by an application such as data about the current location of certain leaf nodes such as to trigger a routine or process of the application when a particular leaf node arrives at a particular location e.g. in proximity to a particular reader node . A wide range of APIs may be provided to allow interaction with the system and its components such as ones for querying reader nodes or leaf nodes about location or other data APIs for sending certain kinds of instructions to reader nodes or leaf nodes APIs for managing aspects of the system or its components e.g. managing power levels and many others.

A wide range of applications may be supported by the system with the needs of a particular application being served by accessing data such as through APIs that is handled by the various components of the system and with the user interfaces of such applications being configured to use or display the data in a manner suitable for the needs of the particular user. For example an industrial workflow application such as for managing an assembly line may take a feed of data from the system indicating where certain assets which are tagged with leaf sense tags are currently located within a factory and the application may handle the location data according to the needs of the user such as by graphically displaying the locations of the assets to users on a display screen by storing the locations in a database table by triggering events within a process based on the locations or the like.

In certain embodiments an application may be used to control various system components such as to instruct reader nodes or leaf nodes to undertake certain actions to provide certain data or the like. Such control may be undertaken by an operator within a user interface such as displayed on a control screen or dashboard or it may be undertaken using programmatic control such as by providing instructions based on an event that is triggered by or within the system or by an external trigger. For example an application might control a sensor on a leaf node such as by indicating when the leaf node should undertake data collection with that sensor.

In embodiments an operator may use an application layer Layer 7 protocol to send various directives to the system such as in connection with various BLEATS system embodiments described herein. In such embodiments an operator can for example select some set of leaf nodes or reader nodes to which to promulgate a sequence of queries and directives. In embodiments this may be undertaken programmatically using a programming language by which the operator may specify directives based on responses to queries. In embodiments an application may support various application and end user processes. For each specific application communication partners may be identified quality of service may be identified user authentication and privacy may be handled and any data syntax requirements may be specified. Among other things application layer programming may provide application services for file transfers e mail and other network software services.

In embodiments operator s accessing a BLEATS through a cloud server may use an HTML encapsulated graphical user interface that allows the operator s to navigate quickly through all of the devices in the system that operator s have the privilege to access. Such an interface may allow such operator s to rapidly assess critical data such as which devices are currently active the locations of those devices their battery lives and the like.

In embodiments operator s of the system may programmatically control the system using a control language such as a BLEATS Programmatic Control Language BPCL . Such a language may allow such operator s to program the system to perform tasks including but not limited to scheduling events querying individual devices in the system sending commands to individual devices in the system sending commands to groups of devices in the system taking action based on current data and the like.

Examples of lines of pseudo code for such a programmatic control language in this case using PERL language code are as follows 

These lines instruct the system to take various actions such as waiting until 2 00 a.m. listing all devices in the system listing low battery items and mailing operators indications of low battery devices i.e. ones with battery status below twenty percent power .

While the needs of a wide range of such applications can be configured at the application layer Layer 7 taking advantage of the underlying use of a conventional TCP IP Internet stack interactions can be enabled at other layers of the networking stack such as by providing direct physical layer connections to LSTs or LNRGs by allowing interactions with data at the MAC layer or by facilitating use of other layers in the conventional networking stack.

A significant advantage of the system is that communications layers the TCP IP stack above the physical and MAC layers of communication. This standardizes the communications and management thereof and leverages existing protocols and the advantages of those protocols. Except where called out the TCP IP stack and the network protocols it supports are industry standards and completely known and understood in the art.

In embodiments the system is able to connect with a very large number of peripheral devices as compared to conventional Bluetooth platforms. To enable management of connections to those devices a connection manager also referred to herein as a virtual connection manager or VCM may handle the virtualization of connections to each of the devices. Before a connection is set up the connection manager queries the cloud server to authenticate the connection. The Cloud server sends the authentication status and may also send the commands for operations to be performed by or with respect to the peripheral device. An operation could have a single command or a sequence of commands. Commands may be for example read and write commands to certain characteristics of peripherals and may be BLE specific. Commands may be communicated via messages. In embodiments the messages may be transmitted in sequence. In embodiments a command is contained in a single message.

As the connections are established connection manager may use state tables to record of the state of each connection. Whether the peripheral device such as a leaf node is authenticated or not the state of the device is registered in the state table. If a need to communicate with a peripheral device arises then the connection manager may reach out to BLE interface module which may try to check if there is a free physical connection resource PCR . If there is a free PCR available then the communication goes through else it is held in a backup state. Eventually when a free PCR is available this backed up message to the peripheral device is pushed through. If there are number of backed up messages are present then the state holds the priority of service and gets pushed out based on the priority by the decision block in conjunction with scheduler .

Each radio chip may concurrently connect with one or more peripherals in embodiments up to 8 peripherals concurrently. An available concurrent connection may be referred to as a physical connection resource PCR or connection resource and is the physical BLE wireless radio connection. The BLE Interface may keep track of the number of active connections and make this information available to VCM.

In an illustrative and non limiting example a VCM with a total of 8 possible physical connection resources may have a task of collecting pressure measurements from 12 peripherals 12 tasks in total . Initially there may be no peripherals connected to the VCM such that all of the 8 connection recourses are available. The VCM may start by establishing communication with 8 of the 12 peripherals to complete tasks 1 through 8. The 9th task tasks 9 through 12 remain pending will be waiting for the first of the 8 connection resources to complete its current connection and become available. As the pressure measurements are received from a peripheral the connection resource may become available and may be used for the next text such as connecting to the 9th peripheral.

A main task may be broken into multiple sub tasks. A connection resource may be used for a sub task and released. For example in embodiments taking a temperature measurement may include the following sub tasks a initiate a temperature measurement b allow a period of time to elapse c read the measured temperature. In this example the VCM will use the connection resource to connect to the peripheral and send a command to start the temperature measurement. While waiting the VCM may relinquish the resource by disconnecting from that peripheral. This would make that resource available for another task with another peripheral. At an appropriate time the VCM may use a free connection resource to complete the pending task of reading the temperature by issuing a command to read the temperature from the first peripheral and then relinquishing the connection resource and disconnecting from peripheral.

The VCM supports two type or modes of virtual connections to end nodes or peripheral devices . The first is a monitoring mode in which peripheral devices are authenticated and registered with the cloud server . The advertisement data from peripheral devices is reported to the cloud server for tracking and location determination purposes. The second is an action mode in which the peripheral devices are authenticated and registered with the cloud server and the VCM performs a series of specific tasks on them like temperature sensing or battery read etc.

The main components of VCM are as follows a State Tables VCM maintains the connection state of each peripheral device in state tables . The state information includes information like the registration status of a peripheral device its connection mode a queue of events commands for the peripheral etc. Peripheral state changes are triggered by events and commands b a Scheduler VCM implements a scheduler to periodically inject commands that act on peripherals device c a Decision Block This implements the logic to initiate maintain and terminate a large number of virtual connections over a limited set of available physical connections. It interacts with the BLE Interface block to communicate with the BLE stack. It also interacts with the cloud interface to access the cloud server located in the cloud and d a BLE Interface Module This module provides an abstraction of the BLE stack. Downstream it provides interfaces to one or more BLE drivers which execute the BLE protocol. It maintains information about which peripheral devices are reachable through which BLE driver . It also maintains the BLE connection resource information. This information includes current usage levels information about resources that are free etc. Typically the connection resources are time slots that are used by lower level BLE drivers to maintain concurrent connections.

In embodiments a virtual connection to a peripheral device is established as soon as the peripheral device comes into radio presence of a reader node. The virtual connection to the peripheral device is terminated when the peripheral device goes out of range for a specified amount of time. The VCM can support multiple connections over single or multiple radios.

The VCM maintains the state of every peripheral device in a state table. Events and commands for a peripheral trigger a state machine that would appropriately update the state of that peripheral in the state table. Typical events include advertisement reports from peripheral devices responses from peripheral device to commands sent to them timer expiration etc. Commands may originate from the cloud server or may be generated locally as dictated by the cloud . Commands may be categorized as admin management commands and action commands that act on peripheral devices . Typical action commands may be reading sensor information such as a temperature reading or reading a shock level from a sensor. Admin commands may be used to dictate to the VCM the specifics of handling a peripheral device for example. Both events and commands may change the state of peripherals in the state tables . This is explained further with the aid of use cases noted below.

In one example the VCM gets advertisement reports from peripheral devices . It creates state table entries for them and sends authentication registration events to the cloud server using a cloud interface such as messaging or Representational State Transfer REST protocols over TCP IP connection on Ethernet or Wi Fi. The cloud server authenticates peripheral devices and sends out registration commands for them. For those peripheral devices that the cloud server does not want the VCM to make virtual connections it sends out commands to black list them. The VCM acts on both types of commands to change the state of peripheral devices. For authenticated peripheral devices the cloud server further specifies periodicity of advertisement report which the VCM duly makes note of in its state tables . From then on the VCM reports advertisement data for authenticated peripheral devices at the specified periodicity.

In a second scenario the event and command exchanges happen as in the first case noted above. For sensor peripherals which in embodiments are sensors communicating directly or via a leaf node leaf node reader node combination or a reader node the cloud server sends an action command that specifies how often a particular sensor information is needed. The VCM processes the command and sets up the scheduler to locally inject sensor specific action command which basically triggers a change in state of the peripheral device at the correct time instant. The decision block acts on the state change and executes the logic to perform the correct peripheral operations as directed by the connection state.

As an example the cloud server may direct the VCM to read temperatures from 100 different sensor peripherals. The command from the cloud triggers changes in the connection state of the target sensor peripherals. The decision block notices the changes and for each sensor peripheral changes the connection state to Waiting for Connection Resource . It then executes the following sequence for each sensor peripheral in that state. First it issues a command to BLE interface module to initiate connection. Next it waits for events from the BLE Interface module .

If the BLE Interface module has free connection resources to accommodate the request it initiates a BLE connection using the appropriate BLE driver . If it has no free resources it send a back off message to the decision block . It also sends back any connection related events to the decision block . If the connection is successful at the BLE level the decision block moves the connection state of the sensor peripheral to Connection Established .

For those peripheral devices whose connection state is Connection Established the decision block initiates temperature read operations by issuing suitable command to the BLE Interface module . It waits for events which will trigger further state changes. On the receipt of events the decision block does the following. First if a successful read was indicated it sends the temperature data for that sensor peripheral to the cloud . If a successful read was not indicated it sends out an error report to the cloud . Then it initiates a connection termination.

On receipt of connection termination events the decision block goes through the process to schedule temperature read operations for sensor peripherals which are in the waiting for connection resource state.

In embodiments an operator may a Layer 7 protocol to sends broader directives to the system including the BLEATS system embodiments described herein. This system has its own protocol layer above TCP or UDP. In such embodiments an operator can select some set of leaf nodes or reader nodes to which to promulgate a sequence queries and directives. This provides for a programming language in that the operator may provide directives based on responses to queries. Note that in some embodiments the system uses the TCP protocol above the IP protocol. In other embodiments it uses the UDP protocol above the IP protocol. In some other embodiments it uses some other protocol over the IP protocol. In some embodiments system communication uses IP tunneling. In other embodiments it does not.

In embodiments operator s accessing a BLEATS through a cloud server use a graphical user interface such as an HTML encapsulated graphical user interface that allows the operator s to navigate quickly through all of the devices in the system that operator s have the privilege to access. Such an interface allows such operator s to rapidly assess critical data such as which devices are currently active the locations of those devices their battery lives and the like on a wide variety of devices that are HTML enabled such as browsers mobile phones tablets and other common computing devices.

In embodiments operator s of the system may programmatically control the system using a control language. Such a language allows such operator s to perform tasks including but not limited to schedule events query individual devices in the system send commands to individual devices in the system send commands to groups of devices in the system take action based on current data and the like.

This waits until 2 AM and then sends out a report of all devices in the system that have battery life of 20 or less.

In embodiments the operators may promulgate various commands to the at least one cloud server which either use those commands locally or push them on to the reader nodes . Also the system itself may be programmed i.e. with commands to execute in a given situation or based on certain conditions detected by the system. The commands mentioned above may include but are not limited to a queries for more specific data at either the cloud server the reader node or the leaf node level b commands to collect different data at either the cloud server the reader node or the leaf node level c instructions on how to process various data at either the cloud server the reader node or the leaf node level.

In embodiments when a leaf node communicates with a reader node the reader node directs the leaf node to take action or to provide the leaf node data. Based on its programming leaf node may send an event notification to the reader node with which it is communicating or to other devices in the system. In embodiments when particular events occur the leaf nodes send event data to the reader nodes . Also in embodiments when particular events occur the reader nodes send event data to the cloud servers . The definitions of events and the thresholds for sending such data may be preprogrammed into the various devices or supplied by the operator .

Some possible events will be more fully described herein however in general when a reader node sends a leaf node a request for data the leaf node responds with that data. When a reader node instructs the leaf node to run a programmed instruction the leaf node does so. A cloud server can request data from any reader node . A cloud server can also instruct such a reader node to run programmatic instructions.

Having established the devices of the system and the various communication pathways non limiting operational scenarios and other aspect of the system will be described. As the skilled artisan will appreciate there are currently two version of Internet Protocol IP IPv4 and a newer version called IPv6. IPv6 is an evolutionary upgrade to the Internet Protocol. A leaf node of the system disclosed herein may communicate through BLE protocols. However in embodiments not all leaf nodes have an IPv4 or IPv6 address natively. In embodiments of the BLEATS system the system provides an IPv4 or an IPv6 address to leaf node in the following way. A leaf node registers through a reader node into the BLEATS system. A cloud server provisions the leaf node by associating the unique ID of that leaf node with a unique IPv4 or IPv6 address. After such provisioning an operator or other devices of the system may access that leaf node by means of that IPv4 or IPv6 address. For instance when a reader node receives a communication from a leaf node of interest the reader node sends that communication to a cloud server along with the unique ID of the leaf node . The cloud server associates the information for that leaf node as keyed by its unique ID with the IPv4 or IPv6 address for that leaf node. When a device of the system or an operator queries or otherwise wishes to communicate with and or instruct a particular leaf node by its IPv4 or IPv6 address the cloud server associates that request with that leaf node s unique ID and facilitates the communication. In this manner the system may allow for all devices under it to be accessed via a single IPv4 or IPv6 protocol whether any given device natively supports that protocol or not.

As described above in embodiments devices may communicate indirectly with one another and as such in embodiments a reader node may not communicate directly with a cloud server . In an illustrative example one reader node may bridge the connection of another reader node to the cloud referred to herein as the first bridging reader node . In an illustrative and non limiting example as shown in the sending reader node send a message to the first bridging reader node that specifies the sending reader node s target as cloud server step . If the first bridging reader node is in direct communication with the desired cloud server and able to send the message the first bridging reader node sends the message from the sending reader node to the desired cloud server step . The first bridging reader node records data that it is acting as a bridge between the sending reader node and the cloud server such that in the future when the first bridging reader node receives a message from the sending reader node it may forward that message to the same cloud server step and alternately when the first bridging reader node receives a message from the cloud server that is intended for the sending reader node the first bridging reader node may forward that message to the sending reader node .

In other embodiments as shown in the illustrative and non limiting example of the sending reader node send a message to the first bridging reader node that specifies the sending reader node s target as cloud server step . However if the first bridging reader node is not in direct communication with the desired cloud server then the first bridging reader node returns a message to the sending reader node that conveys the information that the first bridging reader node a is not in direct communication with the desired cloud server and b that the first bridging reader node is using another reader node as a bridge i.e. a second bridging reader node step . If the second bridging reader node is in direct communication with the desired cloud server and able to send the message the second bridging reader node sends the message from the sending reader node to the desired cloud server step . The first bridging reader node then records that it is acting as a bridge between the sending reader node and the second bridging reader node and relays future traffic step . The second bridging reader node then records that it is acting as a bridge between the first bridging node and the cloud server and relays future traffic step . In embodiments when the first bridging reader node receives a message from the sending reader node intended for the cloud server the first bridging reader node forwards the message to the second bridging reader node . And when the first bridging reader node receives a message from the second bridging reader node with a message from the cloud server that is intended for the sending reader node the first bridging reader node forwards the message to the sending reader node .

In embodiments and as is evident a reader node need not communicate with a cloud server directly. In fact in some embodiments a reader node may lack this ability. In the case where a reader node does not communicate directly with a cloud server it may relay its communication through a chain of reader nodes where the last reader node in that chain communicates with a cloud server.

Reader nodes in communication with one another may use spanning tree algorithms to determine optimal communication paths between any two reader nodes and also between any reader node and a cloud server.

In embodiments a reader node and a leaf node in communication with one another exchange microsecond accurate timestamps to determine the delay between themselves in communication. This delay is used to synchronize their clocks or to otherwise account for the delay primarily by providing the leaf node and the reader node with allotted time windows where each should communicate with one another on any particular channel. The above allows the reader nodes in embodiments to listen for the respective leaf node at the optimal time on the optimal channel. Also the system may provide a schedule of communications to a reader node from applicable leaf nodes such that the applicable leaf nodes do not to overlap in transmitting on the same channel at the same time.

To optimize communication pathways and conserve power embodiments of the invention may limit the set of devices or device types with which a given reader node may communicate. In embodiments a reader node may contain an access control list of devices with which it is permitted to communicate and if a device not on the list then the reader node will not communicate with that device. Power conservation is a large concern. Devices including leaf nodes and reader nodes may run on batteries in which case power conservation is critical. Even for those devices that are tied to the power grid it is highly important to minimize power consumption since this lowers cost and decreases environmental waste heat.

In embodiments there may exist instructions regarding urgent or high priority situations where a reader node may override the access control list and establish communication even if the device is not on the list.

In a system according the embodiments described herein including BLEATS knowledge of the precise locations of system devices including leaf nodes and reader nodes may be important. In some cases positions may be determined by GPS devices within devices themselves or by operators programming the location into the device. However in some embodiments a device may not be equipped with GPS capability or with other means to determine its position.

In embodiments reader nodes are provided with an antenna structure which may be a pyramidal or horn antenna structure. Being so equipped a reader node may determine the location of a device such as a leaf node in embodiments based on the known radiation pattern of the antenna and the signal strength of the signal from a leaf node . However such antennas may not be not precise enough to determine the angle offset of the leaf node or other device from the reader node .

Returning to the reader node may drive its combination of antenna elements in particular ways causing a selected combination of amplitudes and phases at each specific element to produce a specific radiation pattern which in embodiments may result in beams and nulls in particular directions and optionally with specified polarization angles and or types linear right circular or left circular . In embodiments when reader node directs its energy into sector A between rays and it does not see any other device. However when reader node directs its energy into sector B between rays and it sees advertisements from leaf node . It then knows that leaf node is in B and it directs its communication towards that sector when it attempts to communicate with reader node .

Instructions within the system or promulgated in an application layer or by an operator can direct the antenna circuitry to shape this beam width to be between 0 and 360 degrees. The antenna s detect presence or absence via strength within patches of pattern and both presence absence and estimation of location by relative strength within multiple patches of pattern either via multiple settings of a single transceiver antenna array or by combining information from multiple radios and antenna arrays. Taken together this information provides precise angular information about the location of a node within the 360 degree angular sweep around the reader without requiring use of expensive RADAR technology.

It may be noted that narrowing the beam from an omnidirectional beam to narrow lobe can increase the range of communication for a particular antenna by a significant factor such as up to at least 200 feet in one direction.

In embodiments multiple BLE radios may be used in a reader node optionally each tuned to distinct BLE channels such as the advertisement channels 37 38 and 39. Also multiple BLE radios may be used in connection with each beam or antenna array so that each targeted angular sector e.g. 5 degrees of the 360 angle around a reader node handle by a particular antenna or antenna array has a collection of multiple BLE radios that are used for communication with the leaf nodes that are located within that angular sector. The combination of angular sectorization and the use of multiple radios having spectral variation i.e. using different communication channels allows a single reader node to handle a multiplicity of leaf nodes and the aforementioned benefits of angular sectorization namely extended range and precise angular location apply to communications by the multiple radios with leaf nodes located in a particular angular direction from the reader node . To communicate with the radios of the reader node leaf nodes advertise their presence with specific authentication ID and credentials on these channels. When reader node receives data from leaf node it establishes a handshake with that leaf node on the applicable advertisement channel. Then the reader node hands off communication with that leaf node to a data channel on the same radio on which communication was initially established or on a different physical radio.

In embodiments the antenna arrays function independently of one another and transmit and receive on potentially different frequency channels as per the BL BLE specifications. In embodiments the antenna arrays may transmit or receive omnidirectionally. In omnidirectional embodiments the antenna transmits and receives in all directions equally. However since this method sends energy everywhere it uses significant power and may not be desirable for all circumstances.

In other embodiments the antenna arrays may or transmit and receive BL BLE signal in a particular direction or beam as discussed herein such beam forming being well known and well understood in the art. The hardware devices used are off the shelf elements of technologies including but not limited to Gallium Arsenide High speed RF SW or RF MEMs and PIN diode network.

As shown in interacts with sector with sector and so on both and with sector and so on. Based on which antenna arrays receive a BLE signal from another device and the strengths of those signals the reader node can deduce the direction and distance of that other device. For example if the signal strength of a BLE node is known to decay over distance according to a known function e.g. based on electromagnetic principles then the strength detected at each array can be used to estimate the distance absolute or relative the signal has traveled from a particular node to each antenna. Having estimated distances of the node from two antenna locations a set of possible intersection points that correspond to the distances can be established e.g. two possible intersection points from a pair of antenna arrays which can be disambiguated such as based on known directional characteristics of the antennas themselves.

In embodiments a single location for a leaf node may be determined with two reader nodes of known locations given a constrained travel path for the leaf node. Alternately with three or more reader nodes of known locations a single location for the leaf node may be determined using the following formula RSSI Signal strength measured at the reader in dBm 10log 10 

The values for x y z may be computed numerically using a variety of common mathematical techniques. In one non limiting example these computations may be carried out as follows 

If directional antennas and or antenna arrays are present the angle of arrival in an indoor environment may be used along with the estimated distances to compute the location x y z co ordinates of the leaf node. The direction information reduces the error in the estimated distances especially in an indoor multi path propagation environment. In the illustrative and non limiting example of there are three reader nodes each having at least one directional antenna . The leaf node is located in the intersection of the fields of view provided by the directional antennas respectively. This area defined by the intersecting fields of view together with the respective distances d 1 d 2 d 3 of the reader nodes respectively from the leaf node may be used to estimate the location of the leaf node .

In a sectorized antenna scenario as shown in for example a reader node dedicates each of a set of BLE radios to direct its beam at a specific region or sector. These beams specifically listen to advertisements on channels 39 38 or 37 for connectivity to devices such as leaf nodes POIs or other reader nodes. The region around the reader node divides into a plurality of sectors depending on the beam width of antenna pattern.

In embodiments a given antenna array consists of a plurality of antenna elements where the elements may vary in properties such as directionality polarization and the like. These multiple antenna elements combinations may be used to create different overall signal strength patterns for the whole array. These patterns are stored in the reader node the cloud server or some combination thereof. Decisions made on the basis of patterns may be precomputed and saved in the system as a rule. Alternately they may be computed in real time. In embodiments instructed to do so a reader node may train by going through these patterns for each antenna element to determine which works best for a given antenna array taking into consideration factors such as a other devices such as leaf nodes and reader notes that the array is in communication with and what antenna pattern and polarization scheme they use b the angle of arrival of and direction of arrival for such communication with a given array c round trip time of flight for traffic with such a device d proximity sampling by multiple antenna arrays in a given window and or e historical data.

In embodiments sectorization works in conjunction with a given reader node directing its different radios to different directions. This enables the reader node to receive the same transmission on more than one of its antennas. By correlating the antennas physical orientations with the strength of the signal each antenna receives the reader node can mathematically determine directionality.

For example suppose for an antenna oriented in direction theta the signal strength is known based on the characteristics of the antenna to die down as the cosine of the offset from theta. Now suppose reader node has two antennas e.g. out of a larger set of four where one antenna orients east and the other orients north. And the strength of the same transmission from the eastward antenna is 1.66 times as much as that of the northward antenna. Then cotangent inverse 1.66 is approximately 30 degrees. So the direction of the transmission is about 30 degrees north of east.

As noted above due to factors that impact signal strength such as interference and varying power levels of nodes in some cases the system may be able to discern direction more effectively than distance from a signal transmission. Variations of transmitted signal strength would affect the received signal strength and thus the apparent distance but in most cases such variations would not affect the ratio of received signal strengths at the two antennas and thus the apparent direction can be estimated accurately even in the presence of variable signal strength information. However if two reader nodes receive the same transmission and they know their positions relative to each other then they can use the direction of the signal to each reader node to triangulate the exact position of the origin of the signal because the two angles coupled with the known position of the side between the two reader nodes define a unique triangle having a third vertex at the location of the node.

Thus in embodiments having more than one reader node multiple reader nodes may receive a signal from a device such as a leaf node. When BLE receivers on a plurality of the multiple reader nodes are able to determine the received signal strength and the apparent direction of a particular leaf node the multiple reader nodes may use this data to triangulate a location of a leaf node device.

The reader nodes receiving the signal can share this information with each other or with a device of the system which through processing can deduce the position of that other device by triangulation.

For each of its antenna arrays the system keeps a set of polarization patterns in its memory. If programmed and or commanded to do so the system trains a given array by causing the reader node to change the polarization pattern of each of the elements of that array and then measure the effectiveness of the new pattern against prior patterns. The system keeps track of the history of effectiveness of each pattern used for an array. Eventually the system can determine an optimal pattern. In embodiments the system stays with that optimal pattern however it will periodically perturb that pattern to determine if there has been a change such that this is no longer the best pattern to use.

A particular reader node is physically able to use any of these three methods. But it is programmed to use just one of them at any given time on any given radio. The reader node may use the same method or different methods on different radios or groups of them. The controllers i.e. the set of individuals programmable automata and the software running on those programmable automata acting in concert to determine how the BLEATS behaves determine which method to use based on various criteria including but not limited to desired antenna range desired power consumption and density of reader nodes in the vicinity density of leaf nodes in the vicinity.

In embodiments containing multiple reader nodes the system may determine location of the leaf nodes via other means described herein. shows such as embodiment. Reader nodes and are deployed in the system and are in communication with one another. Reader node has four antenna arrays . The area around this setup is divided into nine sectors . directs its energy mostly in sector in sector in sector and in sector . and cover sector and cover sector and cover sector and and cover sector . All four arrays cover sector . The other reader node has four antenna arrays . The area around this setup is divided into nine sectors . directs its energy mostly in sector in sector in sector and in sector . and cover sector and cover sector and cover sector and and cover sector . Leaf nodes and are within the range of reader nodes and . Reader node or any element of the system so programmed such as cloud server determines that leaf node is in its sector . Reader node determines that leaf node is in sector . Thus the system determines that the location of leaf node is in the area where there is overlap between sectors and . Similarly the system determines that leaf node is in the area where sectors and overlap and is determined to be in the area where sectors and overlap.

In embodiments antenna arrays are configured to transmit and receive directionally. For example antenna arrays may point upwards from a surface like a floor. In embodiments antenna arrays point outward from walls. In embodiments antenna arrays have some other geometric position and orientation. In embodiments different antenna arrays have different positions and orientations. For example in an office setting reader nodes may be placed just above the ceiling paneling with the antenna arrays pointing upwards. In this orientation the reader node may sense and control devices that are wired through the ceiling. For instance if another device i.e. a router is physically present in the ceiling the reader node can control and observe this router.

BLE like many other radio frequency communications systems breaks down a received signal into in phase and quadrature I and Q components. These are referred to herein as I and Q data. It may be noted that these phases are temporal and not spatial components. I and Q data provides the arrival time and phase of a signal in reference to a particular time base which takes the form of a combination of the local oscillator for a superheterodyne down conversion or a direct down conversion and the clock and timing signals from the analog to digital converters that are providing the I and Q data sampling. In embodiments the baseband may be a Gaussian Shift Key GSFK Modulator. When more than one receiver delivers I and Q data for signals received from differently positioned antennas and they use the same time base or an otherwise synchronized time base such as a local oscillator time base and A to D conversion time base the I and Q data can be combined in post processing to a measure the difference in arrival time of a signal at the various antennas thus inferring the direction to it b compute the signal and thus the receiving antenna pattern that would be received from any antenna that can be generated by summing various amplitude and phase combinations of the signals intercepted by the various elements and c i compute many such patterns and their received results simultaneously or ii such as in pre processing compute the signals to be transmitted from the antennas according to any such antenna pattern or as many independent signals via as many independent antenna patterns as desired. Thus for signals received on a particular receiver node post processing of appropriately time synchronized I and Q data can have the same effect as the beam switching approaches described above except that post processing can try all the beam patterns of interest on a single transmission from a leaf node simultaneously. It should be noted that it is not typically practical to correlate I and Q data from different receiver nodes since they use different clocks and sufficiently accurate synchronization mechanisms are impractical or exceedingly expensive. Thus one can typically perform I and Q based location with respect to signals received on a given device where different antennas run on the same local oscillator. However the methods and disclosed herein are intended to encompass multi receiver approaches to the extent that such synchronization is accomplished by methods known to those of ordinary skill in the art even if such methods may be expensive.

I and Q data may be somewhat inaccurate in determining position. To improve this a receiver node may use multiple antennas to receive I and Q data from a single source. Then the system may use probabilistic algorithms to arrive at a best estimate for that single source s position.

Alternately or in conjunction to this multiple receiver nodes that receive signals from a single source can independently use I and Q data from that source to determine its position then correlate this information and use their positions relative to each other and relative to the single source to arrive at a best approximation for the location of that single source.

The I and Q data that a receiver node receives from a leaf node may need to be calibrated since this information is derived among other things from the known shapes of the radiation patterns of the radio antennas for a particular receiver node. Since these patterns are not typically perfectly symmetric the I and Q data is not usually perfectly accurate. This problem is exacerbated by the fact the radiation patterns may be affected by spatial features around the receiver nodes such as features that deflect or interfere with radio frequency signals.

It may be tempting to think that if two receiver nodes are stationary are in proximity to each other and know their own GPS positions then those receiver nodes could calibrate each others I and Q data by the following method. A first receiver node could relay to a second receiver node information indicating the position of the first receiver node. The second receiver node could receive the position information and compute from the I and Q data what it believes to be the first receiver node s position. The second receiver node could then iteratively correct its calculations by changing the coefficients in its I and Q calculations until perfected. The same process could be used to perfect the calculations of the first receiver node. In theory when a leaf node traversed the space between the two receiver nodes both would derive much more accurate position information from the I and Q data received from the leaf node.

However this approach has two challenges. The low modulation bandwidth means there is an uncertainty of a substantial fraction of 2 400 cycles in the designation of a cycle or the arrival time of a signal. This also corresponds to a distance of an appreciable fraction of 300 meters. So while phase related approaches with I and Q data are good for finding directions with antennas physically attached to or cabled to a single radio the problem of acquiring and maintaining the necessary synchronization between separated radios requires in practical implementations some synchronization mechanism outside the BLE signal and probably prohibitively expensive equipment such as atomic clocks to maintain the necessary stability. However receiver nodes can still refine their estimates of their relative locations and detect whether one or more of their number has been accidentally displaced by taking turns acting as leaf nodes with the remaining receiver nodes estimating the location of the receiver node temporarily acting as a leaf node. Such techniques can identify problems such as gross dislocations without requiring high accuracy phase comparisons between signals received at different receiver nodes. In embodiments receiver nodes may act in conjunction to pass each other PTP synchronization data to synchronize time down to nanosecond resolution. Once receiver nodes achieve this synchronization they are able to correlate I Q samples received from a leaf node at multiple receiver nodes at a given time. Then the receiver nodes can send this information to a cloud server that correlates the various samples to determine the leaf node s exact position at that time.

In some implementations information about estimation of a leaf node s position may be facilitated as described in the following clauses.

wherein the leaf node device transmits a signal to the reader node and the receiver node derives data about the strength and the phase of the signal transmitted by the leaf node 

wherein the reader node uses the data about the signal transmitted by the leaf node and its own positional and orientation data to estimate a position for the leaf node 

wherein the reader node transmits said position estimate to the cloud server and wherein the cloud server saves the position estimate for the leaf node in a database.

Once a network of receiver nodes self synchronizes down to nanosecond resolution by PTP the receiver nodes in that network monitor I Q samples from a leaf node. The receiver nodes can calculate at any given time the degradation of those I Q samples going to different receiver nodes. This allows the receiver nodes to run a collision avoidance algorithm to avoid sending colliding messages e.g. inconsistent instructions to that leaf node.

In embodiments more advanced techniques may be used for detecting position and motion especially in a noisy or otherwise lossy environment. In such embodiment the methods may process RSSI for a the location estimation of the tag. The spirit of this is as follows. Suppose multiple leaf nodes are moving through a set of detectors and that each of those leaf nodes advertises periodically. Then a given receiver node generally picks up a given advertisement from a given tag and extracts its RSSI such as a function of dB attenuation. However multiple conditions may interfere with this reception such as a the tag moving temporarily out of range b environmental interference such as a metal object c environmental noise such as random static d a collision with another leaf node s BLE advertisement or e absence of an advertisement by a leaf node for various reasons. At any rate a receiver node is unlikely to pick up every advertisement from every leaf node that is in theory in range.

The methods and systems disclosed herein may use the following techniques to mitigate the effects of noise fading channels BLE network interference and other problems. First one may use filtering to mitigate the effects of the fading channel. One may detect the presence absence of the tag based on the global properties of the received waveform. Also one may apply multi antenna techniques to improve SINR AOA combining the results received by the distinct antennas. Also one may use adaptive filtering to jointly avoid fading and lost packets such as using a Kalman particle filter on each node and or well across multiple BLE radios. One may also use the BLE network architecture such as by deploying more than one BLE receiver to take care of mobility and or the slow squawk rate of the radio. Also one may modify the advertisement packet to aid detection of the tag. Another method is use of motion compensated RSSI filtering. This approach may use Kalman filtering with multiple co located radios with distinct antenna to receive independently faded packets. Here multiple co located radios with spatially separated antenna elements may receive advertisement packets independently for generating RSSI estimates. Finally one may use Adaptive Squawk Rate Variation. This approach adaptively varies the squawk rate to ensure that the receiver node receives a large number of advertisement packets from every tag even in the presence of packet collision and fading.

Another method detects for detecting presence absence involves using the shape of the signal wave form. In connection with this method the term signal refers to the plurality of RSSI data points and waveform and envelope refer to the arrangements of these points according to the time they were collected. These terms should not be confused with the usual meanings of signal waveform and envelope as applies to radio waves and as they are related to electrical waveforms.

In this method the receiver node may pass the filtered output of the signal though a waveform shape analyzer block. The block may use the overall shape of the waveform along with the received RSSI threshold to declare the presence or absence of an obstacle. The key advantage of capturing the waveform shape before declaring the presence absence of a tag is the following. An RSSI based approach declares presence or absence of the tag based on the received RSSI being above or below the threshold. The waveform undergoes frequency selective fading. This leads to presence absence declaration based on every filtered RSSI estimate. However if the presence absence detection is based on the observed signal envelope it eliminates the effect of instantaneous changes in the received RSSI of the signal.

The distance between the leaf node and the receiver node decreases as the leaf node comes closer to the receiver node. Here the received RSSI increases. As the leaf node moves away from the receiver node the RSSI drops. The increase and decrease in the received RSSI is typically characterized by the path loss exponent in a given environment. Increase and decrease in the received RSSI according the path loss exponent will reliably indicate the presence and absence of the tag. The receiver node may declare the presence absence of a leaf node after observing the received RSSI over a window of samples rather than relying on a single reading.

The RSSI window width is a design parameter that varies with the embodiment. In some embodiments it is programmable. The receiver node may treat the adjacent windows of received RSSI estimates as overlapped or as disjoint for signal waveform analysis. In some embodiments the system analyzes sliding adjacent windows by one sample.

In some embodiments the receiver node can detect whether the leaf node is present without a threshold over the window based on the waveform shape alone. In some other embodiments the receiver node uses a counting statistics based approach which employs a threshold.

RSSI filtering for location estimation or presence absence detection may use the statistics and or shape of the received waveform using single antenna radios. This is extended for the case with multiple antennae in the same radio. The distributed multi antenna system may also be used.

Steps in the detection of the presence absence of a tag based on the received RSSI wave form shape may be 1 the RSSI signal is stored for a given window duration 2 the RSSI over the window is the rate of change in the RSSI computed based on the successive difference between RSSI samples 3 the rate of change of the RSSI including the increase in the rate of change of RSSI followed by the decrease in the change of RSSI may be used to effectively characterize the movement of the tag towards the receiver initially and later moving away and 4 the local average within a window and maximum value may be estimated based on the received RSSI. The difference between the average and maximum value also indicates the movement of the tag towards the receiver.

The system may also compute the following statistics over the window. First simple counting statistics may be computed such as setting a threshold and counting the number of times the RSSI is above threshold. If the number of times the RSSI is above the threshold is greater than the number of times it is below the tag is declared to be present.

Weighted counting statistics may also be computed. For each RSSI the system may obtain the sum of difference between the threshold and the RSSI values which are above the threshold. The system may obtain the absolute value sum of differences between the threshold and the RSSI values below the threshold. If the sum of the differences of the RSSI estimates above the threshold is greater than the sum of the differences of RSSI s below the threshold the system may declare that the tag is present.

In different embodiments and with different programming a receiver node may look for various distinct patterns in the RSSI time series. For example the system may look for patterns where RSSI values increase and then decrease. A monotonic increase followed by monotonic decrease may indicate the leaf node moving toward then away from the receiver node. The system may look for the RSSI value to increase then plateau within the window. In other situations the RSSI value decreases and then it plateaus. In other situations the RSSI values increases in a non decreasing manner and then it decreases in a non increasing manner. The system such as a receiver node or cloud server can use these and other computed statistics to decide on the presence or absence of a tag over each window. As a first step we may consider significant overlap. In spirit a receiver node running this analysis must take these different scenarios for consideration. First there is a benign case where the leaf node moves towards the receiver and then moves away over the finite window of observation. Here the received RSSI at the leaf node increases and then decreases. This can be characterized based on the steps above. Another case is the quasi mobile case. Here the assumption is a leaf node moves from one location to another with long intervals without any change in the observed location of the leaf node. The leaf node stays in each intermediate location for a long time. Here again combining the waveform shape and identifying that the RSSI does not change for long over the window of observation will lead to a reliable decision for the presence absence detection. This is more reliable than the point decision of absence presence based on the received RSSI. Another case is the fully mobile case. Here the leaf node moves rapidly in comparison to its advertisement rate. The receiver node may miss the advertisement also called a squawk when it is close to the receiver node. In one possible scenario the RSSI remains low over the window length. Here based on the RSSI signal waveform envelope not peaking the system could change the squawking rate and check for changes in the RSSI waveform. The waveform shape aids in changing the squawking rate of the leaf node.

In different embodiments the pre processing step to generate the RSSI time series for processing includes one or more of the following filtering steps. First one may perform a low pass filtering based on a simple averaging over a fixed number of samples. The averaging length is decided based on the squawking rate of the tag and the velocity of the tag. If the velocity of the tag as well is high and the squawking rate is low the averaging length is small. In other extreme where the squawking rate is high and the velocity of the tag is low we could choose a longer averaging length. One may also perform Kalman filtering. Here we consider the process noise as well as the additive noise. The filter works by minimizing process measurement noise through a two phase algorithm. First a predictor performs the next RSSI estimation. Then a corrector improves the RSSI estimation by exploiting the current RSSI measurement. When the tag is moving successive received advertisement packets are transmitted by the tag from different positions with respect to the receiver. A motion compensation algorithm using Kalman filtering could be implemented to receive multiple advertisement packets from the same relative location with respect to the receiver.

Also the system may perform filtering in the presence of missing packets. In a typical wireless environment several received packets could be lost. For instance if the tags move rapidly for a given squawking rate the advertisement packet could be lost. Here the system may address the solution using two possible approaches. First multiple radios may be deployed along the determined path of the tag. There is finite intersection between the listening ranges of the radios. Here if the tag is heard by one of the radios. If the tag is heard by one radio one may combine the output of the two radios multiple ways. Alternatively one may use knowledge about the prior location of the tag. Another approach to filtering is to perform Bayesian filtering Particle filtering A receiver node may do this in situations where the propagation model is unknown the antenna characteristics are non ideal etc. Here the approach is to obtain the probability distribution of the parameters characterizing the propagation losses using RSSI. This will aid in reliable estimate of the presence absence of the tag. In embodiments the receiver node or other system element may use a combination of the above referenced methods across different radios.

In embodiments the system may employ multiple antennas on a single receiver node across different receiver nodes or both. These multiple antennas perform coordinated filtering when they receive squawks from the same tag. The overall approach may remain to use the RSSI according to various methods described above.

The approaches may include the following. First the system may use equal gain combining to improve RSSI estimates such as by spatial averaging. This can be across spatial distributed radios as well. Also the system may use maximal ratio combining optimal combining whether by co located antenna array or distributed arrays . Also the system may use a switched antenna such as taking the output of the most reliable RSSI value. This can be combined with weighted combining. The system can also use distributed multi antenna systems. It may be attractive to combine the output of the receiver and the location marker i.e. the known location of the receiver node and the location marker such as for a POI . This may include synchronization across different radios such as between POIs and receiver nodes. The system may also use AOA based BLE. Here the system would likely have widely varying characteristics to encounter including multipath propagation. This approach may be used for obtaining the angle of arrival based on different array geometries. This may be modified to include both distributed and co located multi antenna systems. The system may also combine AOA and RSSI ranges such as to reduce the uncertain regions and improve the confidence in location estimation. The system may also leverage polarization diversity as well as combine this with the AOA and RSSI measurement. Finally the system may transmit a specific signal such as a signature signal such as a liner chirp from a tag. The phase delay difference seen at reference nodes can be employed to arrive at the angle information with respect to a specific tag. This can be employed to estimate the direction arrival from distinct BLE tags. In embodiments a simple spatial averaging of the received RSSI across the received signal from different antenna elements may be used. This may be done prior to waveform based analysis for classification of different events.

The approaches above can be used for location estimation once the RSSI signals are filtered AOA computed etc. The required accuracy in the estimate of the tags and known priors may be used. The architecture may be used for presence and or absence detection for determination of the proximity of a leaf node to the receiver or the state of being away from the receiver. The approaches can be used for location of the tag and for path characterization of the tag to track the movement of tag within the wireless network as well as integrating this information with the cloud infrastructure.

In embodiments a network architecture may be based on the receiver nodes the POIs and the leaf nodes tags . The positioning of the POIs and receiver nodes is designed to locate detect varying numbers of tags tags moving with different speeds mobility models constraints on the battery life in the tags etc. In a given deployment it may be assumed that the POI has to detect a varying number of tags with different speeds varying from moving very slowly to moving at higher speeds such as 4 ft s with a high degree of reliability. Here depending on the maximum speed and maximum number tags which could squawk at the same time one may design the number of POIs with overlapping coverage. In a macro coverage area where the number of tags present in the coverage area of a receiver node has to reported consistently the system may use multiple techniques including deploying multiple antennae at the receiver using multiple receivers modifying the advertisements sent from the tag observing the statistics of each radio node and waiting longer before changing the state of the tag such as if the RSSI for the tag is not above the threshold consistently . Such a network preferably provides reliable presence absence detection of every tag e.g. with an error of the order of 0.0000001 per tag provides good battery life of the tag provides highly accurate location estimates provides two and optionally three dimensional positioning and provides enough receiver nodes to handle the maximum number of tags that are likely to be supported. The network preferably also is adapted to handle maximum and minimum supported velocity of the tags.

In embodiments a site survey may be used to develop a deployment approach for the BLE network for location monitoring presence absence detection.

In embodiments methods may be used for handling interferences in the BLE advertisement channels such as by gathering the interference statistics and employing receiver algorithms to work in the presence of interference or by deploying receivers with signaling techniques to improve SINR.

Once a network of LNRGs self synchronizes down to nanosecond resolution by PTP the receiver nodes in that network may test their interference with each other by having multiple receiver nodes transmit a packet at exactly the same time and having multiple receiver nodes monitor such events and record the strength of the I Q sample. By running different combinations of receiver nodes the overall system can determine a map of receiver node interactions. This allows the system to tell each receiver node when it may or may not transmit in a given frequency band and direction and thereby avoid signal collisions.

Currently conventional wireless access points do not have the capability to communicate with certain kinds of local devices for example various Internet of Things IoT devices that may use communication protocols other than Wi Fi. A BLEATS of the type herein integrated with or working in conjunction with such access points provides much broader communication capability to IoT devices and more generally to various leaf node devices such as asset tags. Referring to a wireless access point AP is represented by the schematic circle on and it is positioned parallel to a reader node . In embodiments they are separate devices. In embodiments they do not communicate directly. However they may communicate through a cloud server via the Internet . The AP may send messages to the reader node receive such messages and so on. In embodiments the AP may itself have other reader node capabilities.

In the second implementation referred to now in the AP occupies the schematic circle referenced by and the reader node communicates directly with the AP through protocols and media including but not limited to Ethernet 802.3 802.11 USB and BLE. Either or both devices may also communicate with cloud server or other devices.

In embodiments an AP shown in and a reader node physically reside on the same machine. The reader node may be implemented for example as a card that sits in the AP s chassis. They communicate through the backplane of the chassis

In embodiments a reader node is simply an additional capability of the AP . In addition to being an access point for other wireless communication the AP reader node unit communicates with other devices of the system via BLE and communicates with the cloud servers over the Internet.

None of the above embodiments are exclusive and they may work in concert. For instance a reader node integrated into an AP may interact via cloud servers with an AP that does not have any capacity to interact directly with reader nodes.

In embodiments BLE Communication between devices of the system comprises a series of communication sequences. A communication sequence consists of a series of BLE messages. The following is a description of an embodiment of communication sequences involving a reader node and other devices. Upon a reader node s establishment of a connection with some other device the connection sequence may be as follows 

In embodiments a BLE enabled reader node may not keep track of the state of a sequence of communications between itself and any other device with which it communicates. Thus each communication sequence may be independent of those preceding it in time. Such an approach allows the reader node to communicate with a much larger number of other devices than would be possible if it kept state history for each communication.

In embodiments a reader note continually checks via the advertisement channels for leaf nodes in its radius. Leaf nodes that are not currently in communication with a reader node periodically advertise on the BLE advertisement channels. If a reader node is within range of the leaf node s advertisement it should receive that advertisement after which the reader node may responds to the leaf node and establish a handshake. In this way the reader node knows in what direction and on what channel it should communicate with that leaf node. In embodiments the reader node may maintain this communication on a BLE data channel and may instruct the leaf node to do the same. The reader node may establish that it is in communication with a particular leaf node by learning the leaf node s PIN and TIN and relaying this information back to a cloud server as a reader node event. The cloud server may note this in the registry that is that this reader node is communicating with this leaf node identified by PIN and TIN.

In embodiments when a reader node establishes a communication sequence with some other device that sequence may be stateless or persistent. A stateless sequence comprises a start handshake to establish communication then a query or command from one device to the other then possibly a response and then an end handshake to terminate communication. A persistent communication establishes communication with a start handshake but then it maintains communication by a series of messages in both directions. It may or may not terminate at some point with an end handshake. A reader node may maintain a mixture of stateless and persistent sequences with the BLE devices with which it communicates.

In embodiments the control architecture or stack the MCU described herein of a reader node may simultaneously keep of track of multiple in embodiments of up to eight different communication sequences with different devices including leaf nodes and other reader nodes. Such tracking is independent of the physical communication vehicle for these communication sequences. Given that each communication sequences comprises an ordered set of messages that the reader node transmits and receives 

In embodiments the system such as a BLEATS may instruct the leaf node to alter its advertising periodicity signal strength programmatically in one of several ways including a instructing a leaf node to increase its frequency of advertisement when it is determined that the leaf node may be in motion or when it is determined that it would be beneficial to take a rapid series of measurements to estimate the leaf node s location b instructing the leaf node to maintain a higher rate of advertisement either until the system or an operator resets it or for some preset duration as a hedge against the system failing to restore it to normal once the exceptional condition is over c instructing the lead node to increase its frequency of advertisement at some event of the leaf node receiving data indicative of a condition e.g. the leaf node receiving sensor data of motion the leaf node receiving sensor data of temperature such as an overheating condition etc. of for some duration after such an event d instructing the leaf node to maintain a higher rate of advertisement either for some preset duration or until some other event such as establishment of communication with a POI or non POI reader node and or e instructing the leaf node to increase its advertising signal strength either to a fixed higher level or according to some function such as incrementally either at or at a predefined time after some event.

Thus in embodiments the leaf node advertises based on its known condition which is either known at or during deployment or is determined by sensors or otherwise detected. The advertisement pattern and rate may be variable and adjusted based on the circumstance. The frequency of advertisement may be adjusted based on the condition. A decreased advertisement frequency may be beneficial for a leaf node that is known to be at rest in that if a leaf node is known to be at rest it only needs to infrequently advertise its location so communications can be established with it. For example for a system where leaf nodes are associated with assets in a large warehouse infrequent advertisements may be adequate. Such infrequent advertisement can conserve device battery life such as leaf node battery life as well as avoid clogging the advertising channels with traffic. If the leaf node is associated with the type of asset that moves frequently or if leaf node is equipped to sense movement and senses frequent movement infrequent advertisements may not be adequate for a system such as a BLEATS to reliably keep track of the asset s changing location. Therefore increasing the advertising rate also referred to as frequency above for leaf nodes expected to be or known to be experiencing a condition such as moving allows the associated assets to be tracked more reliably. Increasing advertisement rate frequency only while the asset is experiencing a condition such as motion preserves battery life of associated devices most notably leaf nodes. In such situations automatically setting to infrequent advertisements after the condition has expired such as movement stopping conserves battery power. Similarly setting to infrequent advertisements after a preset time if the BLEATS fails to reset the advertisement based on the changed condition or the end of the condition guards against the BLEATS being unable to communicate with the leaf node and prevents accidental excess consumption of battery life.

In embodiments the system may increase accuracy of location determination of the leaf nodes by combining detection of a number of advertisements to average out noise and other inaccuracies. At advertising rate of a low frequency this might take a long time and may consume reader node resources. Increasing the advertising rate frequency while the measurements are being taken can shorten the task.

If there is some urgent or extraordinary event detected by or otherwise communicated to the system for example an asset such as a container is on fire the system can increase its advertisements so as to increase the probability of establishing communication so that in turn the system may in a timely fashion convey the critical information to some entity that can address it e.g. call the fire department.

Consistent with the above capabilities of the system to dynamically respond to given situation by addressing operational parameters of the system including advertisement and data sampling rate the system may raising the signal strength after a period where there is no response. This is akin to shouting louder for help and may allow more letting more distant reader nodes hear the message if the nearby reader nodes are unresponsive for some reason. Returning to normal settings as discussed above after a set time reduces channel clogging. For example if whole sections of a warehouse are on fire leaf nodes returning to normal may allow responders to hear other sensors without being overwhelmed by those whose situations have already been addressed or are not salvageable. Other events will now be described.

An event referred to as Wake Up is described below. With reference to a leaf node of the system a leaf node may function autonomously. It may have a PIN product identification number unique to it and a TIN type identification number it has in common with other leaf nodes of its kind. In embodiments when leaf node wakes up it may advertise continually on all three BLE advertisement channels 37 38 and 39 until it makes contact with a desired device. It may wake up due to a pre programmed schedule the detection of a condition or the like. In embodiments the leaf node may be schedule to wake up based on time to transfer telemetry data it may be scheduled to wake up based on sensory thresholds such as when an accelerometer on the Leaf node indicates it was moved or a temperature sensor exceeds a certain temperature and the like.

With reference to a reader node a reader node may function autonomously. It may have a PIN unique to it and a TIN type identification number . In one illustrative and non limiting example as shown in a reader node may be preprogrammed to connect to one or more cloud servers . In embodiments when the reader node wakes up step it may establish a connection over the Internet to a selected cloud server step and it may present its PIN and type TIN to the cloud server step . The cloud server may be programmed to instruct the reader node to communicate with a specific cloud server step which may be itself the cloud server or another cloud server . The cloud server may note the PIN and TIN of the reader node and also that it or another cloud server is communicating with the reader node in the registry step which again may comprise a database that the cloud servers in the system such as a BLEATS maintain to track which devices are communicating to which devices such as which cloud server is communicating with which reader nodes and which reader node is communicating with which leaf nodes .

Another event referred to as a take over and an illustrative example of which is shown in will now be described. In embodiments a reader node may establish communication with a leaf node step and determine the distance between the reader node and the leaf node step . When another reader node detects this communication step reader node may determine its own distance from leaf node step . Each reader node may communicate that distance to the system step for example to reader node to a cloud server or other viable pathway. A determination may be made as to which reader node is closer to the leaf node step . If reader node is closer then the system either via programmed instructions from the cloud server or from reader node instructs leaf node to communicate with reader node instead of itself step . In embodiments reader node may send a message to the cloud server asking that the cloud server remove the reader node leaf node connection in the registry and add a reader node leaf node connection in the registry step which in embodiments is also the database referred to above .

Factors used to determine which reader node will communicate with a particular leaf node may be a weight system where the weight of an leaf node for any reader node takes into account among other factors the proximity of the leaf node to that reader node how heavily loaded that reader node is for example how many leaf nodes it is communicating with the remaining battery life of a reader node the operational availability of the reader node. Reader nodes exchange information as to the weight of those factors with respect to a leaf node for applicable reader nodes. In embodiments the reader node with the weightiest result will communicate with that leaf node.

An illustrative and non limiting depiction of a self deregistration event for a leaf node is shown in . In embodiments if a leaf node determines that it is experiencing a condition affecting its ability to continue operation step for example its battery is low the leaf node may initiate shutdown step . The leaf node may send a message i.e. an event to a reader node informing the reader node either directly or indirectly as described above of its pending shutdown and causal condition step . In embodiments the reader node may or may be instructed to remove this connection step and send the event information to the applicable cloud server step . The cloud server may then update one or more of the registry step and other databases accordingly.

An illustrative and non limiting flowchart of a self deregistration event by a reader node is shown in . In embodiments if a reader node determines that it is experiencing a condition affecting its ability to continue operation step for various reasons described above in connection with the leaf node self deregistration embodiment the reader node may initiate shutdown step . The reader node sends a message to connected leaf nodes instructing the leaf nodes step to start advertising again and in some case breaking the reader node s connections to the leaf nodes step . In embodiments the reader node may also send a message i.e. event to an applicable cloud server informing the cloud server that it will shut down or otherwise go off line step . In response the cloud server may remove its connection to the reader node and all of the reader node s connections to applicable leaf nodes from the registries or databases step .

Another event referred to as device loss will now be disclosed. In embodiments a reader node may be configured to maintain a communication interval at a pre selected regular interval with the leaf node which can be described as a periodic heartbeat communication with the leaf node. For example the reader node may be configured to send the leaf node a ping packet at one second intervals. If the leaf node does not respond within the pre selected interval then the reader node or any device programmed accordingly in the system can deem the leaf node lost and then does not attempt to communicate with the leaf node any longer. The criteria for loss may be a number of pings or messages the leaf node does not respond to out of a total number of messages a number of consecutive messages the leaf node does not respond to and the like. If a leaf node is deemed lost the reader node may send an event i.e. message to the applicable cloud server and the cloud server may remove that applicable reader node leaf node connection from the registry. Device loss above may occur in the situation where a leaf node and a reader node are moving with respect to one another. As with embodiments above the criteria and format is adjustable. For example the heartbeat communication may happen every 10 seconds and may time out such as after a designated threshold number of packets such as after 4 lost packets. Also instead of a ping packet the reader node may send out a special packet such as a layer 7 protocol packet for the purpose of determining device loss.

In embodiments a leaf node may maintain an internal counter. When a leaf node is in communication with a reader node the leaf node may record data such as the last time it received a message from a reader node. If the last message from the reader node was more than some pre defined interval for example 30 seconds the leaf node may then ago stops communication with that reader node.

Reader nodes may be programmed with instructions similar to the above for their communications with the cloud server. For example a reader node may maintain a communication interval at a pre selected regular interval with a cloud server which can be described as a periodic heartbeat communication with the cloud server. In an example a reader node may send a communication to a cloud server at an interval of every 5 seconds. In embodiments it may be a Layer 7 protocol message specific for this purpose. Such may be referred to as checking in . This information about the communication may be updated in the registry. In embodiments a cloud server assesses the registry periodically and removes from the registry any reader node that has not checked in in the pre defined time period or interval for example the last one minute and in embodiments along with leaf nodes that the lost reader node in communication with.

In embodiments the system or devices thereof may be configured such that when a leaf node and a reader node first establish communication the leaf node may inform the reader node of its type. The reader node may use this information to determine the type of data it will request of the leaf node and what commands it will send to the leaf node. In embodiments if the reader node does not know the type of the leaf node i.e. it is a new type of leaf node at least to the reader node then the reader node may send a request event to a cloud server asking the cloud server to provide it instruction on how to interact with leaf node devices of this new type. The cloud server may transmit to the reader node a program such as a driver and referred to herein as a cloud driver that contains instructions and or control parameters for this new type of leaf node. The reader node may run the program to operate this particular leaf node and any other leaf node that it encounters of this type.

Based on certain events such as a directive from the operators or programmed instructions in the system a reader node may request a leaf node to communicate the version of control program it is running in embodiments. In embodiments if the operators desire that the lead node run a different version of program then the cloud server may transmit an image of the program update into the reader node and the cloud server may instruct the reader node to push the image into the leaf node. The reader node may then transmit the image to the leaf and instruct the leaf node to run the program going forward.

Similarly and with respect to control programs run on reader nodes the operators or other devices of the system request a reader node to communicate what version of the control program it is running. If the operators or system determines that another version of the control program should be used the cloud server may then transmit an image of the control program to the reader node and direct the reader node to run the program going forward.

Another event relates to balancing the loads on cloud servers of the system. The load may refer to the number of devices and and or the computational demands imposed by whatever number of devices such as reader nodes the cloud server is communicating with and or managing. For example if there are two cloud servers and the first cloud server is heavily loaded by virtue of communicating with a higher number of reader nodes while the second cloud server is communicating with fewer reader nodes then embodiments of the system provide that the first cloud server may change the registry entries of some of the device connects it currently owns to be owned by the second cloud sever such that the devices communicate with the second cloud server going forward. In addition to the load balancing among existing clusters of server processes the cloud also instantiates new processes automatically when it detects an increase in load. The various clusters of server processes may be managed and monitored through an orchestration engine which itself may be load balanced for failure scenarios.

In embodiments certain cloud server processors may go down due to a malfunction because of a request from an operator or for some other reason. In those scenarios a set of rules or instructions encoded in the orchestration engine e.g. the number of processing nodes of the host machine having CPU utilization below 70 is violated triggering new instances being spawned to compensate. Data inflow processing and data saving operations are resilient to failures because new processes pickup the work from last change and synchronize its state across other running processes. There may be four categories of process clusters i.e. web clusters messaging clusters processing clusters and database clusters. Each of these clusters maintains a set of process instances to serve the workload. Each of these clusters maintains the input and output watermarks across different clusters. These watermarks are used to detect unprocessed work across different clusters and are picked up by newly spawned processes.

In embodiments when transmitting data a device may use local processing to accrue data into a smaller format. For instance a leaf node having or in communication with a temperature sensor senses the same temperature once a second for an hour it may be configured to compresses that temperature data into a format of a fixed temperature over an hour which will be around 3600 times smaller than the data for each sample. In such embodiments where data is compressed the leaf node may sends such compressed data periodically to a reader node or any other device in the system which is in the interest of conserving energy.

In embodiments devices such as leaf nodes may compress data prior to sending it out to other devices such as a cloud server or reader node include in the manner described above . In some embodiments the device may send out data without compressing it due to the criticality of timing for example. If for instance a leaf node receives temperature data associated with an asset where that temperature is at or beyond a threshold critical level then the leaf node sends out that data as a high priority bit set indicating a state of emergency in some cases without compressions.

In embodiments peripherals such as leaf nodes may transmit periodic advertisements. Upon receipt of the advertisement the reader node may perform various actions such as 

Instead of polling an attention bit may be used as an interrupt mechanism. The use of an attention bit may save air bandwidth and reduce power consumption by both the peripheral as well as the reader node. In embodiments an attention bit may be designated in the advertisement packet for example the most significant bit of the 3rd byte of the MANUFACTURER SPECIFIC field of the advertisement packet. The reader node would ignore the advertisement packets until an attention bit is set. In a peripheral tag the attention bit may be turned on when an event of interest is triggered and then reset when the condition is serviced. For example an event of interest could be that an accelerometer on the peripheral was triggered due to a shock. The peripheral registers the shock value and sets the attention bit when it sends out the next advertisement packets. All advertisement packets from then on will have the attention bit set until the reader node reads the shock value thereby clearing the attention bit.

In embodiments devices of the system need to broadcast information to a larger set of devices in the system and in some cases all the devices in the system. In embodiments when a reader node receives a message intended for broadcast the reader node reviews the msg id to determine if the reader node has processed this message already. In embodiments messages from any device of the system contain unique message id s and data comprising information such as the device from which the message originated the time it was sent and the like . If the reader node processed the message already it may discard the message. This prevents ringing. Ringing is when a packet keeps getting sent from one node to the next in a loop without any node recognizing that the packet is for that node and keeping it or recognizing that it has been seen before so that it should not be retransmitted. As a result a ringing packet doesn t terminate but just keeps going on. If the message is new the reader node may mark it in a database such as a local table as read. The reader node may forward the message for some period of time to all other devices with which it is in communication or to the cloud server which forwards it to all other devices with which the cloud server is in communication except in embodiments the device that sent the broadcast message in the first instance.

In embodiments there is a method for dealing with unclear messages. For example if a leaf node or another reader node sends a second reader node a message that the second reader node does not understand then the second reader node may mark the message as a special message not understood message and it may sends it to a cloud server for further analysis.

As described herein in embodiments the system determines the proximity of a leaf node is to a reader node. Reader nodes may be configured to perform this step. After deducing the proximity the reader node may decrease its signal strength and instruct the leaf node to do the same. This is a power consumption measure for such BLE enabled devices.

In embodiments when devices are in communication with one another each device may be configured to provide data to the device with which it is in communication BER bit error rate of the transmission. In the cases of two devices D and D for example if device D transmits to D and D reports a BER that is higher than a preprogrammed threshold then D may increase its transmission power to address for the BER. If the BER is lower than a preprogrammed threshold then D may reduce its transmission power in order to conserve power but still maintain an acceptable BER. D and D may be configured to store historical data and adjust to an optimal power level incrementally to achieve the least power consumption for the desired BER.

In embodiments devices of the system including leaf nodes or reader nodes may accrue data over time into a combined packet. The size of such packets may be pre set and when the packet reaches this pre set size then the device may sends out this packet. This is another power conservation method. In embodiments the device may have a timeout period since the overall system needs to keep the data current. If the first data in a packet is older than the timeout then the device sends out the data even though the packet has not reached the programmed size. For example suppose a leaf node wants to accumulate 128 data objects before sending out an aggregation of data to a reader node such as in the interest of compressing data and minimizing overhead. The leaf node may wait for some event to occur but after some lower number of events e.g. the 27th event in the current set the condition that sets off events may stop happening. In such a case time passes and still the leaf node has only 27 events. Eventually the data may lose some value since it is dated. So rather than waiting for the accumulation of 128 data objects the leaf node can be programmed to send what it has on to the system after the designated time period has passed.

Another event is referred to as hibernation . In embodiments a device including a leaf node or a reader node may deployed in an environment where or otherwise may determine that there is little to no possibility of a high priority event. In such scenarios the device may shut down for a preprogrammed duration e.g. 1 minute. After this time it may wake up and functions for a preprogrammed duration e.g. 1 second.

Data transmitted in the system may be encrypted data in transmission between different devices so that eavesdroppers may not access that data in transmission. In embodiments the system can encrypt all or some types of communication. The encryption algorithms may be based on standard shared secret key exchange. In embodiments operators can define or select the encryption method. In embodiments operators can request encrypted access to the cloud server and from there to reader nodes and from there to the leaf nodes. In effect the whole communication path from the operator to the leaf nodes may be virtual private network or VPN.

As described herein reader nodes and leaf nodes may discover each other via the means specified by the relevant BLE standards or IEEE 802.15.1 BL depending on their configuration which optimizes power consumption with the constraint of achieving some given range. The system may be configured to allow the leaf node reader node network and interconnections to be dynamic. Devices including cloud servers reader nodes and lead nodes may be static or in motion relative to one another as mentioned herein. Thus the system may be configured to take into account that new connections may be established or an old connection may be broken at any time. This includes connections between a leaf nodes and reader nodes connections between reader nodes themselves connections between reader nodes and cloud servers if any and connections between any of these device and operators.

With the devices and system architecture and rules described above the following disclosure is directed to embodiments of BLEATS. The following description of BLEATS may include additional descriptions of the configurations of any device system rules and or architecture of the system and as such and the skilled artisan will appreciate that such additional descriptions if described only in connection with the BLEATS below will apply to all applicable embodiments herein. Similarly any of the embodiments described above may be used in connection with the BLEATS described below where applicable including any combination of devices rule or architectural scheme.

In embodiments a BLEATS may be deployed in an industrial setting which may be a stationary setting such as a factory or warehouse or a mobile setting such as a semi detached truck a freight train or a container bearing cargo vessel. In embodiments the industrial setting comprises assets drawn from a very large set of possible types of assets. Such industrial settings and assets are well known and well understood in the art. In embodiments each asset may be associated with a leaf node. Depending on the nature and mobility of the asset and the nature of the industrial setting the leaf node is in communication with sensors detecting data of various conditions including temperature barometric pressure humidity movement location and weight. Location may be determined according to any of the methods described herein. In embodiments the BLEATS for the industrial setting may comprise one or more reader nodes. As described herein the reader nodes communicate with lead nodes via BLE or other methods. When a leaf node is within range of a reader node discover initiates as described herein . Once communication is established the leaf node periodically sends according to rules in its control program various data that it has accrued to the reader node. This may be done both on a periodic basis and when particular events occur as described herein . The reader node also as its programming and directives instruct it may request various data from the leaf nodes with which it currently communicates. As described herein the reader node can also transmit control programming rules to a leaf node to run. A device of the system such as a lead node or a reader node may be static i.e. located in one particular location of an industrial setting. Alternately the device may be static within that setting where the industrial setting itself is in motion as is the case on a cargo ship. Yet again a device may be mobile within the industrial setting as is the case for a user carrying the device on his person. Reader nodes may use wired or wireless Internet media and protocols to communicate with a plurality of cloud servers across the Internet.

In embodiments a BLEATS may be deployed in an industrial setting which may be a stationary setting such as a factory or warehouse or a BLEATS may be deployed across a plurality of stationary and mobile settings such as in one or more of a supplier site a manufacturer site and a distribution site and on transit vehicles therebetween. In embodiments the industrial setting comprises assets drawn from a very large set of possible types of assets such as tools equipment machines fixtures goods components materials supplies vehicles human beings and many others. Such industrial settings and assets are well known and well understood in the art. In embodiments an asset may be associated with a leaf node . At locations along at least one potential path that an asset may take there may be one or more location markers. A location marker is a POI device with a known location that may be used to track the arrival stay and departure of an asset from the vicinity of the POI . As illustrated in each POI may have a radius around it defining its sphere of detection within which leaf nodes sensors wearable devices and other BLE enabled devices may be detected. A leaf node POI A described elsewhere herein may communicate with a leaf node associated with an asset as described herein. The POI A may also communicate with sensor devices wearable devices and other BLE enabled devices . Leaf node POIs A do not communicate directly with cloud servers but may as a group communicate directly with a reader node . The reader node may then communicate the data to the cloud server . A reader node POI B may also communicate with leaf nodes sensor devices wearable devices and other BLE enabled devices . A reader node POI B may communicate both with the cloud server and a reader node .

POIs may act similar to readers receiving and measuring transmissions from leaf nodes asset tags. POIs may also act as peripherals such as leaf nodes receiving commands from reader nodes such as with information regarding what leaf nodes the POI should listen for and when to listen for them and reporting back to the reader nodes the measured results if any. POIs particularly leaf node POIs may be designed to be lower in cost than typical reader nodes and may operate primarily in a low minimal power sleep mode most of the time reducing power consumption. The combination of low initial device cost and reduced power consumption may enable the use of leaf node POIs to extend a BLEATS network to cover essentially the majority of an area at a reduced cost point relative to a deployment entirely consisting of typical Internet enabled reader nodes . In addition POIs may act as additional cooperative reader nodes providing additional signal strength measurements in additional locations. These additional signal strength measurements may be compared with those received by other reader nodes and or other POIs . POIs may have omnidirectional antennas as described herein and or measuring just the signal strength at a different location from a reader node or directional antennas as described herein and or measuring the combination of the signal strength with an antenna pattern . Multiple POIs with directional antennas at a particular location or a single POI with multiple radios and directional antennas may provide a direction estimate as described elsewhere herein.

The phase of a BLE signal is not something the BLEATS can easily measure across multiple discrete receivers and or location markers that are remote from one another as the time synchronization necessary to estimate the phase of the signal is difficult. However the cloud server or other device such as reader node having access to a large number of data samples related to the BLE signal may be able to detect a pattern to the RSSI data and converge on an estimate of the location of the signal source.

With continuing reference to each POI may have a radius around it the sphere of detection within which an asset tag may be detected. As a leaf node passes through a POI s sphere of detection the POI may establish communication with the leaf node and record a in embodiments that the leaf node entered the sphere of detection or b in embodiments the leaf node s position as well as one or more timestamps at which the particular leaf node entered resided in and exited the POI s sphere of detection . The POI may then transmit this information to a reader node which may correlate its own measured information with the location information received from at least one POI for a specific leaf node .

A reader node may keep an absolute log of the positions over time of any given asset based on information that is received regarding the given asset from the one or more POIs . In embodiments the receiver node may use filtering methods such as Wiener and Kalman Filtering to reduce noise and improve the accuracy associated with the recorded positions of any given asset associated with a leaf node . Using the reduced noise positional information the receiver node may calculate the actual travel trajectory for a given asset associated with a leaf node . The receiver node may compare the actual trajectory of a given asset with its expected trajectory. Differences between the expected and actual trajectories may facilitate understanding the transport of the asset through the facility including whether the asset stopped whether the asset was travelling faster or slower than expected whether the asset was off course in some way and the like.

When a POI or another reader node is cooperating with a reader node or other processing device by reporting received signal strength indication RSSI or other measurements about a packet it has received the reader node receiving the measurements will achieve better results by combining all measurements of the same packet transmission i.e. the reader node s own readings as well as any readings of the same pack transmission received from POIs or other reader nodes .

In some cases leaf nodes may transmit more than one packet creating a risk that the reader node may accidentally combine measurements of distinct packets which might have different characteristics e.g. they might have been transmitted from different locations if the leaf node is moving .

In embodiments the possibility of confusing measurements such as combining measurements for more than one distinct packet may be reduced using timestamps from both the POI and the reader nodes as illustrated in . As a POI receives a signal step from a leaf node sensor and the like the relevant signal information is stored together with a timestamp indicating when it received and measured for each of the packets step for which it is reporting measurements. Rather than explicitly synchronizing clocks with the reader node that is collecting the readings the POI may include an additional timestamp by the POIs clock indicating the time it composes and transmits the measurement report step . The reader node receiving the measurement report may make its own timestamp in its own clocking domain of the time it received the measurement report from the POI step . The reader node may calculate the difference between the timestamp of the report and the timestamp of the reading in both clocking domain of the POI and the clocking domain of the reader node step . The difference may be scaled if the clock on the reporting device the POI runs at different nominal rate to that of the reader node taking the report. The reader node may add an estimate of processing and propagation time as well. The resulting value may then be subtracted from the timestamp for the receipt of the report. This provides an estimate of the time of measurement in the clocking domain of the reader node . This may facilitate combining the correct readings made by the reader node with the corresponding measurements from one or more POIs and other reporting devices.

In embodiments this method may also provide the reader node with an estimate of the current correspondence between its clocking domain and that of various measurement makers such as leaf nodes and POIs . This may facilitate in the composition of instructions regarding when a measurement maker should make its next measurements. If no measurements have been taken recently the reader node that collects the measurements may obtain a recent timestamp by asking for a measurement report after a zero or a negligible delay provoking a nearly immediate report which may in some cases contain no measurements but may contain a timestamp for its composition and transmission.

In embodiments a leaf node may be specified to have a variable watermark such as a serial number e.g. from a small rollover counter which is incremented between transmissions or a timestamp on the transmission by the leaf node . In this way each transmission by a particular leaf node is distinct within a sufficiently short time frame from any other transmission by that particular leaf node so that each distinct transmission is differentiable from any other transmission from that target which might be measured in a sufficiently short time to be confused with it.

The BLEATS system may be partially implemented using a cloud infrastructure as illustrated in . The BLEATS system may include a Cloud platform Cloud infrastructure or the like and one or more entities that communicate with the Cloud platform . The one or more entities may include a plurality of mobile applications devices that communicate with the Cloud platform using APIs such as REST Message and or Proximity APIs such devices including smart phones tablets laptop computers and other mobile devices and systems or platforms that communicate with the Cloud platform using the REST and Message API such as Enterprise Application Integration EAI middleware to connect to applications ERP CRM and the like .

The Cloud platform may be a structured software entity which may include a variety of software components such as web applications message brokers real time compute engines storage systems and devices and the like.

A web application may include software components such as peripheral drivers receiver drivers and the like at the bottom of the software stack. A peripheral driver may include among other components a peripheral discovery module a peripheral communications module a peripheral management module and a peripheral configuration capabilities repository . The peripheral driver handles the identification of new peripheral devices such as leaf nodes sensors and the like. Additionally the peripheral driver handles configuration and management of the identified peripherals along with communications to and from the peripherals.

A receiver driver may include among other components a receiver communication module a peripheral hand off and load balancing module and a receiver configuration and capabilities repository . The receiver driver handles configuration and communication with reader nodes. It also handles peripheral hand off load balancing as communication with a particular peripheral such as a leaf node changes from one reader node to another as the leaf node moves through a facility.

The next layer in the web application may include a device library module which comprises sets of characteristics for different types of devices and peripherals. In an illustrative and non limiting example a fitness monitor may have a battery an accelerometer and the like as part of the BLE profile of the device. When a device is first detected during advertisement by the peripheral discovery module the device type is unknown. However the advertisement may include an address ID that encodes the company name and model of the device. This data may then be used by the device library module to get the characteristics of the device which aid the system in creating the initial profile of the device and correctly configuring the device . The web application may include an alerts and notifications module which handles notifications to a user under specific conditions such as when an asset reaches a specified location or other criteria are met. These modules may communicate with the next higher layer in the stack which contains a user management module and a location mapping module which identifies the physical location of identified peripherals. These modules may use a rule process library .

The web application may support multi tenancy organization and location hierarchies and a security module . The multi tenancy organization and location hierarchies support data segregation among multiple tenants organizations using the same instantiation of software. Additionally the software supports location and device groupings and hierarchies which may enable a user to specify groups of POIs and sensors at different levels of aggregation. The security module may provide for authentication for users devices and systems prior to allowing access to application resources. The system may provide authorization for access to resources and actions through a set or roles and permissions. Authorization may comprise a set of roles composed of application permissions access control lists . There may be both default factory defined roles such as customer administrator site administrator as well as user definable roles for each tenant. Each role may have a tiered set of permissions. These modules may use a data visualization engine module to allow the user to view portions of the data. There may also be modules such as a process flow and work flow editor and a rules editor that may edit the rule process library which describe how assets may be expected to move through a facility actions to take based on an asset s movement. There may be a customization editor that may edit the multi tenancy organization and location hierarchies the security module and the data visualization engine module .

Users may access the data using the data visualization engine module and the editors through the Web UI . Application programs may access this data through the Rest API .

The Web Application may save to and retrieve data from the storage system . The storage system may include file systems such as Hadoop Clusters SQL databases such as Cassandra Clusters and the like.

The web application may pass information to the real time compute engines through the message broker which manages data streams according to the Message protocol . Each data stream is associated with a particular reader node which is associated with a particular tenant. Any data from a reader node comes to the message broker as a publication to the message broker using the Pub Sub Messaging API . The real time compute engine subscribes to all the data streams and then partitions the data for processing by tenant.

The real time compute engine may perform operations on real time location multi sensory and other environmental data from sensors and mobile devices to derive aggregated business insights. The real time compute engine includes the RF layer channel model and algorithms to identify base characteristics for the various devices based on field calibration and the data collected from multiple sensors. Base channel models may be based on 802.11 channel models and improved upon with additional contextual data from surrounding environmental conditions. The base channel models may be combined with real time data to identify patterns for location and signal calibration. The real time compute engine merges the data arriving from the message broker with reference data such as channel models organization by tenancy organization by site and the like and applies the logic that is domain rules and the machine learning . The results are fed into the processing pipeline which processes incoming data according to the domain rules and machine learning and converts the physical data into event streams which flow through data pipelines that feed into real time location services and the real time insights module which transforms the measured data into business insights. The real time location services and the real time insights module may save data to the storage system where it may be accessed by the web application .

At the bottom of is the physical device mapping logic layer which may be implemented as the cloud controller and management module . At this level the capabilities and associated metadata for the various system devices such as leaf nodes sensors POIs reader nodes and the like are defined. The metadata associated with a device may facilitate monitoring of device health and data throughput. The cloud controller and management module may include the location engine module which determines the location of various assets leaf nodes and the like and the device management module which defines the device connectivity topology capabilities and metadata for the various devices and manages the provisioning and de provisioning of devices into a customer tenancy. The device management module may also manage security data connections and the sensory and controls data flow.

The cloud controller and management module may provide information on the various system devices to the adjacent real time track and trace module representing the raw asset visibility logic layer . The real time track and trace module merges the data captured from leaf nodes and other peripherals in the cloud controller management module with related reference data created by the users such as device characteristics and defined POI based travel paths. For example the captured data may indicate that a leaf node was in the vicinity of POI A and then POI B. This path information may be merged with reference data to associate the movements with specific events such as Entry Exit and Handoffs to different regions. Since leaf nodes are attached to assets this may provide visibility of the assets through identification of an asset s physical location at different points in time and it s state changes as it transitions locations.

There are two levels of customization. The process flow editor allows a user to create custom paths of interest and define POI based travel paths . POIs may be used to define areas of interest through which assets travel. As an asset moves through a facility it may transition from one POI defined location or area of interest to another POI defined location or area of interest. The process flow editor may allow a user to define expected movements of assets in terms of an ordered transition between POI defined locations. The real time track and trace may compare the measured travel path of an asset to those defined using the process flow editor.

The POI based travel paths logical layer may connect to the asset flow logic layer which may be implemented as the logic editor module . The logic editor may include a predefined logic library and the custom logic definition GUI which allows a user to author and save customized business rules for different stages of the process flow. These rules look for input events and generate output metrics or exceptions to be provided to the user or as feedback into the system to initiate action such as an alarm or system halt .

The logic editor allows the user to create and connect various flow states series of transitions between areas of interest with expected business outcomes as an asset flows through different POI regions and flag any deviations as exceptions. As an illustrative example a pallet may be defined as filled when it transitions from POI C which is defined as an assembly station to POI D which is defined warehouse station. The process flow editor allows the user to define the path of interest POI C to POI D. The logic editor allows the editor to connect that path of interest POI C to POI D with a specific business outcome e.g. the pallet is filled.

In the presentation layer data and data metrics may be presented to the user in a variety of styles and levels of detail to enable the user to gain insight into overall system operations as well as specific assets and areas. This is the primary layer with which a business user interacts. A user may interact with the analytics and insights module which implements the presentation logic as a dashboard visualization and allows for statistical data analysis and drilling down to review the data underlying the dashboard visualizations. In an illustrative example an asset count at a given location may be presented as a marker on a map there may be a user dashboard with pie charts showing current asset inventory levels for a given supplier and the like. The user may drilldown on a section of the pie chart to see underlying detail.

The POIs may be autonomous battery powered devices with bidirectional capabilities for up linking locational data about leaf nodes and other peripherals in their vicinity and downlinking control data in the manner described elsewhere herein. The POIs may have a defined sphere of detection with a radius ranging from less than one meter to more than twenty five meters the size of which may be configured via cloud servers . The POIs may detect leaf nodes and the like within their sphere of detection and transmit locational data and corresponding time stamps for the leaf nodes detected in their vicinity to the reader node .

The POIs leaf nodes sensors and the like may access the cloud server using a reader node . A reader node may include a BLE enabled communication facility to communicate with POIs leaf nodes sensors and the like on the downlink. Uplink data transfer to a cloud server may be accomplished via a low power wireless personal area network 6LoWPAN connection a Wi Fi Client mode USB Ethernet 2G 3G 4G Cellular and the like. In some instances the connection may be to a local distributed computing infrastructure Fog Node or Internet of Things IoT Gateway for critical on premises data feed s for MES Manufacturing Execution Systems or programmable logic controller PLC systems.

In some instances as described elsewhere herein a reader node may comprise multiple BLE radios . The multiple BLE radios may have an associated BLE multi radio connection management layer which may utilize a single or multicore processor. The connection management layer may include a node controller a connection manager and a BLE driver . The connection manager may schedule the BLE radios and maintain states for each connection initiated. The node controller may provide control information to leaf nodes sensors POIs and the like such as transmission settings communication frequency and the like. The BLE driver may physically control the BLE radios . Connections are one to one connections between single devices. For example a connection may be between one of the BLE radios and a single peripheral such as a leaf node or a single POI .

The connection management layer may transmit received data from the peripherals to the data plane which organizes data to be shared with the cloud server and local services . The connection management layer may communicate control data from the control plane to one or more the peripheral devices such as the POIs . The data plane may be accessed by local services which may include node management location services access filters and channel controls . Node management manages the reader nodes status data provisioning such as settings on transmission to the leaf nodes and POIs and communication via different interfaces such as the RESTful Protocol and Message Protocol via the 6LoWPAN connection to the Backhaul uplink layer.

Location services may perform inter reader node sector handoff scheduling Inter reader node hand off services and POI to POI handoff scheduling and services. Location services may also maintain a static state of POI and reader node locational data in reference to other reader nodes and POIs. Location services may also provide locational reference mapping for the cloud server .

Access filters may enable a user to filter leaf node data based on type of tag operating frequency and other characteristics.

For each BLE radio channel control may schedule access to different channels in the 2.4 GHz industrial scientific and medical ISM band. The schedule may be based on each sector of the BLE radio s antenna or a beam switched array of antennas.

The reader node may provide Internet Protocol IPv6 Support and Proxy services for leaf nodes POIs and the like using an Internet over Low power Wireless Personal Area Network 6LoWPAN to connect to the internet and backhaul providers to send data to Cloud Servers via Secure Socket Layer SSL TCP IP and the like. Data from the data plane and control information from the control plane may be exchanged with the cloud server using the RESTful Protocol and the Message Protocol through the wireless network connection 6LoWPAN to the internet. Uplink backhaul security may be accomplished via SSL or Transport Layer Security TLS .

The cloud server may ingest data into the BLEATS from a plurality of data streams such as those coming from each reader node from leaf nodes sensors wearables C other peripherals D physical devices or from the cloud using Message Queuing Telemetry Transport MQTT Constrained Application Protocol CoAP Web Socket Representational State Transfer Rest APIs and or ready partner data streams and the like.

At a supplier s location remote from the manufacturing plant reader node A may provide coverage for one or more POIs and leaf nodes that may be present at the supplier s location .

During transportation a reader node E may be positioned in on the transportation vehicle to provide coverage for one or more leaf nodes A and POIs . The reader node E aboard the transportation vehicle may communicate information about the one or more leaf nodes and POIs to a cloud server using long range wireless communication technologies such as 3G 4G cellular and the like.

The leaf node A reaches the receiving dock of the manufacturing plant and is placed in inventory storage . Inventory storage may have one or more POIs C D that will receive transmissions from the leaf nodes A B as they are unloaded at the receiving dock and placed into inventory storage . The POIs C D may provide information regarding the leaf nodes A B to a reader node B. As one or more leaf nodes move through the manufacturing plant entering the sphere of detection for different POIs information about the one or more leaf nodes may be communicated to one or more of a plurality of reader nodes and from there to the cloud server .

As described in herein a sensor may be associated with a leaf node itself or with an environment through which the leaf node may pass. The sensor may provide data related to the leaf node and it s environment. In an illustrative example a sensor A may be incorporated into an inventory storage bin and provide data such as the weight of components in the bin. In another illustrative example a sensor B may be positioned along the assembly line and provide data such as the temperature and humidity experienced by leaf nodes passing by the sensor B. In another example a sensor may be attached to a leaf node and provide data regarding the shock experienced by the leaf node . Sensors may provide a variety of data such as light levels motion acceleration shock direction such as from a compass or magnetometer orientation from a gyroscope pressure weight sensed current from a current transmitter relay output from a contact sensor data transport information from an associated BLE Profile and the like.

As leaf nodes exits the assembly line and are placed in finished goods there may be additional POIs and sensors to monitor to the accumulation of finished goods. A reader node C may be positioned near finished goods to monitor those assets.

At a warehouse or distribution center remote from the manufacturing plant a reader node D may provide coverage for one or more POIs leaf nodes and sensors that may be present during transit to the distribution center or at the distribution center.

The cloud server may have one or more sets of rules for specific workflows which may trigger different functionality or actions based on a leaf node s locational information or sensory information provided by one or more POIs or sensors . For example a temperature out of range might cause a leaf node to be rerouted or an alarm to be triggered. In another example a pressure sensing tag that measures weight of content of an asset may trigger a replenishment signal to be sent to an ERP MRP system when the weight crosses a set threshold.

In an illustrative and non limiting example this type of BLEATS deployment scenario might be used to provide joint supply chain visibility and management between one or more suppliers and one or more manufacturers. In other illustrative examples this type of BLEATS deployment scenario might provide for sensory asset visibility and management location guided execution capital assets tracking preventive and predictive maintenance tracking and the like.

A BLEATS in an automobile manufacturing setting is described below. An automobile manufacturer may require engine oil for the cars coming off its assembly line. Its operations people may query the factory reserves to determine how much engine oil is left and at what rate the factory is consuming engine oil and thereby determine at what time the engine oil will run out. A BLEATS according to the embodiments herein would provide the manufacturer with the ability to identify and monitor specific pallets of oil and their locations are relative to where it needs them to be as well as how many bottles or tubs are left on each pallet by for instance monitoring the weight of the pallet using a pressure sensor. Liquid level sensors could be used to determine the amount of oil in vats. With the BLEATS enabled by the embodiments herein the manufacturer can quickly determine for example that the factory will be out of oil in a given amount of time. Such information would allow factory operators then query the oil vendors to see what is available in an acceptable time frame. For example vendor A is charging 1.20 a gallon but will not be able to provide any oil for 44 hours. Vendor B is charging 1.25 a gallon and can provide oil in 8 hours but it only has 20 000 gallons on hand. And so on. Based on this information the factory operations people may determine from which vendor to purchase the oil and how much to purchase from each vendor. This ability is critical in just in time manufacturing also known as Kanban .

In another example a tugboat holding 20 000 bottles of wine makes its way from Chicago to New Orleans. A BLEATS comprising the embodiments herein may be able to determine at all relevant times where the shipment is and also other parameters associated with the shipment such as the temperature of assets within the shipment. If for example that temperature rises above a pre set threshold e.g. 15 degrees Celsius the BLEATS may send a message to the shipper or any person or device in a position to control the temperature of the asset s environment to lower the temperature of the shipment thereby preventing the shipment from getting ruined. Consistent with the broadcast embodiments above urgent conditions can be addressed. If for example the temperature rises above 18 degrees Celsius then every leaf node that detects this information sends messages to any entity with which it can communicate including other BLE devices outside the system that the system is in a state of emergency and the temperature must be lowered.

In the context of wearable devices from a consumer s point of view his experience improves with digital automata that he bears on his person or on his belongings being continually tracked and monitored when data from such devices allows a controlling programmatic system to perform tasks for him without his initiating action. Examples of wearable devices include wristbands watches clips clothing glasses and more. Having continuous real time access to this sort of information is extremely valuable in individual endeavors as well as shown by the following examples. Such wearable devices may be considered leaf nodes.

In an example a traveler books a hotel room online. The hotel operations and reservation system utilize a BLEATS type system described herein. The hotel may automatically charge the traveler s credit card and assigns him a room number and a time it will be available for him. In a BLEATS system as described herein then the traveler does not need to check in at the front desk. Instead he proceeds to the room itself. There his electronically active ID tag communicates with the door which unlocks as he approaches. He enters his room and goes to bed. Inside the room his tag communicates with sensors in the room which activates wireless for him to use on a particular broadband channel and turns on the TV to his preselected movie.

In another example an elderly person with a wearable device experiences a fall in her home. She does not move. Her wearable device may detect the fall and a subsequent lack of movement and then alert emergency responders.

In another example a person rents a car at rental facility. The person completes the transaction online and in the process learns where his car is. He walks to the car which identifies him from a wear able device i.e. a leaf node . The system having identified him unlocks the car and allows him to exit the facility.

In the context of Internet of Things it is known that connected devices are those devices such as thermostats smart locks stationary medical devices light controllers security systems and many more. In an example a hotel chain has multiple vendors each for smart locks thermostats lighting control water temperature and purity replenishables systems entertainment systems. In all they have many vendors and each of these has its own proprietary data and data structures its own cloud instance and its own dashboard currently making these impractical to centrally monitor manage and interoperate. If the hotel used the BLEATS described herein and all the devices were tied into the BLEATS by virtue of being assets of the BLEATS a guest could programmatically be able to specify preferences such as when the guest opens the smart lock and the temperature is over X degrees in the room have the air conditioner go on. The guest can preprogram the lights to his desired brightness and turn on the stereo to soft music. Such is enabled by allowing an operator user access to the applications in communication with a BLEATS herein. Instructions and preferences can be pushed to each device within the BLEATS due to the architecture and capabilities described herein. This aspect is not offered by existing systems where the devices and control programs live in disparate proprietary data structures each having has its own cloud instance and dashboard or control interface.

Another embodiment of a BLEATS is in the context of a lighting control system. A BLEATS according to the embodiments herein would enable control over aspects including but not limited to the following 

A BLEATS based lighting system facilitates controlling individual light elements with leaf nodes and controlling the overall system through reader nodes. The advantages include 

A BLEATS lighting system of the type above can integrate into a non BLEATS lighting system. Currently lighting systems do not have the capability to communicate with local devices on the Internet of Things IoT . This demonstrates how BLEATS being built into or working in conjunction with such lighting elements or access points provides local communication.

In another embodiment of a BLEATS the BLEATS works in conjunction with an HVAC control system. The BLEATS may control multiple different heating cooling and ventilation elements connected to and controlled by the leaf nodes without adding control wiring. As with embodiments above elements can be added more removed dynamically. The HVAC BLEATS may also tie into other leaf node controlled devices such as thermometers motion sensors and worn leaf nodes tell it where people are and what their climate preferences are.

As mentioned above a BLEATS interacts with BLE enabled devices outside of the BLEATS per se. In an example GPS may not work in an indoor venue. A person with a BLE enabled cell phone may be located in the venue. Determining the exact position of this BLE enabled device and hence this person may be quite valuable for various reasons for example the person may not be authorized to be in a particular location the person may have an interest in items nearby to his current location it may be useful to guide the person to move towards some location or some object. In addition the person may belong to a set of people who can address some particular issue and it is useful for the system or operator to know the locations of all such persons so that the operator or system can determine an appropriate person to address the problem.

In embodiments the venue has installed in it a set of leaf nodes whose locations are known. When the person moves through this field of leaf nodes the leaf nodes or reader nodes determine from the strength directionality and I and Q data of the signal coming from the person s BLE enabled phone the angular direction of that phone from two or more of those leaf nodes or reader nodes. In embodiments where applicable leaf nodes send this this information to a reader node or where applicable the reader nodes send the information to the cloud server. The system can correlate the data and determine user s location as provided herein.

In another illustrative and non limiting example of a BLEATS the BLEATS may be integrated into a military base or warship which may use BLE enabled devices to track all of its assets. Every asset on the base or warship may be associated with a leaf node which may communicate with receiver nodes located throughout the base or warship. The receiver nodes may connect to a local network and local servers rather than to the Internet. This may help enable an operations chief of the base or warship to access the local servers and know the status of every asset on the base or warship from warheads to sacks of potatoes.

In another example there may be an array of drones each drone controlled by an individual leaf node. The array of drones may fly in tight formation and communicate control and information with a few master drones that are run by receiver nodes. The receiver nodes may communicate using Internet protocols with one or more of a cloud server and a human operator. The human operator may control all of the drones using a console handheld device and the like where the control commands are communicated to the master drones and from their to the individual leaf nodes.

In another example there is a field covered with landmines at random locations. In a mine clearing exercise it may be inefficient to cover the entire field linearly with one device referred to herein as a clearing device. It may be more efficient for a row of devices each moving parallel through the field. Controlling such a row currently requires one human being per clearing device. Using BLEATS each clearing device may be controlled by a leaf node with reader node s placed along the row. With the reader nodes in communication with the cloud server and operators accessing a control application run on or in connection with the cloud server operators may control the clearing devices in the row.

A BLEATS according to the system above enables new advantages. For example according to the embodiment herein a reader node can have a method for on a particular BLE channel to deliver notifications and ancillary contextual information from connected devices untethered to and independent of any mobile device such as smartphone or tablet and ability to reply or take responsive action to the notification.

Another advantage of the BLEATS is that it enables a universal virtual reader compatible with multiple platforms including but not limited to Windows Android and iOS providing ubiquity of the channel through any number of form factors.

In some implementations information about real time location management and asset tagging system based on a leaf data communication device and beam forming gateway node may be facilitated as described in the following clauses.

a location processing engine located on a server that is remote from the at least one leaf node device and

at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node wherein the location processing engine processes information relayed by the beam forming receiver hardware node to facilitate determination of the location of the leaf node.

at least one Bluetooth Low Energy enabled leaf node device adapted communicate through a gateway node and

a processing engine located on a server that is remote from the at least one leaf node device for managing information relating to the leaf node.

at least one leaf data communication node adapted to be attached to a physical asset wherein the leaf data communication node is configured to continuously communicate in real time using the Bluetooth Low Energy protocol with at least one receiver node that collects real time information about the location of a plurality of assets.

a remote location processing facility located on a server that is remote from the at least one leaf node device for determining the location of the at least one leaf node device 

at least one beam forming receiver hardware node for collecting and communicating sectorized data relating to the at least one leaf node and

a Bluetooth Low Energy BLE enabled user device having an application for communicating with at least one of the beam forming receiver hardware node and the at least one leaf node to display the current location of the at least one leaf node wherein the location of the leaf node is determined by at least one of the remote location processing facility and the beam forming receiver hardware node.

taking at least one of signal strength information proximity information and phase angle information collected via Bluetooth Low Energy communication signals from the leaf node device 

delivering the collected information to a processing engine that is remote from the leaf node device and

at least one beam forming gateway node for managing data relating to at least one leaf node wherein the leaf node is adapted to use the Bluetooth Low Energy protocol.

at least one Bluetooth Low Energy enabled leaf node device adapted to be attached as an asset tag on an asset and adapted to communicate through a gateway node to a remote location processing facility.

a software application installed on a mobile hardware device for communicating by the BLE data communication with at least one of a beam forming gateway node that collects data related to the leaf node device the leaf node device and a processing engine that is remote from the leaf node device to present at least one of location data event data state data and sensor data related to the least one leaf node.

at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node wherein the beams of the gateway node are shaped into sectors by use of a plurality of patch antennas.

a location processing engine located on a server that is remote from the at least one leaf node device and

at least one beam forming receiver hardware node for collecting sectorized data relating to at least one leaf node wherein the beams of the beam forming receiver are shaped into sectors by use of at least one antenna selected from the group consisting of a patch antenna a linear antenna a point antenna a spherical antenna a circular polarization antenna a vertical polarization antenna a horizontal polarization antenna and an omnidirectional antenna with reflectors.

a location processing engine located on a server that is remote from the at least one leaf node device 

a database of the locations of points of interest corresponding to known locations of deployed gateways wherein the known locations are used as a basis for determining the locations of a plurality of leaf nodes that communicate with the gateways using BLE.

a location processing engine located on a server that is remote from the at least one leaf node device 

a location processing engine located on a server that is remote from the at least one leaf node device 

at least one beam forming gateway node for collecting sectorized data relating to at least one leaf node and

a database of the locations of virtual points of interest corresponding to logical locations of beam forming gateway nodes within a flow of assets wherein the logical locations are used for determining the locations of a plurality of leaf nodes within the flow of assets wherein the leaf nodes communicate with the beam forming gateway nodes using BLE.

a location processing engine located on a server that is remote from the at least one leaf node device 

a database of the locations of virtual points of interest corresponding to logical locations of gateway nodes within a flow of assets wherein the logical locations are used for determining the locations of a plurality of leaf nodes within the flow of assets wherein the leaf nodes communicate with the gateway nodes using BLE.

a device management system for mapping physical devices and handling sampled data with respect to the devices 

a process flow editor having a user interface to allow a user to at least one of access a stored process flow from a library and edit a process flow to create a customized process flow such that an asset may be tracked using the RTLS system with respect to at least one of a physical location corresponding to the process flow and a logical location with respect to a logical position within the process flow.

transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types step 

determining a transition of at least one leaf data communication node from a state or location to another state or location step 

tagging at least one event as a leaf data communication node transitions from first state to second state step 

calculating at least one metric as to the location of at least one leaf data communication node step and

transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types step 

transforming the event stream data based on use of a library of contextual metadata about the raw event types to produce transformed event types step 

determining a transition of at least one leaf data communication node from a state or location to another state or location step and

providing a reference data library containing at least one of device metadata context data business rules for stages of a processing pipeline business rules for a domain and process flows for devices that use the data communication nodes wherein the rules and flows may be customized for particular situations.

time division multiplexing connections of the leaf nodes to the gateway in a time domain protocol and managing each of the connections in the time domain.

providing a MAC layer designed to manage connections in the time domain thereby enabling concurrent connections of a large number of leaf nodes to a receiver of the gateway node.

providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes and

providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes and

providing a plurality of physical radios in each sector of the beam forming hardware receiver node wherein the plurality of radios have spectral diversity among them.

providing at least one beam forming receiver hardware node for collecting sectorized data relating to a plurality of leaf nodes step 

providing a plurality of physical radios in each sector of the beam forming hardware receiver node step 

in an operating phase steering at least one beam to avoid at least one null area mapped during the training phase step .

providing a virtualized connection manager that manages connections of a plurality of leaf nodes to a receiver node in a TDM protocol.

providing at least one beam forming gateway node having a plurality of radios for collecting sectorized data from a plurality of leaf nodes and

using a TDM protocol of the beam forming gateway node to enable the beam forming gateway node to handle more than one hundred leaf node device data connections per radio of the beam forming gateway node.

providing at least one beam forming receiver hardware node having a plurality of radios for collecting sectorized data from a plurality of leaf nodes and

using multiple radios per sector to enable long range communication between the beam forming receiver hardware node and the leaf nodes.

at least one beam forming receiver hardware node for collecting sectorized data relating to at least one leaf node 

a location processing engine located on a server that is remote from the at least one leaf node device wherein the location processing engine uses machine learning on the data flow collected by the beam forming receiver hardware node about the leaf node device to help determine the location of the leaf node and

at least one leaf node wherein machine learning is also performed on at least one of the leaf node and the beam forming hardware receiver node.

a location processing engine located on a server that is remote from the at least one leaf node device wherein the location processing engine orchestrates information for the gateway node at least one leaf node and at least one mobile application that presents information about the location of the at least one leaf node wherein the location processing engine includes an interpreter for interpreting heterogeneous languages used by the beam forming hardware receiver node the leaf node and the mobile application.

a location processing engine using a plurality of servers that are remote from the at least one leaf node device wherein the location processing engine load balances resources for a plurality of gateway nodes and wherein if a server of the plurality of servers becomes unavailable an alternate server is designated to manage data relayed by the gateway node that was served by the unavailable server.

a location processing engine located on a server that is remote from the at least one leaf node device wherein real time processing of location data about the leaf node and sensor data from the leaf node is distributed across the gateway node and the location processing engine.

providing a location processing engine located on a server that is remote from the at least one leaf node device step 

using the workflow management system guiding execution of at least one task of a workflow based on the asset location information step .

a location processing engine located on a server that is remote from the at least one leaf node device 

at least one gateway node for collecting data relating to at least one leaf node wherein a software language is provided to allow a user to at least one of query and control at least one of the leaf node and the gateway node based on at least one of an attribute and an event.

using the rolling advertisement packet data to correlate information about the leaf node as the information is detected by a plurality of receiver hardware nodes.

using the rolling advertisement packet time stamp data to synchronize information across components of the real time location system.

providing a plurality of beam forming gateway nodes for collecting data relating to at least one leaf node 

configuring at least one of a number of radios a number of sectors a type of antenna and a configuration of antennas based on the identified characteristic to facilitate communication between the gateway node and the leaf node.

using the rolling advertisement packet data from a moving leaf node device to identify the leaf node as being present in the proximity of a gateway node.

A gateway node that is configured to search for proximate Bluetooth Low Energy BLE devices through a sectorized spatial region and across a range of frequency spectral bands

a gateway node that is configured to search for proximate Bluetooth Low Energy BLE devices through a sectorized spatial region and across a range of frequency spectral bands in order to establish communication with at least one such BLE device and

a channel switching facility of the gateway node that upon establishing communication with the BLE device switches to a data channel for continued communication with the BLE device.

a synchronization facility of such gateway nodes for exchanging PTP synchronization data among them to synchronize the gateway nodes to nanosecond resolution and

a correlation facility for correlating sampled I and Q components of signals received by the gateway nodes from the leaf node device to determine the leaf node device position at a point in time.

a synchronization facility of such gateway nodes for exchanging PTP synchronization data among them to synchronize the gateway nodes to nanosecond resolution wherein once synchronized the gateway nodes test interference with each other by simultaneously transmitting a packet and a plurality of gateway nodes monitor and sample the I and Q data with respect to the packet and wherein the system uses the interference test data to determine a map of gateway node interactions.

upon detecting the collision having each of the leaf nodes wait a random amount of time then retransmit the messages thereby reducing the likelihood of a second collision of the messages.

providing a geo location system of the gateway nodes to establish the positions of the gateway nodes and

storing the positions of the gateway nodes in a data storage facility such that the positions can be used as references in determining relative locations of the leaf nodes.

a location processing engine located on a server that is remote from the at least one leaf node device and

at least one gateway node for collecting data relating to at least one leaf node wherein the location processing engine processes information relayed by the gateway node to facilitate determination of the location of the leaf node wherein the communication between the gateway node and the leaf node device is configured to hop between available BLE frequencies.

a location processing engine located on a server that is remote from the at least one leaf node device and

at least one gateway node for collecting data relating to at least one leaf node wherein the location processing engine processes information relayed by the gateway node to facilitate determination of the location of the leaf node wherein the priority of communication between the gateway node and a leaf node device may be managed based on a communication bit that designates a message as a high priority message.

at least one access point device for providing Internet access to a region in which the leaf node may be located wherein the gateway node is integrated as a card in the chassis of the access point device and the gateway node and the access point device communicate through the backplane of the access point device.

The methods and systems described herein may be deployed in part or in whole through a machine that executes computer software program codes and or instructions on a processor. Any processing facility unless otherwise indicated may be part of a server client network infrastructure mobile computing platform stationary computing platform or other computing platform. A processor may be any kind of computational or processing device capable of executing program instructions codes binary instructions and the like. The processor may be or include a signal processor digital processor embedded processor microprocessor or any variant such as a co processor math co processor graphic co processor communication co processor and the like and the like that may directly or indirectly facilitate execution of program code or program instructions stored thereon. In addition the processor may enable execution of multiple programs threads and codes. The threads may be executed simultaneously to enhance the performance of the processor and to facilitate simultaneous operations of the application. By way of implementation methods program codes program instructions and the like described herein may be implemented in one or more thread. The thread may spawn other threads that may have assigned priorities associated with them the processor may execute these threads based on priority or any other order based on instructions provided in the program code. The processor may include memory that stores methods codes instructions and programs as described herein and elsewhere. The processor may access a storage medium through an interface that may store methods codes and instructions as described herein and elsewhere. The storage medium associated with the processor for storing methods programs codes program instructions or other type of instructions capable of being executed by the computing or processing device may include but may not be limited to one or more of a CD ROM DVD memory hard disk flash drive RAM ROM cache and the like.

A processor may include one or more cores that may enhance speed and performance of a multiprocessor. In embodiments the process may be a dual core processor quad core processors other chip level multiprocessor and the like that combine two or more independent cores called a die .

The methods and systems described herein may be deployed in part or in whole through a machine that executes computer software on a server client firewall gateway hub router or other such computer and or networking hardware. The software program may be associated with a server that may include a file server print server domain server internet server intranet server and other variants such as secondary server host server distributed server and the like. The server may include one or more of memories processors computer readable media storage media ports physical and virtual communication devices and interfaces capable of accessing other servers clients machines and devices through a wired or a wireless medium and the like. The methods programs or codes as described herein and elsewhere may be executed by the server. In addition other devices required for execution of methods as described in this application may be considered as a part of the infrastructure associated with the server.

The server may provide an interface to other devices including without limitation clients other servers printers database servers print servers file servers communication servers distributed servers and the like. Additionally this coupling and or connection may facilitate remote execution of program across the network. The networking of some or all of these devices may facilitate parallel processing of a program or method at one or more location without deviating from the scope of the invention. In addition all the devices attached to the server through an interface may include at least one storage medium capable of storing methods programs code and or instructions. A central repository may provide program instructions to be executed on different devices. In this implementation the remote repository may act as a storage medium for program code instructions and programs.

The software program may be associated with a client that may include a file client print client domain client internet client intranet client and other variants such as secondary client host client distributed client and the like. The client may include one or more of memories processors computer readable media storage media ports physical and virtual communication devices and interfaces capable of accessing other clients servers machines and devices through a wired or a wireless medium and the like. The methods programs or codes as described herein and elsewhere may be executed by the client. In addition other devices required for execution of methods as described in this application may be considered as a part of the infrastructure associated with the client.

The client may provide an interface to other devices including without limitation servers other clients printers database servers print servers file servers communication servers distributed servers and the like. Additionally this coupling and or connection may facilitate remote execution of program across the network. The networking of some or all of these devices may facilitate parallel processing of a program or method at one or more location without deviating from the scope of the invention. In addition all the devices attached to the client through an interface may include at least one storage medium capable of storing methods programs applications code and or instructions. A central repository may provide program instructions to be executed on different devices. In this implementation the remote repository may act as a storage medium for program code instructions and programs.

The methods and systems described herein may be deployed in part or in whole through network infrastructures. The network infrastructure may include elements such as computing devices servers routers hubs firewalls clients personal computers communication devices routing devices and other active and passive devices modules and or components as known in the art. The computing and or non computing device s associated with the network infrastructure may include apart from other components a storage medium such as flash memory buffer stack RAM ROM and the like. The processes methods program codes instructions described herein and elsewhere may be executed by one or more of the network infrastructural elements.

The methods program codes and instructions described herein and elsewhere may be implemented on a cellular network having multiple cells. The cellular network may either be frequency division multiple access FDMA network or code division multiple access CDMA network. The cellular network may include mobile devices cell sites base stations repeaters antennas towers and the like.

The methods programs codes and instructions described herein and elsewhere may be implemented on or through mobile devices. The mobile devices may include navigation devices cell phones mobile phones mobile personal digital assistants laptops palmtops netbooks pagers electronic books readers music players and the like. These devices may include apart from other components a storage medium such as a flash memory buffer RAM ROM and one or more computing devices. The computing devices associated with mobile devices may be enabled to execute program codes methods and instructions stored thereon. Alternatively the mobile devices may be configured to execute instructions in collaboration with other devices. The mobile devices may communicate with base stations interfaced with servers and configured to execute program codes. The mobile devices may communicate on a peer to peer network mesh network or other communications network. The program code may be stored on the storage medium associated with the server and executed by a computing device embedded within the server. The base station may include a computing device and a storage medium. The storage device may store program codes and instructions executed by the computing devices associated with the base station.

The computer software program codes and or instructions may be stored and or accessed on machine readable media that may include computer components devices and recording media that retain digital data used for computing for some interval of time semiconductor storage known as random access memory RAM mass storage typically for more permanent storage such as optical discs forms of magnetic storage like hard disks tapes drums cards and other types processor registers cache memory volatile memory non volatile memory optical storage such as CD DVD removable media such as flash memory e.g. USB sticks or keys floppy disks magnetic tape paper tape punch cards standalone RAM disks Zip drives removable mass storage off line and the like other computer memory such as dynamic memory static memory read write storage mutable storage read only random access sequential access location addressable file addressable content addressable network attached storage storage area network bar codes magnetic ink and the like.

The methods and systems described herein may transform physical and or or intangible items from one state to another. The methods and systems described herein may also transform data representing physical and or intangible items from one state to another.

The elements described and depicted herein including in flow charts and block diagrams throughout the figures imply logical boundaries between the elements. However according to software or hardware engineering practices the depicted elements and the functions thereof may be implemented on machines through computer executable media having a processor capable of executing program instructions stored thereon as a monolithic software structure as standalone software modules or as modules that employ external routines code services and so forth or any combination of these and all such implementations may be within the scope of the present disclosure. Examples of such machines may include but may not be limited to personal digital assistants laptops personal computers mobile phones other handheld computing devices medical equipment wired or wireless communication devices transducers chips calculators satellites tablet PCs electronic books gadgets electronic devices devices having artificial intelligence computing devices networking equipment servers routers and the like. Furthermore the elements depicted in the flow chart and block diagrams or any other logical component may be implemented on a machine capable of executing program instructions. Thus while the foregoing drawings and descriptions set forth functional aspects of the disclosed systems no particular arrangement of software for implementing these functional aspects should be inferred from these descriptions unless explicitly stated or otherwise clear from the context. Similarly it will be appreciated that the various steps identified and described above may be varied and that the order of steps may be adapted to particular applications of the techniques disclosed herein. All such variations and modifications are intended to fall within the scope of this disclosure. As such the depiction and or description of an order for various steps should not be understood to require a particular order of execution for those steps unless required by a particular application or explicitly stated or otherwise clear from the context.

The methods and or processes described above and steps thereof may be realized in hardware software or any combination of hardware and software suitable for a particular application. The hardware may include a dedicated computing device or specific computing device or particular aspect or component of a specific computing device. The processes may be realized in one or more microprocessors microcontrollers embedded microcontrollers programmable digital signal processors or other programmable device along with internal and or external memory. The processes may also or instead be embodied in an application specific integrated circuit a programmable gate array programmable array logic or any other device or combination of devices that may be configured to process electronic signals. It will further be appreciated that one or more of the processes may be realized as a computer executable code capable of being executed on a machine readable medium.

The computer executable code may be created using a structured programming language such as C an object oriented programming language such as C or any other high level or low level programming language including assembly languages hardware description languages and database programming languages and technologies that may be stored compiled or interpreted to run on one of the above devices as well as heterogeneous combinations of processors processor architectures or combinations of different hardware and software or any other machine capable of executing program instructions.

Thus in one aspect each method described above and combinations thereof may be embodied in computer executable code that when executing on one or more computing devices performs the steps thereof. In another aspect the methods may be embodied in systems that perform the steps thereof and may be distributed across devices in a number of ways or all of the functionality may be integrated into a dedicated standalone device or other hardware. In another aspect the means for performing the steps associated with the processes described above may include any of the hardware and or software described above. All such permutations and combinations are intended to fall within the scope of the present disclosure.

While the invention has been disclosed in connection with the preferred embodiments shown and described in detail various modifications and improvements thereon will become readily apparent to those skilled in the art. Accordingly the spirit and scope of the present invention is not to be limited by the foregoing examples but is to be understood in the broadest sense allowable by law.

