---

title: Machine-to-machine network assisted bootstrapping
abstract: The service layer may leverage the access network infrastructure so that applications on a device may bootstrap with a machine-to-machine server without requiring provisioning beyond what is already required by the access network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09614846&OS=09614846&RS=09614846
owner: Convida Wireless, LLC
number: 09614846
owner_city: Wilmington
owner_country: US
publication_date: 20160421
---
This application is a continuation of U.S. patent application Ser. No. 14 285 397 filed May 22 2014 entitled MACHINE TO MACHINE NETWORK ASSISTED BOOTSTRAPPING which claims the benefit of U.S. Provisional Patent Application No. 61 826 176 filed on May 22 2013 entitled ACCESS NETWORK ASSISTED BOOTSTRAPPING. The contents of U.S. patent application Ser. No. 14 285 397 and 61 826 176 are hereby incorporated by reference herein in their entirety.

Machine to machine M2M technologies allow devices to communicate more directly with each other using wired and wireless communications systems. M2M technologies enable further realization of the Internet of Things IoT a system of uniquely identifiable objects and virtual representations of such objects that communicate with each other over a network such as the Internet. IoT may facilitate communication with even mundane everyday objects such as products in a grocery store or appliances in a home and thereby reduce costs and waste by improving knowledge of such objects. For example stores may maintain very precise inventory data by being able to communicate with or obtain data from objects that may be in inventory or may have been sold.

Several efforts have been undertaken to develop standardized architectures for machine to machine communication. These include 3rd Generation Partnership Project 3GPP Machine Type Communication MTC architecture the ETSI M2M architecture and the oneM2M architecture. These architectures are summarized briefly below.

The 3GPP evolved packet core EPC network was not originally designed in a way that is optimized for handling machine to machine M2M communications also referred to as machine type communications MTC in which machines or devices communicate with each other over the network such as communications involving smart metering home automation eHealth consumer products fleet management etc. Thus in Release 11 R11 of the 3GPP specifications 3GPP enhanced the interworking capabilities of the UMTS core network for machine type communications machine to machine communications. Interworking refers to a server or application interfacing to the core network for the purposes of exchanging information controlling devices or monitoring devices or communicating with devices. shows portions of the MTC architecture that is presented by 3GPP in TS 23.682 V11.5.0.

As shown in user equipment may connect to the EPC over radio access network RAN which may comprise E UTRAN LTE access network . The Evolved NodeB eNodeB 3 is the base station for LTE radio. In this figure the EPC comprises a number of network elements including Serving Gateway Serving GW Packet Data Network Gateway PDN GW or P GW mobility management entity MME and Home Subscriber Server HSS .

HSS is a database that contains user related and subscriber related information. It also provides support functions in mobility management call and session setup user authentication and access authorization.

The gateways S GW and P GW deal with the user plane. They transport IP data traffic between the User Equipment UE and an external network s . S GW is the point of interconnect between the radio side and the EPC. As its name indicates this gateway serves the UE by routing incoming and outgoing IP packets. It is the anchor point for intra LTE mobility i.e. in case of handover between eNodeBs in the RAN and between LTE and other 3GPP accesses. It is logically connected to the other gateway the P GW .

The P GW is the point of interconnect between the EPC and external IP networks such as the Internet. These networks are called PDNs Packet Data Networks hence the name. The P GW routes packets to and from the PDNs. The P GW also performs various functions such as IP address IP prefix allocation or policy control and charging. 3GPP specifies these gateways operate independently but in practice they may be combined in a single box by network vendors.

The MME deals with the control plane. It handles the signaling related to mobility and security for E UTRAN access. The MME is responsible for the tracking and the paging of UEs in idle mode. It is also the termination point of the Non Access Stratum NAS .

As mentioned above a UE can reach the EPC using E UTRAN however this is not the only access technology supported. 3GPP specifies support of multiple access technologies and also the handover between these accesses. The idea is to bring convergence using a unique core network providing various IP based services over multiple access technologies. Existing 3GPP radio access networks are supported. 3GPP specifications define how interworking is achieved between an E UTRAN LTE and LTE Advanced GERAN radio access network of GSM GPRS and UTRAN radio access network of UMTS based technologies WCDMA and HSPA .

The architecture also allows non 3GPP technologies to interconnect the UE and the EPC. Non 3GPP means that these accesses were not specified in 3GPP. These technologies include for example WiMAX cdma2000 WLAN or fixed networks. Non 3GPP accesses can be split into two categories the trusted ones and the untrusted . Trusted non 3GPP accesses can interact directly with the EPC. Untrusted non 3GPP accesses interwork with the EPC via a network entity called the ePDG for Evolved Packet Data Gateway not shown . The main role of the ePDG is to provide security mechanisms such as IPsec tunneling of connections with the UE over an untrusted non 3GPP access. 3GPP does not specify which non 3GPP technologies should be considered trusted or untrusted. This decision is made by the operator.

As further illustrated in service capability server SCS may provide services to the core network devices and applications. The SCS may also be called an M2M Server MTC Server a Service Capability Layer SCL or a Common Services Entity CSE . SCS may be controlled by the operator of the home public land mobile network HPLMN or by an MTC service provider. An SCS may be deployed inside or outside the operator domain. If an SCS is deployed inside the operator domain the SCS may be an internal network function and may be controlled by the operator. If an SCS is deployed outside the operator domain the SCS may be controlled by a MTC service provider.

In the MTC architecture of SCS may communicate with a machine type communication MTC interworking function MTC IWF via a Tsp reference point i.e. interface . The Tsp reference point is an example of an interface that is used for interworking with the core network.

A UE may communicate through the public land mobile network PLMN which includes radio access network RAN with SCS s and or other MTC UE s . An MTC UE may host one or more MTC applications . The MTC applications may also be hosted on one or more application servers AS e.g. AS . The MTC application may be a MTC communication endpoint that may interact with SCS AS MTC applications or other UE MTC applications.

An application server AS e.g. AS may also host one or more MTC applications. The AS may interface with the SCS and the SCS may provide services to an application s running on the AS . The MTC applications on an AS may interact with SCSs UE MTC applications or other MTC applications.

The MTC inter working function MTC IWF hides the internal PLMN topology from the SCS . The MTC IWF may relay and or translate signaling protocols used between itself and the SCS e.g. over the Tsp reference point to support MTC functionality e.g. MTC UE triggering in the PLMN. For example the SCS may request that the MTC IWF send a trigger to a MTC device. The MTC IWF may deliver the MTC trigger to the MTC device via SMS not shown for example. The MTC device based on the trigger may respond to the SCS . The MTC device may for example respond with a sensor reading. When the MTC device responds to the SCS the MTC device may use a packet data network PDN packet data protocol PDP connection via P GW to communicate with the SCS . The MTC device may connect with the SCS using an IP connection.

The MTC IWF may authorize the SCS before the SCS may establish communication with the 3GPP network. For example when the SCS makes a trigger request on the Tsp reference point the MTC IWF may check whether the SCS is authorized to send the trigger request and that the SCS has not exceeded its quota or rate of trigger submissions.

The ETSI M2M architecture is illustrated in . In the ETSI M2M architecture a service capability layer SCL uses core network functionalities through a set of exposed interfaces to provide service capabilities to the network. An SCL may interface to one or several different core networks.

In the ETSI M2M architecture the network comprises M2M devices e.g. device M2M gateways e.g. gateway and M2M servers e.g. M2M server . A device application DA may be executing on an M2M device a gateway application GA may be executing on an M2M gateway and a network application NA may be executing on an M2M server. As further shown a device e.g. device may implement M2M service capabilities using a device service capabilities layer DSCL e.g. DSCL a gateway may implement a gateway SCL GSCL and a server may implement a network SCL NSCL e.g. NSCL .

The mIa reference point allows a network application to access the M2M service capabilities in an M2M server.

The dIa reference point allows a device application residing in an M2M device to access the different M2M service capabilities in the same M2M device or in an M2M gateway and allows a gateway application residing in an M2M gateway to access the different M2M service capabilities in the same M2M gateway.

The mId reference point allows M2M service capabilities layer residing in an M2M device or M2M gateway to communicate with the M2M service capabilities layer in the network. The mId reference point uses core network connectivity functions as an underlying layer.

Further according to the ETSI M2M architecture an M2M entity e.g. an M2M functional entity such as a device gateway or server platform that may be implemented by a combination of hardware and or software may provide an application or service. For example a light sensor may provide data indicating detected light levels or a thermostat may provide temperature data and the ability to adjust air conditioning controls. This data may be made available as a resource that may be accessed by other M2M entities and that essentially serves as a means to exchange data between M2M entities. A resource may be a uniquely addressable representation of data that may be addressed using a Universal Resource Indicator URI or Universal Resource Locator URL . The availability of such resources may be communicated among M2M entities via the M2M service capabilities layer SCL .

The M2M SCL is also a functional entity that may be implemented using a combination of hardware and software and provides functions exposed on the reference points i.e. functional interfaces between M2M entities mentioned above. For example the M2M SCL may provide common service functionalities that are shared or commonly used by different M2M applications and or services. M2M service capabilities may use functions and capabilities of the 3GPP core network architecture through a set of exposed interfaces e.g. existing interfaces specified by 3GPP 3GPP2 ETSI TISPAN etc. and may also interface to one or more other core networks. M2M devices and entities are typically organized into M2M network domains. In many implementations an M2M server e.g. M2M server configured with a network SCL entity NSCL may maintain resources and resource data for use by other devices e.g. other M2M devices and M2M gateways in the same M2M network domain.

Still referring to NSCL may be in network domain and configured with network application NA at M2M server platform . NA and NSCL may communicate via reference point mIa . The mIa reference points may allow an NA to access the M2M service capabilities available from an NSCL in an M2M domain. Also within network domain may be GSCL and gateway application GA that may be configured at M2M gateway device . GSCL and GA may communicate using reference point dIa . Also within network domain may be DSCL and device application DA that may be configured at M2M device . DSCL and DA may communicate using reference point dIa . Each of GSCL and DSCL may communicate with NSCL using reference point mId . In general dIa reference points allow device and gateway applications to communicate with their respective local service capabilities i.e. service capabilities available at a DSCL and a GSCL respectively . The mId reference point allows an M2M SCL residing in an M2M device e.g. DSCL or an M2M gateway e.g. GSCL to communicate with the M2M service capabilities in the network domain and vice versa e.g. NSCL .

Typically the device gateway and M2M server platform comprise computing devices such as the devices illustrated in and and described below. The NSCL DSCL GSCL NA GA and DA entities typically are logical entities that are implemented in the form of software executing on the underlying device or platform to perform their respective functions in the system . The M2M server of the ETSI M2M architecture may be an SCS e.g. SCS of in the 3GPP MTC architecture.

As further shown in NSCL may be in domain with NA . NA and NSCL may communicate via mIa reference point . There may be an NSCL in network domain and NSCL in network domain . mIm reference point may be an inter domain reference point that allows M2M network nodes in different network domains such as NSCL in network domain NSCL in network domain NSCL in network domain or NSCL in network domain to communicate with one another. For simplicity herein the term M2M server may be used to indicate a service capability server SCS NSCL application server NA or an MTC server. In addition the term user equipment UE as discussed herein may apply to GA GSCL DA or DSCL. A UE may comprise any wireless device capable of communicating in a 3GPP or other wireless network such as an M2M or MTC device or gateway and including for example machines sensors appliances or the like a mobile station a fixed or mobile subscriber unit a pager a personal digital assistant PDA a computer a mobile phone or smart phone or any other type of device capable of operating in a wired or wireless environment.

While the 3GPP MTC and ETSI M2M architectures are described by way of background herein and may be used to illustrate various embodiments described hereinafter it is understood that implementations of the embodiments described hereinafter may vary while remaining within the scope of the present disclosure. One skilled in the art will also recognize that the disclosed embodiments are not limited to implementations using the 3GPP or ETSI M2M architectures discussed above but rather may be implemented in other architectures and systems such as oneM2M MQ Telemetry Transport MQTT and other related M2M systems and architectures.

One process that is often performed in an M2M system is called bootstrapping. Bootstrapping is a process by which entities e.g. an end user device and server perform mutual authentication and key agreement to establish a relationship enabling secure communications between them. Mutual authentication is a procedure in which each party proves its identity to the other. Authentication helps prevent a rogue device from registering with a server by pretending it is a legitimate end user device. Authentication also helps prevent a fraudulent server from performing a man in the middle attack which may consist of the fraudulent server establishing a connection with an end user device by pretending that it is a legitimate server.

Key agreement is a procedure in which the communicating entities derive a security key that they can then use to secure communications between them for example by an encryption process that uses the security key. A feature of a key agreement mechanism is that the key is not transmitted. The key derivation function may be based on a shared secret value that is meant for only an end user device and server to know for example. This shared secret is also not transmitted. The key derivation function is designed such that it is prohibitively computationally complex for an eavesdropper who does not know the shared secret to compute the key by observing the messages that are transmitted during the key agreement procedure. An overview of some authentication and key agreement mechanisms is discussed herein. An overview of some authentication and key agreement mechanisms such as Extensible Authentication Protocol EAP and Protocol for Carrying Authentication for Network Access PANA are discussed below to give further context to disclosed embodiments.

Extensible authentication protocol EAP is not an authentication method in itself but rather a common authentication framework that can be used to implement specific authentication methods. In other words EAP is a protocol that allows the Peer Authenticator and Authentication Server to negotiate what authentication method will be used. The selected authentication method is then run inside of the EAP protocol. EAP is defined in RFC 3748. RFC 3748 describes the EAP packet format procedures as well as basic functions such as negotiation of the desired authentication mechanism.

Bootstrapping can be an expensive process in that it often requires that secret keys or certificates be provisioned in a device in order to achieve the desired level of security. This is a particularly important problem in the machine to machine field because of the large number of devices that are required to bootstrap with an SCS or M2M server. Disclosed herein are methods devices and systems for at least two bootstrapping approaches. In an embodiment the service layer may leverage the access network infrastructure so that D GSCL s may bootstrap with an M2M server without requiring provisioning beyond what is already required by the access network. In this approach MTC IWF may provide a secure connection to an AAA server of the access network. The service layer key material may be provided to the M2M server by the access network s AAA server when a UE attaches to the access network. In another embodiment procedures are defined so that a M2M server uses the infrastructure of the core network to authenticate and authorize a device. For example an EAP PANA based approach may use an HSS as an EAP authentication server so that a UE and a M2M server can perform EAP AKA PANA authentication.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter. Furthermore the claimed subject matter is not limited to limitations that solve any or all disadvantages noted in any part of this disclosure.

Before proceeding it should be noted that embodiments described herein may be described in terms of a representational state transfer REST architecture with components and entities described conforming to the constraints of a REST architecture RESTful architecture . A RESTful architecture is described in terms of the constraints applied to components entities connectors and data elements used in the architecture rather than in terms of physical component implementation or communications protocols used. Thus the roles and functions of the components entities connectors and data elements will be described.

In a RESTful architecture representations of uniquely addressable resources are transferred between entities. The ETSI M2M specification e.g. TS 102 921 and TS 102 690 as discussed herein has standardized the resource structure that resides on an SCL. When handling resources in a RESTful architecture there are basic methods that may be applied to resources such as Create create child resources Retrieve read the content of the resource Update write the content of the resource or Delete delete the resource. One skilled in the art will recognize that implementations of the instant embodiments may vary while remaining within the scope of the present disclosure. One skilled in the art will also recognize that the disclosed embodiments are not limited to implementations using the ETSI M2M architecture that is described herein to describe exemplary embodiments. The disclosed embodiments may be implemented in other architectures and systems as well such as oneM2M and other M2M systems and architectures.

The EAP PANA approach and EAP access network based approach discussed herein may allow the service layer to be more lightweight. In the EAP PANA and the EAP access network based approaches an interface is provided from an NSCL of a M2M server to the access network but this interface is not completely defined by the ETSI M2M specifications. The ETSI M2M specifications including section 8.3.2 of the ETSI M2M architecture specification and section 6.2 of the ETMS M2M mIa dIa mId specification provide support for access network assisted bootstrapping methods as discussed herein. Key agreement examples disclosed herein include a D GSCL and M2M server deriving an M2M service layer root key kmr .

Bootstrapping approaches disclosed herein are similar to the access network assisted M2M bootstrap procedures that are outlined in section 8.3.2 of the ETSI M2M architecture specification ETSI TS 102 690 and ETSI TS 102 921. As discussed in further detail below the ETSI M2M architecture is used as a baseline and is extended to make the processes more efficient and to better exploit the capabilities of the access network. The access network may generally be considered the part of a telecommunications network which connects subscribers to their immediate application service provider.

Each bootstrapping method disclosed herein may i leverage the core network infrastructure to allow a D GSCL of a UE hereinafter UE D GSCL to perform mutual authentication with an NSCL of an M2M server hereinafter M2M server ii leverage the core network infrastructure e.g. home public land mobile network to derive the service layer root key Kmr as part of the bootstrapping process and iii integrate the registration process so when the bootstrapping process is complete the UE D GSCL will be registered with the M2M server.

One of the bootstrapping approaches disclosed herein is an EAP PANA based approach. In summary an EAP PANA based approach may use a home subscriber server HSS as an EAP authentication server e.g. authentication server so that a UE D GSCL and a M2M server can perform EAP AKA PANA authentication. In this approach the UE D GSCL is considered the EAP Peer e.g. EAP peer and the M2M server is considered the EAP Authenticator e.g. EAP Authenticator . The M2M server contacts the EAP authentication server e.g. HSS via the machine type communication inter working function MTC IWF .

MTC IWF hides the core network topology from M2M Server . Thus EAP authentication server may include an entity other than HSS such as an authentication authorization and accounting AAA server not shown . In ETSI terminology MTC IWF is M2M authentication server MAS or an interface to the MAS. The M2M service bootstrap function MSBF is part of M2M server .

With reference to the EAP PANA based architecture as shown in if AKA is used HSS is used as the authentication server because the authentication key Ki is provisioned in the universal integrated circuit card UICC not shown and HSS . If an authentication key is stored in some other medium on UE D GSCL and provisioned in another network node such as an AAA server then the same architecture applies.

A call flow of the EAP PANA AKA bootstrapping procedure is illustrated in and discussed below. illustrates flow of UE D GSCL bootstrapping and registering with M2M server using EAP PANA AKA. At step a PANA Client Initiation PCI message is sent by UE D GSCL to M2M server . PCI message is defined in the PANA specification IETF RFC 5191. The PCI message sent at step is a registration request. The destination IP Address of the PCI message is the IP address of M2M server and the destination port number may be a PANA port number e.g. port . M2M server uses the source IP Address and port number of the message to determine the IP Address and the port number that UE D GSCL listens on for PANA messages. In an embodiment if M2M server knows the IP address of UE D GSCL and it knows the port number that it listens on for PANA messages then M2M server can initiate bootstrapping. For example this might be desired if M2M server discovers some services that it requires on UE . PANA specification defines no attribute value pairs AVPs in the PCI message. However the ETSI Specification ETSI TS 102 921 defines AVPs which may be used for the PCI message. Table 1 displays examples of some of the AVPs that may be used. MSM MSBF ID M2M NSCL ID M2M D GSCL ID and M2M SP ID are optional AVPs that are used if the D GSCL wants to limit the target registration to certain MSBF s NSCL s or service providers.

At step a PANA Auth Request PAR message is sent to UE D GSCL . A PANA Auth Request PAR message is defined in IETF RFC 5191 the PANA specification . When M2M server does not know the IP address of UE D GSCL then the PAR message may be broadcast multicast or any cast to an address that UE D GSCL is reachable. At step a PANA Auth Answer PAN message which is defined in the PANA specification is sent to M2M server . The PAN message has the M2M Usage Type AVP set to M2M Bootstrapping. 

At step M2M server makes a device authentication request to MTC IWF . The device authentication request includes the 3GPP external device identifier of the device. For this instance the Device Information Request DIR command discussed in more detail herein may be the command executed. The DIR command may include the EAP Payload AVP which carries the EAP Response AKA Identity message that is defined in IETF RFC 4187 the EAP AKA specification . EAP payload is equal to an EAP Response message or an AKA Identity message. The DIR command may also include External ID M2M server ID SCS ID and Requested Param all of which are EAP AKA key material EAP AKA KEY MATERIAL .

At step MTC IWF sends the device authentication request associated with step to HSS . After receiving the device authentication request HSS at step runs the AKA algorithm to generate an authentication token AUTN a random challenge RAND an expected authentication response XRES message authentication code MAC and a M2M Root Key. At step HSS sends MTC IWF the EAP AKA bootstrapping information. The Device Information Answer DIA command discussed in more detail herein may be the command executed. The DIA command may include External ID M2M server ID and Requested Param all of which are EAP AKA key material EAP AKA KEY MATERIAL . The DIA command may also include key material which is equal to RAND XRES AUTN MAC and M2M Root Key.

At step MTC IWF sends EAP AKA bootstrapping information to M2M server . The DIA command may include the EAP Payload AVP. As discussed EAP Payload AVP carries the EAP Request AKA Challenge message which is defined in the EAP AKA specification. The message at step carries the random challenge AT RAND AUTN and MAC. MTC IWF retains XRES and the M2M Root Key Kmr . XRES is not passed to M2M server .

At step UE D GSCL receives the PAR message. The EAP Payload of this PAR message carries the EAP Request AKA Challenge message from step . At step UE D GSCL runs the AKA algorithm and generates a response RES to the random challenge RAND and it uses AUTN to authenticate M2M server . UE D GSCL also derives the M2M root key Kmr as defined by ETSI TS 102 921. At step M2M server receives a PAN message that carries the EAP Response AKA Challenge message which is defined in the EAP AKA specification. At step M2M server makes another device authentication request to MTC IWF to check that the RES from UE D GSCL is correct. The request at step includes the 3GPP External Device Identifier of UE D GSCL . At step the DIR command may be sent and include the includes External ID M2M server ID EAP Payload and Requested Param AVP s. The Requested Param may be set to EAP AKA KEY MATERIAL which includes External ID M2M server ID and Requested Param. The EAP Payload AVP may be equal to the EAP Response message or AKA challenge message.

After MTC IWF receives the request of step MTC IWF at step compares the RES against the XRES. At step M2M server receives a response that includes EAP AKA KEY MATERIAL External ID SCS ID and Requested Param and EAP Payload EAP Success or EAP Failure Key Material which is Kmr . The EAP Success message and EAP Failure message are defined in the EAP specification IETF RFC 3748. At step it is assumed that an EAP success message is received.

At step UE D GSCL receives a PAR message that carries the EAP Success message or EAP Failure message associated with step . The PAR message of step may include additional information such as M2M Bootstrap Result M2M Node ID carries the service provider assigned Node ID M2M D GSCL ID and M2M NSCL ID. At step the PAN message carries information e.g. a set complete or C bit indicating that bootstrapping and registering with M2M server using the EAP AKA protocol over PANA is successful.

A second bootstrapping approach will now be described. This second approach leverages EAP based access network registration for service layer bootstrapping and registration hereinafter EAP access network based approach . In summary an EAP access network based approach may be used in cases where a UE D GSCL uses EAP methods to authenticate with the access network. In this approach MTC IWF provides a secure connection to the access network authentication server. The service layer key material may be provided to the M2M server by the AAA Server of the access network when the UE D GSCL attaches to the access network. By using this approach to exchange security keys the need for the M2M server and UE D GSCL to negotiate security keys over an interface that is not yet secure is avoided. This approach may streamline the process of connecting a device to an M2M server.

Authorization and authentication via a trusted wireless local area network WLAN is defined in 3GPP TS 33.402. illustrates an architecture for leveraging EAP based access network registration for service layer bootstrapping and registration in accordance with the present embodiment. The service layer root keys are generated by AAA Server HSS when the keys with regard to access network are generated. MTC IWF will be used to pass the key material to M2M server . A call flow is shown in and which is discussed in more detail below.

When EAP or similar authentication methods are used to bootstrap D GSCLs with the access network the M2M Server s service layer may leverage the process to bootstrap with the device. Some access networks use EAP methods for access network registration. For example with reference to when UE D GSCL connects with the evolved packet system EPS via trusted WLAN UE D GSCL authenticates with the core network using EAP AKA . AKA AKA prime is defined in RFC 5488. AKA is a variant of AKA where the derived keys i.e. the M2M root key are based on the access network name. For the EAP access network based approach the EAP actors in would be mapped as follows to the actors as shown in respectively. EAP peer may be mapped with UE D GSCL EAP authenticator may be mapped with WLAN access point and authentication server may be mapped to HSS .

The message descriptions below show how the call flow is extended to support service layer bootstrapping. Refer to FIG. 6.2 1 of 3GPP TS 33.402 for a more detailed description of the existing steps. Note that although through are based on a UE D GSCL authenticating via a trusted non 3GPP network e.g. includes a diameter Connection SWm the enhancements for service layer bootstrapping can be applied to any access network that allows a device to authenticate via EAP based methods or other similar means.

With reference to at step UE D GSCL connects with access point which is a trusted non 3GPP access point. At step access point requests the identity of UE D GSCL . At step UE D GSCL sends an EAP response to the identity request of step . The identity of the UE D GSCL may be its network access identity NM . The response of step may also include AVPs that carry parameters that include an access network public ID e.g. 3GPP external identifier service provider identifier or application ID of an application on UE D GSCL . A service provider identifier may be the name of a company who provides service layers that the device wants to connect with or it may name a specific service layer e.g. an NSCL ID that the device wants to connect with. Application ID e.g. D GSCL ID for 3GPP the DA or NA for onM2M may be the name that the requesting application GA DA DSCL or GSCL is requesting that it be assigned.

At step access point sends the information from step to the access network AAA Server which also may be an HSS. Step through step generally is done when AKA is used particularly if the nodes between UE D GSCL and AAA server have changed the user identity in the original EAP identity response message of step . At step AAA server requests the AKA identity of UE D GSCL . At step the request of step is sent to UE D GSCL . At step UE D GSCL responds with its identity similar to step . At step access point sends the information from step to access network AAA Server .

At step based on subscriber information from the HSS AAA server verifies that UE D GSCL is permitted to access the EPC and verifies that UE D GSCL is permitted to register with M2M server that was named in the previous step. For further clarification generally an HSS can be considered a database that holds subscriber information. Here AAA server is a server that is allowed to access the HSS and make AAA decisions based on the information in the HSS. At step if UE D GSCL is permitted to access the access network then the AKA algorithm will be run. Also if the Attachment Block Enabled flag is enabled or if the NSCL ID was provided in step then AAA server will send a message to the address of MTC IWF which is provided in the subscriber data. The Device Permission Request DPR Command discussed in more detail herein may be executed with Action Type Device Attach Request External ID SCS Identifier. The message at step is sent over the S6m reference point. A purpose of this message is to see if UE D GSCL should be allowed to attach or if M2M server wishes that the request to attach be rejected. If a name of UE D GSCL was provided in step then this message is also used to propose the name of UE D GSCL to M2M server so that UE D GSCL may be registered.

At step MTC IWF sends a message to M2M server to determine if UE D GSCL should be allowed to attach. This message is sent over the Tsp reference point. The DPR command may be executed with Action Type Device Attach Request External ID. At step M2M server responds with an indication of whether or not UE D GSCL should be allowed to attach. If M2M server indicates that UE D GSCL should not be allowed to attach M2M server provides a cause to MTC IWF and M2M server may provide a backoff time to MTC IWF . If the name of UE D GSCL was provided e.g. via the DPR at step then the response from M2M server includes the name of UE D GSCL . If M2M server accepts the proposed name then the same name is provided back to the MTC IWF. The Device Permission Answer DPA Command may be executed for step .

At step MTC IWF sends AAA server an indication of whether or not the M2M server desires that UE D GSCL be allowed to attach. If M2M server indicates that UE D GSCL does not need to be attached at this time MTC IWF provides the cause and a back off time to AAA server . This message is sent over the S6m reference point which may be executed using a DPA Command. At step the EAP MSK and EMSK are generated. EAP MSK and EMSK are standard keys that fall out of the EAP algorithm. The service layer root key Kmr may be generated by the AAA server as described in section 8.3.2.3 of the ETSI M2M Architecture Specification ETSI TS 102 690. Kmr is equal to the Hash of EMSK ETSI M2M Device Network Root Key M2M Node ID M2M SP ID .

At step AAA Server sends the EAP Request towards UE D GSCL . If the EAP method is AKA then this message includes the random challenge RAND network authentication vector AUTN and message authentication code MAC . The identity response may include AVPs that carry parameters such as the access network public ID NSCL ID or assigned application ID e.g. D GSCL ID . The access network public ID may be used as the M2M Node ID that is used to generate Kmr. The NSCL ID represents the specific service layer that the UE application DA GA DSCL or GSCL should connect to and it is the M2M SP ID that is used to generate Kmr. The assigned application ID represents the specific identifier that has been assigned to the application by the NSCL. This value may be used as the M2M Node ID that is used to generate Kmr. At step access point sends the message of step to UE D GSCL .

As shown in which is a continuation of the flow of at step UE D GSCL runs the AKA algorithm and verifies that AUTN is correct to authenticate the network. After the network is verified UE D GSCL generates a response to the RES. The service layer root key e.g. Kmr may be generated by UE D GSCL as described in section 8.3.2.3 of the ETSI M2M architecture specification. Kmr is equal to the Hash of EMSK ETSI M2M Device Network Root Key M2M Node ID M2M SP ID. At step UE D GSCL sends a RES to the random challenge. At step AAA server receives the RES of step . At step AAA server verifies that the RES is equal to the XRES.

With further reference to at step if the Reachable Indicators Enabled flag is enabled or if the NSCL ID was provided in step then AAA server sends a message to the address of MTC IWF that was provided in the subscriber data for UE D GSCL . The Device Notification Request DNR command as discussed in more detail herein may be executed with Action Type Device Attach Event External ID M2M Identifier Key Material UE Service Layer ID. The message at step is sent over the S6m reference point and will ultimately inform M2M server that UE D GSCL has attached.

At step M2M server receives the attach notification over the Tsp reference point. The DNR command may be executed with Action Type Device Attach Event Key Material External ID. At step M2M server acknowledges the received notification of step . The DNA command discussed in more detail herein may be executed at step . At step MTC IWF sends the acknowledgement of step to AAA server over the S6m reference point.

Similar to step through step steps in block are usually only done when AKA is being used. At step if AAA server and UE D GSCL are using protected successful result indications then AAA server sends an EAP Request AKA Notification message to UE D GSCL prior to sending an EAP Success message. At step access point sends the response of step to UE D GSCL . At step UE D GSCL sends an EAP Response AKA Notification message which is forwarded to AAA server at step . At step AAA server sends the EAP Success message which is forwarded to UE D GSCL at step . At step UE D GSCL is registered but the M2M server may not know the IP address of UE D GSCL . UE D GSCL may begin communication over the mId or M2M server can begin communication by sending a device trigger.

Since the access network assists with bootstrapping additional information may be retained in the subscription information of devices that are allowed to use this feature. New access network subscription information is added to the HSS to support the authorization of service layer bootstrapping.

As shown in the M2M IoT WoT communication system includes a communication network . The communication network may be a fixed network e.g. Ethernet Fiber ISDN PLC or the like or a wireless network e.g. WLAN cellular or the like or a network of heterogeneous networks. For example the communication network may comprise of multiple access networks that provides content such as voice data video messaging broadcast or the like to multiple users. For example the communication network may employ one or more channel access methods such as code division multiple access CDMA time division multiple access TDMA frequency division multiple access FDMA orthogonal FDMA OFDMA single carrier FDMA SC FDMA and the like. Further the communication network may comprise other networks such as a core network the Internet a sensor network an industrial control network a personal area network a fused personal network a satellite network a home network or an enterprise network for example.

As shown in the M2M IoT WoT communication system may include the Infrastructure Domain and the Field Domain. The Infrastructure Domain refers to the network side of the end to end M2M deployment and the Field Domain refers to the area networks usually behind an M2M gateway. The Field Domain includes M2M gateways and terminal devices . It will be appreciated that any number of M2M gateway devices and M2M terminal devices may be included in the M2M IoT WoT communication system as desired. Each of the M2M gateway devices and M2M terminal devices are configured to transmit and receive signals via the communication network or direct radio link. The M2M gateway device allows wireless M2M devices e.g. cellular and non cellular as well as fixed network M2M devices e.g. PLC to communicate either through operator networks such as the communication network or direct radio link. For example the M2M devices may collect data and send the data via the communication network or direct radio link to an M2M application or M2M devices . The M2M devices may also receive data from the M2M application or an M2M device . Further data and signals may be sent to and received from the M2M application via an M2M service layer as described below. M2M devices and gateways may communicate via various networks including cellular WLAN WPAN e.g. Zigbee 6LoWPAN Bluetooth direct radio link and wireline for example.

Referring to the illustrated M2M service layer e.g. a network service capability layer NSCL as described herein in the field domain provides services for the M2M application M2M gateway devices and M2M terminal devices and the communication network . It will be understood that the M2M service layer may communicate with any number of M2M applications M2M gateway devices M2M terminal devices and communication networks as desired. The M2M service layer may be implemented by one or more servers computers or the like. The M2M service layer provides service capabilities that apply to M2M terminal devices M2M gateway devices and M2M applications . The functions of the M2M service layer may be implemented in a variety of ways for example as a web server in the cellular core network in the cloud etc.

Similar to the illustrated M2M service layer there is the M2M service layer in the Infrastructure Domain. M2M service layer provides services for the M2M application and the underlying communication network in the infrastructure domain. M2M service layer also provides services for the M2M gateway devices and M2M terminal devices in the field domain. It will be understood that the M2M service layer may communicate with any number of M2M applications M2M gateway devices and M2M terminal devices. The M2M service layer may interact with a service layer by a different service provider. The M2M service layer may be implemented by one or more servers computers virtual machines e.g. cloud compute storage farms etc. or the like.

Referring also to the M2M service layer and provide a core set of service delivery capabilities that diverse applications and verticals can leverage. These service capabilities enable M2M applications and to interact with devices and perform functions such as data collection data analysis device management security billing service device discovery etc. Essentially these service capabilities free the applications of the burden of implementing these functionalities thus simplifying application development and reducing cost and time to market. The service layer and also enables M2M applications and to communicate through various networks and in connection with the services that the service layer and provide.

In some embodiments M2M applications and may include desired applications that communicate using EAP as discussed herein. The M2M applications and may include applications in various industries such as without limitation transportation health and wellness connected home energy management asset tracking and security and surveillance. As mentioned above the M2M service layer running across the devices gateways and other servers of the system supports functions such as for example data collection device management security billing location tracking geofencing device service discovery and legacy systems integration and provides these functions as services to the M2M applications and .

EAP related approaches e.g. EAP PANA or EAP access network based approach used in the present application may be implemented as part of a service layer. The service layer e.g. UE D GSCL is a software middleware layer that supports value added service capabilities through a set of Application Programming Interfaces APIs and underlying networking interfaces. An M2M entity e.g. an M2M functional entity such as a device gateway or service platform that may be implemented by a combination of hardware and software may provide an application or service. Both ETSI M2M and oneM2M use a service layer that may contain EAP related approaches of the present invention. ETSI M2M s service layer is referred to as the Service Capability Layer SCL . The SCL may be implemented within an M2M device where it is referred to as a device SCL DSCL a gateway where it is referred to as a gateway SCL GSCL and or a network node where it is referred to as a network SCL NSCL . The oneM2M service layer supports a set of Common Service Functions CSFs i.e. service capabilities . An instantiation of a set of one or more particular types of CSFs is referred to as a Common Services Entity CSE which can be hosted on different types of network nodes e.g. infrastructure node middle node application specific node . Further EAP related approaches of the present application can implemented as part of an M2M network that uses a Service Oriented Architecture SOA and or a resource oriented architecture ROA to access services such as the EAP related approaches of the present application.

The processor may be a general purpose processor a special purpose processor a conventional processor a digital signal processor DSP a plurality of microprocessors one or more microprocessors in association with a DSP core a controller a microcontroller Application Specific Integrated Circuits ASICs Field Programmable Gate Array FPGAs circuits any other type of integrated circuit IC a state machine and the like. The processor may perform signal coding data processing power control input output processing and or any other functionality that enables the M2M device to operate in a wireless environment. The processor may be coupled to the transceiver which may be coupled to the transmit receive element . While depicts the processor and the transceiver as separate components it will be appreciated that the processor and the transceiver may be integrated together in an electronic package or chip. The processor may perform application layer programs e.g. browsers and or radio access layer RAN programs and or communications. The processor may perform security operations such as authentication security key agreement and or cryptographic operations such as at the access layer and or application layer for example.

The transmit receive element may be configured to transmit signals to or receive signals from an M2M service platform . For example in an embodiment the transmit receive element may be an antenna configured to transmit and or receive RF signals. The transmit receive element may support various networks and air interfaces such as WLAN WPAN cellular and the like. In an embodiment the transmit receive element may be an emitter detector configured to transmit and or receive IR UV or visible light signals for example. In yet another embodiment the transmit receive element may be configured to transmit and receive both RF and light signals. It will be appreciated that the transmit receive element may be configured to transmit and or receive any combination of wireless or wired signals.

In addition although the transmit receive element is depicted in as a single element the M2M device may include any number of transmit receive elements . More specifically the M2M device may employ MIMO technology. Thus in an embodiment the M2M device may include two or more transmit receive elements e.g. multiple antennas for transmitting and receiving wireless signals.

The transceiver may be configured to modulate the signals that are to be transmitted by the transmit receive element and to demodulate the signals that are received by the transmit receive element . As noted above the M2M device may have multi mode capabilities. Thus the transceiver may include multiple transceivers for enabling the M2M device to communicate via multiple RATs such as UTRA and IEEE 802.11 for example.

The processor may access information from and store data in any type of suitable memory such as the non removable memory and or the removable memory . The non removable memory may include random access memory RAM read only memory ROM a hard disk or any other type of memory storage device. The removable memory may include a subscriber identity module SIM card a memory stick a secure digital SD memory card and the like. In other embodiments the processor may access information from and store data in memory that is not physically located on the M2M device such as on a server or a home computer. The processor may be configured to control lighting patterns images or colors on the display or indicators in response to whether bootstrapping e.g. bootstrapping using EAP in some of embodiments described herein is successful or unsuccessful or otherwise indicate the status of resource propagation processes. A user interface viewed via display may give a user an option of using EAP PANA EAP access network based approach GBA or the like for authentication.

The processor may receive power from the power source and may be configured to distribute and or control the power to the other components in the M2M device . The power source may be any suitable device for powering the M2M device . For example the power source may include one or more dry cell batteries e.g. nickel cadmium NiCd nickel zinc NiZn nickel metal hydride NiMH lithium ion Li ion etc. solar cells fuel cells and the like.

The processor may also be coupled to the GPS chipset which is configured to provide location information e.g. longitude and latitude regarding the current location of the M2M device . It will be appreciated that the M2M device may acquire location information by way of any suitable location determination method while remaining consistent with an embodiment.

The processor may further be coupled to other peripherals which may include one or more software and or hardware modules that provide additional features functionality and or wired or wireless connectivity. For example the peripherals may include an accelerometer an e compass a satellite transceiver a sensor a digital camera for photographs or video a universal serial bus USB port a vibration device a television transceiver a hands free headset a Bluetooth module a frequency modulated FM radio unit a digital music player a media player a video game player module an Internet browser and the like.

In operation CPU fetches decodes and executes instructions and transfers information to and from other resources via the computer s main data transfer path system bus . Such a system bus connects the components in computing system and defines the medium for data exchange. System bus typically includes data lines for sending data address lines for sending addresses and control lines for sending interrupts and for operating the system bus. An example of such a system bus is the PCI Peripheral Component Interconnect bus.

Memory devices coupled to system bus include random access memory RAM and read only memory ROM . Such memories include circuitry that allows information to be stored and retrieved. ROMs generally contain stored data that cannot easily be modified. Data stored in RAM can be read or changed by CPU or other hardware devices. Access to RAM and or ROM may be controlled by memory controller . Memory controller may provide an address translation function that translates virtual addresses into physical addresses as instructions are executed. Memory controller may also provide a memory protection function that isolates processes within the system and isolates system processes from user processes. Thus a program running in a first mode can access only memory mapped by its own process virtual address space it cannot access memory within another process s virtual address space unless memory sharing between the processes has been set up.

In addition computing system may contain peripherals controller responsible for communicating instructions from CPU to peripherals such as printer keyboard mouse and disk drive .

Display which is controlled by display controller is used to display visual output generated by computing system . Such visual output may include text graphics animated graphics and video. Display may be implemented with a CRT based video display an LCD based flat panel display gas plasma based flat panel display or a touch panel. Display controller includes electronic components required to generate a video signal that is sent to display .

Further computing system may contain network adaptor that may be used to connect computing system to an external communications network such as network of and .

It is understood that any or all of the systems methods and processes described herein may be embodied in the form of computer executable instructions i.e. program code stored on a computer readable storage medium which instructions when executed by a machine such as a computer server M2M terminal device M2M gateway device or the like perform and or implement the systems methods and processes described herein. Specifically any of the steps operations or functions described above may be implemented in the form of such computer executable instructions. Computer readable storage media include both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information but such computer readable storage media do not includes signals. Computer readable storage media include but are not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other physical medium which can be used to store the desired information and which can be accessed by a computer.

In describing preferred embodiments of the subject matter of the present disclosure as illustrated in the Figures specific terminology is employed for the sake of clarity. The claimed subject matter however is not intended to be limited to the specific terminology so selected and it is to be understood that each specific element includes all technical equivalents that operate in a similar manner to accomplish a similar purpose.

This written description uses examples to disclose the invention including the best mode and also to enable any person skilled in the art to practice the invention including making and using any devices or systems and performing any incorporated methods. The patentable scope of the invention is defined by the claims and may include other examples that occur to those skilled in the art. Such other examples are intended to be within the scope of the claims if they have structural elements that do not differ from the literal language of the claims or if they include equivalent structural elements with insubstantial differences from the literal languages of the claims.

